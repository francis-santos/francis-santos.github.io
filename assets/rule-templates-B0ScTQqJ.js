import{b as r}from"./auth.service-BozCwdnf.js";import{u as l}from"./useDemoMode-DpDjlFnd.js";class p{async getRuleTemplates(e={}){const{isDemoUser:t,getMockData:s}=l();if(t.value){const i=await s("ruleTemplates",e?.page||1,e?.limit||10,e);return{data:i.data,total:i.total,page:i.page,limit:i.limit,totalPages:Math.ceil(i.total/i.limit)}}const a=new URLSearchParams;return e.search&&a.append("search",e.search),e.language&&a.append("language",e.language),e.severity&&a.append("severity",e.severity),e.category&&a.append("category",e.category),e.isActive!==void 0&&a.append("isActive",String(e.isActive)),e.page&&a.append("page",String(e.page)),e.limit&&a.append("limit",String(e.limit)),await r.get(`/rule-templates?${a.toString()}`)}async getStatistics(){const{isDemoUser:e,simulateApiDelay:t}=l();return e.value?(await t(200),{total:8,active:7,inactive:1,byLanguage:{javascript:3,typescript:1,python:1,sql:1,java:1,csharp:1},bySeverity:{low:3,medium:3,high:1,critical:1},byCategory:{quality:4,security:2,style:2}}):await r.get("/rule-templates/statistics")}async getRuleTemplate(e){const{isDemoUser:t,getMockItem:s}=l();if(t.value){const a=await s("ruleTemplates",e);if(!a)throw new Error("Template nÃ£o encontrado");return a}return await r.get(`/rule-templates/${e}`)}async createRuleTemplate(e){return await r.post("/rule-templates",e)}async updateRuleTemplate(e,t){return await r.patch(`/rule-templates/${e}`,t)}async deleteRuleTemplate(e){await r.delete(`/rule-templates/${e}`)}async bulkImport(e){return await r.post("/rule-templates/bulk-import",e)}async getCategories(){const{isDemoUser:e,simulateApiDelay:t}=l();if(e.value)return await t(150),["quality","security","style"];const s=await this.getRuleTemplates({limit:100});return[...new Set(s.data.map(i=>i.category))].filter(Boolean).sort()}async getLanguages(){const{isDemoUser:e,simulateApiDelay:t}=l();if(e.value)return await t(150),["javascript","typescript","python","sql","java","csharp"];const s=await this.getRuleTemplates({limit:100});return[...new Set(s.data.map(i=>i.language))].filter(Boolean).sort()}}const u=new p;export{u as r};
