import{a6 as we,f as R,E as ee,L as Ke,j as _,k as oe,$ as O,a1 as c,q as i,z as f,a8 as V,W as E,a2 as A,_ as G,a0 as ue,Q as Se,v as _e,s as P,w as z,B as de,t as j,b as xe,x as q,o as $e,J as et,D as tt,S as at,F as Te,ad as ot,V as nt,Y as lt,ae as it}from"./vendor-vue-BOgiBTV5.js";import{u as ke,a as Ve}from"./auth-Dt5LZyuD.js";import{u as st,V as te}from"./VChip-rM5LjFon.js";import{_ as ne,a as N,c as rt,b as U,d as ut,m as me,u as ce,e as Ie,f as Ce,g as De,h as ae,i as Ee,j as Le,k as Me,l as ct,n as dt,o as mt,p as vt,q as ft,V as gt}from"./index-CPKBv9AR.js";import{a as ht,b as Be,c as bt,V as Pe,d as K,e as ie}from"./VGrid-BsndwDIl.js";import{V as pt}from"./VAlert-qYEn-PTR.js";import{V as Ae}from"./VSpacer-CBt-5M7F.js";import{V as yt}from"./VDialog-CkQu3sn-.js";import{a3 as Ne,y as wt,p as F,h as X,n as ve,u as Z,j as Re,D as ze,k as We,x as Q,l as He,C as Oe,s as St,q as Ue,F as $,af as Ye,ag as je,ab as _t,L as xt,ah as Tt,ai as kt}from"./vendor-ui-BR0KSDoQ.js";import{V as se,a as re,b as J}from"./VList-BKPY6TWC.js";import{u as qe}from"./ssrBoot-Cswv876e.js";import{V as Vt}from"./VMenu-vHpHdbAo.js";import{V as It}from"./index-DzEvJ-T3.js";import{V as Ct}from"./VContainer-BLfJzg3Y.js";import{V as Dt}from"./VMain-D8krJMno.js";import"./vendor-utils-C9OYYH06.js";import"./token-storage.service-BqAv9k07.js";import"./dialog-transition-BRPqoOP4.js";const Et={idleTimeout:18e5,warningTimeout:3e5,events:["mousedown","mousemove","keypress","scroll","touchstart","click"],showWarning:!0};function Lt(e={}){const t={...Et,...e},n=ke(),a=we(),o=Ve(),l=R(!1),s=R(!1),r=R(0),w=R(Date.now());let g=null,b=null,v=null;const u=()=>{const k=Date.now();w.value=k,l.value=!1,s.value&&(s.value=!1,d()),o.emitActivityDetected(k),I()},y=()=>{g&&(clearTimeout(g),g=null),b&&(clearTimeout(b),b=null),d()},d=()=>{v&&(clearInterval(v),v=null)},m=()=>{t.showWarning&&(s.value=!0,r.value=Math.floor(t.warningTimeout/1e3),o.emitIdleWarningStart(r.value),v=setInterval(()=>{r.value--,r.value<=0&&(d(),C())},1e3))},C=async()=>{if(l.value=!0,s.value=!1,y(),o.emitIdleForceLogout("Sessão encerrada por inatividade"),t.onIdleLogout)t.onIdleLogout();else try{await n.logout("idle_timeout"),await a.push("/login?reason=idle")}catch(k){console.error("Error during idle logout:",k),await a.push("/login?reason=idle")}},I=()=>{if(y(),!!n.isAuthenticated){if(t.showWarning){const k=t.idleTimeout-t.warningTimeout;b=setTimeout(()=>{m()},k)}g=setTimeout(()=>{C()},t.idleTimeout)}},S=()=>{s.value=!1,d(),o.emitIdleWarningDismiss(!0),u()},L=()=>{C()},H=()=>{o.initialize&&o.initialize(),o.onActivityDetected(k=>{k.timestamp>w.value&&(w.value=k.timestamp,s.value&&(s.value=!1,d()),I())}),o.onIdleWarningStart(k=>{!s.value&&t.showWarning&&(s.value=!0,r.value=k.timeRemaining,v=setInterval(()=>{r.value--,r.value<=0&&(d(),C())},1e3))}),o.onIdleWarningDismiss(k=>{s.value&&(s.value=!1,d(),k.extended&&u())}),o.onIdleForceLogout(()=>{C()})},W=()=>{t.events.forEach(k=>{document.addEventListener(k,u,!0)}),document.addEventListener("visibilitychange",()=>{document.hidden||u()}),H()},p=()=>{t.events.forEach(k=>{document.removeEventListener(k,u,!0)}),document.removeEventListener("visibilitychange",u)},h=()=>{n.isAuthenticated&&(W(),u())},x=()=>{p(),y(),l.value=!1,s.value=!1,o.cleanup&&o.cleanup()},T=()=>{y()},M=()=>{n.isAuthenticated&&I()},B=()=>{const k=Math.floor(r.value/60),le=r.value%60;return`${k}:${le.toString().padStart(2,"0")}`};return ee(()=>{n.isAuthenticated&&h()}),Ke(()=>{x()}),{isIdle:l,showWarningDialog:s,timeRemaining:r,lastActivity:w,warningTimeout:_(()=>Math.floor(t.warningTimeout/1e3)),start:h,stop:x,pause:T,resume:M,resetActivity:u,extendSession:S,forceLogout:L,getFormattedTimeRemaining:B,config:t}}const Mt=oe({__name:"IdleTimeoutWarning",props:{show:{type:Boolean,required:!0,default:!1},timeRemaining:{type:Number,required:!0,default:0},totalWarningTime:{type:Number,required:!0,default:300}},emits:["extend","logout"],setup(e,{expose:t,emit:n}){t();const a=e,o=n,l=_(()=>{const w=Math.floor(a.timeRemaining/60),g=a.timeRemaining%60;return`${w}:${g.toString().padStart(2,"0")}`}),s=_(()=>a.totalWarningTime===0?0:(a.totalWarningTime-a.timeRemaining)/a.totalWarningTime*100),r={props:a,emit:o,formattedTime:l,progressValue:s};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}}),Bt={class:"d-flex align-center"},Pt={class:"text-center py-4"},At={class:"countdown-container mb-4"},Nt={class:"countdown-circle"},Rt={class:"countdown-time"},zt={class:"countdown-number"},Wt={class:"d-flex align-center"};function Ht(e,t,n,a,o,l){return A(),O(yt,{"model-value":n.show,"max-width":"500px",persistent:"","no-click-animation":""},{default:c(()=>[i(Pe,null,{default:c(()=>[i(ht,{class:"text-h6 d-flex align-center justify-space-between bg-warning text-white sticky-header"},{default:c(()=>[f("div",Bt,[i(N,{class:"me-2"},{default:c(()=>[...t[2]||(t[2]=[V("mdi-clock-alert",-1)])]),_:1}),t[3]||(t[3]=V(" Sessão Inativa ",-1))]),i(N,null,{default:c(()=>[...t[4]||(t[4]=[V("mdi-timer-sand",-1)])]),_:1})]),_:1}),i(Be,{class:"pa-6"},{default:c(()=>[f("div",Pt,[i(N,{size:"64",color:"warning",class:"mb-4"},{default:c(()=>[...t[5]||(t[5]=[V("mdi-account-clock",-1)])]),_:1}),t[9]||(t[9]=f("h3",{class:"text-h5 font-weight-bold text-warning mb-3"}," Sua sessão expirará em breve ",-1)),t[10]||(t[10]=f("p",{class:"text-body-1 text-medium-emphasis mb-4"}," Detectamos que você está inativo há algum tempo. Por motivos de segurança, sua sessão será encerrada automaticamente. ",-1)),f("div",At,[f("div",Nt,[i(rt,{"model-value":a.progressValue,size:120,width:8,color:"warning",class:"countdown-progress"},{default:c(()=>[f("div",Rt,[f("div",zt,E(a.formattedTime),1),t[6]||(t[6]=f("div",{class:"countdown-label"},"restante",-1))])]),_:1},8,["model-value"])])]),i(pt,{type:"info",variant:"tonal",class:"mb-4"},{default:c(()=>[f("div",Wt,[i(N,{class:"me-2"},{default:c(()=>[...t[7]||(t[7]=[V("mdi-information",-1)])]),_:1}),t[8]||(t[8]=f("div",null,[f("div",{class:"font-weight-medium mb-1"},"O que acontecerá:"),f("div",{class:"text-body-2"},[V(" • Você será desconectado automaticamente"),f("br"),V(" • Será redirecionado para a tela de login"),f("br"),V(" • Dados não salvos podem ser perdidos ")])],-1))])]),_:1})])]),_:1}),i(bt,{class:"px-6 py-4 bg-surface border-t"},{default:c(()=>[i(U,{variant:"outlined",color:"error",onClick:t[0]||(t[0]=s=>e.$emit("logout")),disabled:n.timeRemaining<=0},{default:c(()=>[i(N,{class:"me-2"},{default:c(()=>[...t[11]||(t[11]=[V("mdi-logout",-1)])]),_:1}),t[12]||(t[12]=V(" Sair Agora ",-1))]),_:1},8,["disabled"]),i(Ae),i(U,{color:"primary",variant:"flat",onClick:t[1]||(t[1]=s=>e.$emit("extend")),disabled:n.timeRemaining<=0},{default:c(()=>[i(N,{class:"me-2"},{default:c(()=>[...t[13]||(t[13]=[V("mdi-refresh",-1)])]),_:1}),t[14]||(t[14]=V(" Continuar Trabalhando ",-1))]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])}const Ot=ne(Mt,[["render",Ht],["__scopeId","data-v-68b3ab57"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/common/IdleTimeoutWarning.vue"]]),Ut=oe({__name:"CrossTabNotification",props:{enabled:{type:Boolean,required:!1,default:!0}},setup(e,{expose:t}){t();const n=e,a=R(!1),o=R(null),l=Ve(),s=_(()=>o.value?.title||""),r=_(()=>o.value?.message||""),w=_(()=>o.value?.color||"info"),g=_(()=>o.value?.icon||"mdi-information"),b=_(()=>o.value?.timeout||4e3),v={"auth:login":{title:"Sessão Iniciada",message:"Login realizado em outra aba",color:"success",icon:"mdi-account-check",timeout:3e3},"auth:logout":{title:"Sessão Encerrada",message:"Logout realizado em outra aba",color:"warning",icon:"mdi-logout",timeout:4e3},"auth:token-refresh":{title:"Sessão Atualizada",message:"Token renovado automaticamente",color:"info",icon:"mdi-refresh",timeout:2e3},"auth:profile-update":{title:"Perfil Atualizado",message:"Suas informações foram atualizadas",color:"info",icon:"mdi-account-edit",timeout:3e3},"auth:session-expired":{title:"Sessão Expirada",message:"Sua sessão foi encerrada automaticamente",color:"error",icon:"mdi-clock-alert",timeout:5e3},"idle:warning-start":{title:"Aviso de Inatividade",message:"Sessão será encerrada por inatividade em breve",color:"warning",icon:"mdi-timer-sand",timeout:4e3},"idle:warning-dismiss":{title:"Sessão Estendida",message:"Tempo de sessão foi renovado",color:"success",icon:"mdi-timer-refresh",timeout:2e3},"idle:activity-detected":{title:"Atividade Detectada",message:"Atividade registrada em outra aba",color:"info",icon:"mdi-cursor-default",timeout:1500},"idle:force-logout":{title:"Logout por Inatividade",message:"Sessão encerrada por inatividade prolongada",color:"error",icon:"mdi-account-clock",timeout:6e3}},u=(m,C)=>{if(!n.enabled)return;const I=v[m];I&&(o.value={type:m,title:I.title,message:C||I.message,color:I.color,icon:I.icon,timeout:I.timeout},a.value=!0)},y=()=>{l.onLogin(()=>{u("auth:login")}),l.onLogout(m=>{const C=m.reason?`Motivo: ${m.reason}`:"Logout realizado em outra aba";u("auth:logout",C)}),l.onTokenRefresh(()=>{u("auth:token-refresh")}),l.onProfileUpdate(()=>{u("auth:profile-update")}),l.onSessionExpired(m=>{u("auth:session-expired",`Motivo: ${m.reason}`)}),l.onIdleWarningStart(m=>{const C=Math.floor(m.timeRemaining/60),I=m.timeRemaining%60,S=`${C}:${I.toString().padStart(2,"0")}`;u("idle:warning-start",`Tempo restante: ${S}`)}),l.onIdleWarningDismiss(m=>{m.extended&&u("idle:warning-dismiss")}),l.onIdleForceLogout(()=>{u("idle:force-logout")})};ee(()=>{n.enabled&&y()});const d={props:n,visible:a,currentNotification:o,tabSync:l,notificationTitle:s,notificationMessage:r,notificationColor:w,notificationIcon:g,timeout:b,notificationConfigs:v,showNotification:u,initEventListeners:y};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}}),Yt={class:"d-flex align-center"},jt={class:"notification-content"},qt={class:"notification-title"},Ft={key:0,class:"notification-message"};function Xt(e,t,n,a,o,l){return A(),O(ut,{modelValue:a.visible,"onUpdate:modelValue":t[1]||(t[1]=s=>a.visible=s),timeout:a.timeout,color:a.notificationColor,location:"top",variant:"elevated",elevation:"6",class:"cross-tab-notification"},{actions:c(()=>[i(U,{variant:"text",size:"small",onClick:t[0]||(t[0]=s=>a.visible=!1)},{default:c(()=>[i(N,null,{default:c(()=>[...t[2]||(t[2]=[V("mdi-close",-1)])]),_:1})]),_:1})]),default:c(()=>[f("div",Yt,[i(N,{class:"me-3",size:"20"},{default:c(()=>[V(E(a.notificationIcon),1)]),_:1}),f("div",jt,[f("div",qt,E(a.notificationTitle),1),a.notificationMessage?(A(),G("div",Ft,E(a.notificationMessage),1)):ue("",!0)])])]),_:1},8,["modelValue","timeout","color"])}const Zt=ne(Ut,[["render",Xt],["__scopeId","data-v-28feff37"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/common/CrossTabNotification.vue"]]),Jt="/assets/icon-D4ATo0P4.png",Gt=oe({__name:"AppLayout",setup(e,{expose:t}){t();const{mobile:n}=Ne(),a=wt(),o=we(),l=ke(),{isDemoUser:s}=st(),{showWarningDialog:r,timeRemaining:w,warningTimeout:g,extendSession:b,forceLogout:v}=Lt(),u=R(!0),y=R(!1),d=R(!1);l.isAuthenticated||l.setUser({id:"1",fullName:"João Silva",username:"joao.silva",email:"joao.silva@prodeb.ba.gov.br",organizationId:"prodeb-bahia",organizationName:"PRODEB"});const m=_(()=>a.global.name.value==="miraDark"),C=()=>{n.value?u.value=!u.value:y.value=!y.value},I=[{title:"Dashboard",icon:"mdi-view-dashboard",to:"/dashboard",color:"primary"},{title:"Análises",icon:"mdi-chart-line",to:"/analyses",color:"info"},{title:"Repositórios",icon:"mdi-source-repository",to:"/repositories",color:"success"},{title:"Especialistas IA",icon:"mdi-robot",to:"/experts",color:"deep-purple"},{title:"Regras",icon:"mdi-shield-check-outline",to:"/rules",color:"orange"},{title:"Templates",icon:"mdi-file-document-multiple-outline",to:"/rule-templates",color:"indigo"},{title:"Webhooks Logs",icon:"mdi-webhook",to:"/webhooks",color:"pink"},{title:"Logs do Sistema",icon:"mdi-file-document-multiple-outline",to:"/system-logs",color:"teal"},{title:"Logs da Organização",icon:"mdi-domain",to:"/organization-logs",color:"indigo"},{title:"Usuários",icon:"mdi-account-group",to:"/users",color:"blue"},{title:"Organizações",icon:"mdi-domain",to:"/organizations",color:"purple"},{title:"Tokens de API",icon:"mdi-key",to:"/api-tokens",color:"orange"},{title:"Configurações",icon:"mdi-cog",to:"/settings",color:"grey"}],S=_(()=>n.value?56:64),p={mobile:n,theme:a,router:o,authStore:l,isDemoUser:s,isWarningVisible:r,timeRemaining:w,warningTimeout:g,extendSession:b,forceLogout:v,drawer:u,rail:y,userMenuOpen:d,isDark:m,toggleDrawer:C,menuItems:I,appBarHeight:S,toggleTheme:()=>{const h=m.value?"miraLight":"miraDark";typeof a.change=="function"?a.change(h):a.global.name.value=h},handleLogout:async()=>{try{await l.logout(),o.push("/login")}catch(h){console.error("Erro ao fazer logout:",h),o.push("/login")}},getUserInitials:h=>h.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2),IdleTimeoutWarning:Ot,CrossTabNotification:Zt,get logo(){return Jt}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),Fe=F({text:String,...ve(),...me()},"VToolbarTitle"),Xe=X()({name:"VToolbarTitle",props:Fe(),setup(e,t){let{slots:n}=t;return Z(()=>{const a=!!(n.default||n.text||e.text);return i(e.tag,{class:_e(["v-toolbar-title",e.class]),style:Se(e.style)},{default:()=>[a&&f("div",{class:"v-toolbar-title__placeholder"},[n.text?n.text():e.text,n.default?.()])]})}),{}}}),Qt=[null,"prominent","default","comfortable","compact"],Ze=F({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:e=>Qt.includes(e)},extended:{type:Boolean,default:null},extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...Me(),...ve(),...Le(),...Ee(),...me({tag:"header"}),...He()},"VToolbar"),be=X()({name:"VToolbar",props:Ze(),setup(e,t){let{slots:n}=t;const{backgroundColorClasses:a,backgroundColorStyles:o}=ce(()=>e.color),{borderClasses:l}=Ie(e),{elevationClasses:s}=Ce(e),{roundedClasses:r}=De(e),{themeClasses:w}=Re(e),{rtlClasses:g}=ze(),b=P(e.extended===null?!!n.extension?.():e.extended),v=_(()=>parseInt(Number(e.height)+(e.density==="prominent"?Number(e.height):0)-(e.density==="comfortable"?8:0)-(e.density==="compact"?16:0),10)),u=_(()=>b.value?parseInt(Number(e.extensionHeight)+(e.density==="prominent"?Number(e.extensionHeight):0)-(e.density==="comfortable"?4:0)-(e.density==="compact"?8:0),10):0);return We({VBtn:{variant:"text"}}),Z(()=>{const y=!!(e.title||n.title),d=!!(n.image||e.image),m=n.extension?.();return b.value=e.extended===null?!!m:e.extended,i(e.tag,{class:_e(["v-toolbar",{"v-toolbar--absolute":e.absolute,"v-toolbar--collapse":e.collapse,"v-toolbar--flat":e.flat,"v-toolbar--floating":e.floating,[`v-toolbar--density-${e.density}`]:!0},a.value,l.value,s.value,r.value,w.value,g.value,e.class]),style:Se([o.value,e.style])},{default:()=>[d&&f("div",{key:"image",class:"v-toolbar__image"},[n.image?i(ae,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},n.image):i(K,{key:"image-img",cover:!0,src:e.image},null)]),i(ae,{defaults:{VTabs:{height:Q(v.value)}}},{default:()=>[f("div",{class:"v-toolbar__content",style:{height:Q(v.value)}},[n.prepend&&f("div",{class:"v-toolbar__prepend"},[n.prepend?.()]),y&&i(Xe,{key:"title",text:e.title},{text:n.title}),n.default?.(),n.append&&f("div",{class:"v-toolbar__append"},[n.append?.()])])]}),i(ae,{defaults:{VTabs:{height:Q(u.value)}}},{default:()=>[i(It,null,{default:()=>[b.value&&f("div",{class:"v-toolbar__extension",style:{height:Q(u.value)}},[m])]})]})]})}),{contentHeight:v,extensionHeight:u}}}),Kt=F({scrollTarget:{type:String},scrollThreshold:{type:[String,Number],default:300}},"scroll");function $t(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{canScroll:n}=t;let a=0,o=0;const l=R(null),s=P(0),r=P(0),w=P(0),g=P(!1),b=P(!1),v=_(()=>Number(e.scrollThreshold)),u=_(()=>Oe((v.value-s.value)/v.value||0)),y=()=>{const d=l.value;if(!d||n&&!n.value)return;a=s.value,s.value="window"in d?d.pageYOffset:d.scrollTop;const m=d instanceof Window?document.documentElement.scrollHeight:d.scrollHeight;if(o!==m){o=m;return}b.value=s.value<a,w.value=Math.abs(s.value-v.value)};return z(b,()=>{r.value=r.value||s.value}),z(g,()=>{r.value=0}),ee(()=>{z(()=>e.scrollTarget,d=>{const m=d?document.querySelector(d):window;if(!m){St(`Unable to locate element with identifier ${d}`);return}m!==l.value&&(l.value?.removeEventListener("scroll",y),l.value=m,l.value.addEventListener("scroll",y,{passive:!0}))},{immediate:!0})}),de(()=>{l.value?.removeEventListener("scroll",y)}),n&&z(n,y,{immediate:!0}),{scrollThreshold:v,currentScroll:s,currentThreshold:w,isScrollActive:g,scrollRatio:u,isScrollingUp:b,savedScroll:r}}const ea=F({scrollBehavior:String,modelValue:{type:Boolean,default:!0},location:{type:String,default:"top",validator:e=>["top","bottom"].includes(e)},...Ze(),...je(),...Kt(),height:{type:[Number,String],default:64}},"VAppBar"),ta=X()({name:"VAppBar",props:ea(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const a=R(),o=Ue(e,"modelValue"),l=_(()=>{const S=new Set(e.scrollBehavior?.split(" ")??[]);return{hide:S.has("hide"),fullyHide:S.has("fully-hide"),inverted:S.has("inverted"),collapse:S.has("collapse"),elevate:S.has("elevate"),fadeImage:S.has("fade-image")}}),s=_(()=>{const S=l.value;return S.hide||S.fullyHide||S.inverted||S.collapse||S.elevate||S.fadeImage||!o.value}),{currentScroll:r,scrollThreshold:w,isScrollingUp:g,scrollRatio:b}=$t(e,{canScroll:s}),v=j(()=>l.value.hide||l.value.fullyHide),u=_(()=>e.collapse||l.value.collapse&&(l.value.inverted?b.value>0:b.value===0)),y=_(()=>e.flat||l.value.fullyHide&&!o.value||l.value.elevate&&(l.value.inverted?r.value>0:r.value===0)),d=_(()=>l.value.fadeImage?l.value.inverted?1-b.value:b.value:void 0),m=_(()=>{if(l.value.hide&&l.value.inverted)return 0;const S=a.value?.contentHeight??0,L=a.value?.extensionHeight??0;return v.value?r.value<w.value||l.value.fullyHide?S+L:S:S+L});$(()=>!!e.scrollBehavior,()=>{xe(()=>{v.value?l.value.inverted?o.value=r.value>w.value:o.value=g.value||r.value<w.value:o.value=!0})});const{ssrBootStyles:C}=qe(),{layoutItemStyles:I}=Ye({id:e.name,order:_(()=>parseInt(e.order,10)),position:j(()=>e.location),layoutSize:m,elementSize:P(void 0),active:o,absolute:j(()=>e.absolute)});return Z(()=>{const S=be.filterProps(e);return i(be,q({ref:a,class:["v-app-bar",{"v-app-bar--bottom":e.location==="bottom"},e.class],style:[{...I.value,"--v-toolbar-image-opacity":d.value,height:void 0,...C.value},e.style]},S,{collapse:u.value,flat:y.value}),n)}),{}}}),aa=F({..._t(ct({icon:"$menu",variant:"text"}),["spaced"])},"VAppBarNavIcon"),oa=X()({name:"VAppBarNavIcon",props:aa(),setup(e,t){let{slots:n}=t;return Z(()=>i(U,q(e,{class:["v-app-bar-nav-icon"]}),n)),{}}}),na=X()({name:"VAppBarTitle",props:Fe(),setup(e,t){let{slots:n}=t;return Z(()=>i(Xe,q(e,{class:"v-app-bar-title"}),n)),{}}});function la(e){let{rootEl:t,isSticky:n,layoutItemStyles:a}=e;const o=P(!1),l=P(0),s=_(()=>{const g=typeof o.value=="boolean"?"top":o.value;return[n.value?{top:"auto",bottom:"auto",height:void 0}:void 0,o.value?{[g]:Q(l.value)}:{top:a.value.top}]});ee(()=>{z(n,g=>{g?window.addEventListener("scroll",w,{passive:!0}):window.removeEventListener("scroll",w)},{immediate:!0})}),de(()=>{window.removeEventListener("scroll",w)});let r=0;function w(){const g=r>window.scrollY?"up":"down",b=t.value.getBoundingClientRect(),v=parseFloat(a.value.top??0),u=window.scrollY-Math.max(0,l.value-v),y=b.height+Math.max(l.value,v)-window.scrollY-window.innerHeight,d=parseFloat(getComputedStyle(t.value).getPropertyValue("--v-body-scroll-y"))||0;b.height<window.innerHeight-v?(o.value="top",l.value=v):g==="up"&&o.value==="bottom"||g==="down"&&o.value==="top"?(l.value=window.scrollY+b.top-d,o.value=!0):g==="down"&&y<=0?(l.value=0,o.value="bottom"):g==="up"&&u<=0&&(d?o.value!=="top"&&(l.value=-u+d+v,o.value="top"):(l.value=b.top+u,o.value="top")),r=window.scrollY}return{isStuck:o,stickyStyles:s}}const ia=100,sa=20;function pe(e){return(e<0?-1:1)*Math.sqrt(Math.abs(e))*1.41421356237}function ye(e){if(e.length<2)return 0;if(e.length===2)return e[1].t===e[0].t?0:(e[1].d-e[0].d)/(e[1].t-e[0].t);let t=0;for(let n=e.length-1;n>0;n--){if(e[n].t===e[n-1].t)continue;const a=pe(t),o=(e[n].d-e[n-1].d)/(e[n].t-e[n-1].t);t+=(o-a)*Math.abs(o),n===e.length-1&&(t*=.5)}return pe(t)*1e3}function ra(){const e={};function t(o){Array.from(o.changedTouches).forEach(l=>{(e[l.identifier]??(e[l.identifier]=new xt(sa))).push([o.timeStamp,l])})}function n(o){Array.from(o.changedTouches).forEach(l=>{delete e[l.identifier]})}function a(o){const l=e[o]?.values().reverse();if(!l)throw new Error(`No samples for touch id ${o}`);const s=l[0],r=[],w=[];for(const g of l){if(s[0]-g[0]>ia)break;r.push({t:g[0],d:g[1].clientX}),w.push({t:g[0],d:g[1].clientY})}return{x:ye(r),y:ye(w),get direction(){const{x:g,y:b}=this,[v,u]=[Math.abs(g),Math.abs(b)];return v>u&&g>=0?"right":v>u&&g<=0?"left":u>v&&b>=0?"down":u>v&&b<=0?"up":ua()}}}return{addMovement:t,endTouch:n,getVelocity:a}}function ua(){throw new Error}function ca(e){let{el:t,isActive:n,isTemporary:a,width:o,touchless:l,position:s}=e;ee(()=>{window.addEventListener("touchstart",S,{passive:!0}),window.addEventListener("touchmove",L,{passive:!1}),window.addEventListener("touchend",H,{passive:!0})}),de(()=>{window.removeEventListener("touchstart",S),window.removeEventListener("touchmove",L),window.removeEventListener("touchend",H)});const r=_(()=>["left","right"].includes(s.value)),{addMovement:w,endTouch:g,getVelocity:b}=ra();let v=!1;const u=P(!1),y=P(0),d=P(0);let m;function C(p,h){return(s.value==="left"?p:s.value==="right"?document.documentElement.clientWidth-p:s.value==="top"?p:s.value==="bottom"?document.documentElement.clientHeight-p:Y())-(h?o.value:0)}function I(p){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const x=s.value==="left"?(p-d.value)/o.value:s.value==="right"?(document.documentElement.clientWidth-p-d.value)/o.value:s.value==="top"?(p-d.value)/o.value:s.value==="bottom"?(document.documentElement.clientHeight-p-d.value)/o.value:Y();return h?Oe(x):x}function S(p){if(l.value)return;const h=p.changedTouches[0].clientX,x=p.changedTouches[0].clientY,T=25,M=s.value==="left"?h<T:s.value==="right"?h>document.documentElement.clientWidth-T:s.value==="top"?x<T:s.value==="bottom"?x>document.documentElement.clientHeight-T:Y(),B=n.value&&(s.value==="left"?h<o.value:s.value==="right"?h>document.documentElement.clientWidth-o.value:s.value==="top"?x<o.value:s.value==="bottom"?x>document.documentElement.clientHeight-o.value:Y());(M||B||n.value&&a.value)&&(m=[h,x],d.value=C(r.value?h:x,n.value),y.value=I(r.value?h:x),v=d.value>-20&&d.value<80,g(p),w(p))}function L(p){const h=p.changedTouches[0].clientX,x=p.changedTouches[0].clientY;if(v){if(!p.cancelable){v=!1;return}const M=Math.abs(h-m[0]),B=Math.abs(x-m[1]);(r.value?M>B&&M>3:B>M&&B>3)?(u.value=!0,v=!1):(r.value?B:M)>3&&(v=!1)}if(!u.value)return;p.preventDefault(),w(p);const T=I(r.value?h:x,!1);y.value=Math.max(0,Math.min(1,T)),T>1?d.value=C(r.value?h:x,!0):T<0&&(d.value=C(r.value?h:x,!1))}function H(p){if(v=!1,!u.value)return;w(p),u.value=!1;const h=b(p.changedTouches[0].identifier),x=Math.abs(h.x),T=Math.abs(h.y);(r.value?x>T&&x>400:T>x&&T>3)?n.value=h.direction===({left:"right",right:"left",top:"down",bottom:"up"}[s.value]||Y()):n.value=y.value>.5}const W=_(()=>u.value?{transform:s.value==="left"?`translateX(calc(-100% + ${y.value*o.value}px))`:s.value==="right"?`translateX(calc(100% - ${y.value*o.value}px))`:s.value==="top"?`translateY(calc(-100% + ${y.value*o.value}px))`:s.value==="bottom"?`translateY(calc(100% - ${y.value*o.value}px))`:Y(),transition:"none"}:void 0);return $(u,()=>{const p=t.value?.style.transform??null,h=t.value?.style.transition??null;xe(()=>{t.value?.style.setProperty("transform",W.value?.transform||"none"),t.value?.style.setProperty("transition",W.value?.transition||null)}),$e(()=>{t.value?.style.setProperty("transform",p),t.value?.style.setProperty("transition",h)})}),{isDragging:u,dragProgress:y,dragStyles:W}}function Y(){throw new Error}const da=["start","end","left","right","top","bottom"],ma=F({color:String,disableResizeWatcher:Boolean,disableRouteWatcher:Boolean,expandOnHover:Boolean,floating:Boolean,modelValue:{type:Boolean,default:null},permanent:Boolean,rail:{type:Boolean,default:null},railWidth:{type:[Number,String],default:56},scrim:{type:[Boolean,String],default:!0},image:String,temporary:Boolean,persistent:Boolean,touchless:Boolean,width:{type:[Number,String],default:256},location:{type:String,default:"start",validator:e=>da.includes(e)},sticky:Boolean,...Me(),...ve(),...ft(),...kt({mobile:null}),...Le(),...je(),...Ee(),...me({tag:"nav"}),...He()},"VNavigationDrawer"),va=X()({name:"VNavigationDrawer",props:ma(),emits:{"update:modelValue":e=>!0,"update:rail":e=>!0},setup(e,t){let{attrs:n,emit:a,slots:o}=t;const{isRtl:l}=ze(),{themeClasses:s}=Re(e),{borderClasses:r}=Ie(e),{backgroundColorClasses:w,backgroundColorStyles:g}=ce(()=>e.color),{elevationClasses:b}=Ce(e),{displayClasses:v,mobile:u}=Ne(e),{roundedClasses:y}=De(e),d=dt(),m=Ue(e,"modelValue",null,D=>!!D),{ssrBootStyles:C}=qe(),{scopeId:I}=mt(),S=R(),L=P(!1),{runOpenDelay:H,runCloseDelay:W}=vt(e,D=>{L.value=D}),p=_(()=>e.rail&&e.expandOnHover&&L.value?Number(e.width):Number(e.rail?e.railWidth:e.width)),h=_(()=>Tt(e.location,l.value)),x=j(()=>e.persistent),T=_(()=>!e.permanent&&(u.value||e.temporary)),M=_(()=>e.sticky&&!T.value&&h.value!=="bottom");$(()=>e.expandOnHover&&e.rail!=null,()=>{z(L,D=>a("update:rail",!D))}),$(()=>!e.disableResizeWatcher,()=>{z(T,D=>!e.permanent&&et(()=>m.value=!D))}),$(()=>!e.disableRouteWatcher&&!!d,()=>{z(d.currentRoute,()=>T.value&&(m.value=!1))}),z(()=>e.permanent,D=>{D&&(m.value=!0)}),e.modelValue==null&&!T.value&&(m.value=e.permanent||!u.value);const{isDragging:B,dragProgress:k}=ca({el:S,isActive:m,isTemporary:T,width:p,touchless:j(()=>e.touchless),position:h}),le=_(()=>{const D=T.value?0:e.rail&&e.expandOnHover?Number(e.railWidth):p.value;return B.value?D*k.value:D}),{layoutItemStyles:fe,layoutItemScrimStyles:Je}=Ye({id:e.name,order:_(()=>parseInt(e.order,10)),position:h,layoutSize:le,elementSize:p,active:tt(m),disableTransitions:j(()=>B.value),absolute:_(()=>e.absolute||M.value&&typeof ge.value!="string")}),{isStuck:ge,stickyStyles:Ge}=la({rootEl:S,isSticky:M,layoutItemStyles:fe}),he=ce(()=>typeof e.scrim=="string"?e.scrim:null),Qe=_(()=>({...B.value?{opacity:k.value*.2,transition:"none"}:void 0,...Je.value}));return We({VList:{bgColor:"transparent"}}),Z(()=>{const D=o.image||e.image;return f(Te,null,[i(e.tag,q({ref:S,onMouseenter:H,onMouseleave:W,class:["v-navigation-drawer",`v-navigation-drawer--${h.value}`,{"v-navigation-drawer--expand-on-hover":e.expandOnHover,"v-navigation-drawer--floating":e.floating,"v-navigation-drawer--is-hovering":L.value,"v-navigation-drawer--rail":e.rail,"v-navigation-drawer--temporary":T.value,"v-navigation-drawer--persistent":x.value,"v-navigation-drawer--active":m.value,"v-navigation-drawer--sticky":M.value},s.value,w.value,r.value,v.value,b.value,y.value,e.class],style:[g.value,fe.value,C.value,Ge.value,e.style]},I,n),{default:()=>[D&&f("div",{key:"image",class:"v-navigation-drawer__img"},[o.image?i(ae,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{alt:"",cover:!0,height:"inherit",src:e.image}}},o.image):i(K,{key:"image-img",alt:"",cover:!0,height:"inherit",src:e.image},null)]),o.prepend&&f("div",{class:"v-navigation-drawer__prepend"},[o.prepend?.()]),f("div",{class:"v-navigation-drawer__content"},[o.default?.()]),o.append&&f("div",{class:"v-navigation-drawer__append"},[o.append?.()])]}),i(at,{name:"fade-transition"},{default:()=>[T.value&&(B.value||m.value)&&!!e.scrim&&f("div",q({class:["v-navigation-drawer__scrim",he.backgroundColorClasses.value],style:[Qe.value,he.backgroundColorStyles.value],onClick:()=>{x.value||(m.value=!1)}},I),null)]})])}),{isStuck:ge}}}),fa={class:"pa-4 d-flex align-center"},ga={class:"text-h6 font-weight-bold"},ha={class:"pa-4"},ba={key:1,class:"text-caption font-weight-bold"},pa={key:0,class:"d-flex flex-column align-start"},ya={class:"text-body-2 font-weight-medium"},wa={class:"text-caption text-medium-emphasis"},Sa={class:"d-flex align-center"},_a={key:1,class:"text-h6 font-weight-bold"},xa={class:"flex-grow-1"},Ta={class:"text-subtitle-1 font-weight-medium"},ka={class:"text-caption text-medium-emphasis"};function Va(e,t,n,a,o,l){const s=ot("router-view");return A(),O(gt,null,{default:c(()=>[i(va,{modelValue:a.drawer,"onUpdate:modelValue":t[0]||(t[0]=r=>a.drawer=r),rail:a.rail&&!a.mobile,permanent:!a.mobile,temporary:a.mobile,color:"background",class:"elevation-2"},{append:c(()=>[f("div",ha,[i(te,{color:"primary",variant:"tonal","prepend-icon":"mdi-domain",block:""},{default:c(()=>[...t[6]||(t[6]=[V(" PRODEB - Bahia ",-1)])]),_:1})])]),default:c(()=>[f("div",fa,[i(ie,{size:a.rail&&!a.mobile?32:40,class:"mr-3",color:"primary"},{default:c(()=>[i(K,{src:a.logo,contain:"",alt:"Mira logo"},null,8,["src"])]),_:1},8,["size"]),nt(f("div",ga,[...t[5]||(t[5]=[f("span",{class:"text-primary"},"Mira",-1),f("span",{class:"text-medium-emphasis"}," Analytics",-1)])],512),[[lt,!a.rail||a.mobile]])]),i(se,{class:"mx-2"}),i(re,{nav:"",density:"comfortable",class:"pa-2"},{default:c(()=>[(A(),G(Te,null,it(a.menuItems,r=>i(J,{key:r.title,to:r.to,title:r.title,"prepend-icon":r.icon,class:"mb-1",rounded:"lg"},{prepend:c(()=>[i(N,{color:r.color},{default:c(()=>[V(E(r.icon),1)]),_:2},1032,["color"])]),_:2},1032,["to","title","prepend-icon"])),64))]),_:1})]),_:1},8,["modelValue","rail","permanent","temporary"]),i(ta,{height:a.appBarHeight,color:"surface",elevation:"1",class:"px-4"},{default:c(()=>[i(oa,{onClick:a.toggleDrawer},{default:c(()=>[i(N,null,{default:c(()=>[V(E(a.rail&&!a.mobile?"mdi-menu-open":"mdi-menu"),1)]),_:1})]),_:1}),i(na,{class:"text-h6 font-weight-medium"},{default:c(()=>[V(E(e.$route.meta.title||"Dashboard"),1)]),_:1}),i(Ae),i(U,{icon:a.isDark?"mdi-weather-sunny":"mdi-weather-night",variant:"text",class:"mr-2",onClick:a.toggleTheme,title:a.isDark?"Modo Claro":"Modo Escuro"},null,8,["icon","title"]),i(U,{icon:"mdi-bell-outline",variant:"text",class:"mr-2"}),a.isDemoUser?(A(),O(te,{key:0,color:"warning",variant:"flat","prepend-icon":"mdi-test-tube",size:"small",class:"mr-2",title:"Modo demonstração - Todos os dados são fictícios"},{default:c(()=>[...t[7]||(t[7]=[V(" DEMO ",-1)])]),_:1})):ue("",!0),i(te,{color:"success",variant:"tonal","prepend-icon":"mdi-check-circle",size:"small",class:"mr-4"},{default:c(()=>[...t[8]||(t[8]=[V(" Sistema Online ",-1)])]),_:1}),i(Vt,{modelValue:a.userMenuOpen,"onUpdate:modelValue":t[4]||(t[4]=r=>a.userMenuOpen=r),"close-on-content-click":!1,location:"bottom end"},{activator:c(({props:r})=>[i(U,q(r,{variant:"text",class:"text-none"}),{default:c(()=>[i(ie,{size:"32",class:"mr-2"},{default:c(()=>[a.authStore.user?.avatarUrl?(A(),O(K,{key:0,src:a.authStore.user.avatarUrl,alt:a.authStore.user.fullName},null,8,["src","alt"])):(A(),G("span",ba,E(a.getUserInitials(a.authStore.user?.fullName||a.authStore.user?.username||"U")),1))]),_:1}),a.mobile?ue("",!0):(A(),G("div",pa,[f("span",ya,E(a.authStore.user?.fullName||a.authStore.user?.username||"Usuário"),1),f("span",wa,E(a.authStore.user?.email||"email@example.com"),1)])),i(N,{class:"ml-2",size:"16"},{default:c(()=>[...t[9]||(t[9]=[V("mdi-chevron-down",-1)])]),_:1})]),_:1},16)]),default:c(()=>[i(Pe,{"min-width":"280"},{default:c(()=>[i(Be,{class:"pb-2"},{default:c(()=>[f("div",Sa,[i(ie,{size:"48",class:"mr-3"},{default:c(()=>[a.authStore.user?.avatarUrl?(A(),O(K,{key:0,src:a.authStore.user.avatarUrl,alt:a.authStore.user.fullName},null,8,["src","alt"])):(A(),G("span",_a,E(a.getUserInitials(a.authStore.user?.fullName||a.authStore.user?.username||"U")),1))]),_:1}),f("div",xa,[f("div",Ta,E(a.authStore.user?.fullName||a.authStore.user?.username||"Usuário"),1),f("div",ka,E(a.authStore.user?.email||"email@example.com"),1),i(te,{size:"x-small",color:"primary",variant:"tonal",class:"mt-1"},{default:c(()=>[V(E(a.authStore.userRole||"user"),1)]),_:1})])])]),_:1}),i(se),i(re,{density:"compact",nav:""},{default:c(()=>[i(J,{"prepend-icon":"mdi-account-circle",title:"Meu Perfil",to:"/profile",onClick:t[1]||(t[1]=r=>a.userMenuOpen=!1)}),i(J,{"prepend-icon":"mdi-key",title:"Meus Tokens",to:"/api-tokens",onClick:t[2]||(t[2]=r=>a.userMenuOpen=!1)}),i(J,{"prepend-icon":"mdi-cog",title:"Configurações",to:"/settings",onClick:t[3]||(t[3]=r=>a.userMenuOpen=!1)})]),_:1}),i(se),i(re,{density:"compact"},{default:c(()=>[i(J,{"prepend-icon":"mdi-logout",title:"Sair",onClick:a.handleLogout,class:"text-error"},{prepend:c(()=>[i(N,{color:"error"},{default:c(()=>[...t[10]||(t[10]=[V("mdi-logout",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["height"]),i(Dt,null,{default:c(()=>[i(Ct,{fluid:"",class:"pa-6"},{default:c(()=>[i(s)]),_:1})]),_:1}),i(a.IdleTimeoutWarning,{show:a.isWarningVisible,"time-remaining":a.timeRemaining,"total-warning-time":a.warningTimeout,onExtend:a.extendSession,onLogout:a.forceLogout},null,8,["show","time-remaining","total-warning-time","onExtend","onLogout"]),i(a.CrossTabNotification,{enabled:!0})]),_:1})}const Ia=ne(Gt,[["render",Va],["__scopeId","data-v-43f34b0e"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/layout/AppLayout.vue"]]),Ca=oe({__name:"MainLayout",setup(e,{expose:t}){t();const n={AppLayout:Ia};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}});function Da(e,t,n,a,o,l){return A(),O(a.AppLayout)}const Za=ne(Ca,[["render",Da],["__file","D:/Development/Projetos/Mira/mira-client/src/layouts/MainLayout.vue"]]);export{Za as default};
