import{k as Z,W as J,f as c,j as K,E as Y,X as m,z as r,q as s,Q as x,_ as b,T as l,a1 as n,S as i,a4 as d,F as $,a8 as ee,v as te,Z as F}from"./vendor-vue-BvKyvIVR.js";import{r as oe}from"./repositories-DZyFHAle.js";import{u as ae,a as se}from"./VChip-BzUv3cXC.js";import{_ as re}from"./index-CQBjCOQw.js";import{f as y,j as N,o as le,k as U,l as ie,n as ne,p as de}from"./VGrid-CuJrScxf.js";import{V as ue}from"./VAlert-ChhMmNH2.js";import{V as P,a as v}from"./VRow-C_rLTo1r.js";import{V as C}from"./VIcon-CM-KW5Qw.js";import{V as ce}from"./VPagination-C7VPvwfo.js";import{V as me,a as L}from"./VSelect-JVxEisdn.js";import{V as fe}from"./VSpacer-kp13s616.js";import"./auth-PiWOMLtm.js";import"./vendor-utils-Cfk84l6i.js";import"./token-storage.service-BqAv9k07.js";import"./vendor-ui-Dz8XL-co.js";import"./tag-Bnbpnddf.js";import"./dimensions-DVh0fwa7.js";import"./autofocus-Bh6bNAdk.js";import"./forwardRefs-D_qxKlPu.js";import"./VList-CaAoEaF2.js";import"./ssrBoot-COakMcr6.js";import"./VMenu-B2XC7rkF.js";import"./lazy-DADzjSlN.js";const ve=Z({__name:"RepositoriesView",setup(T,{expose:e}){e();const h=J(),{isDemoUser:t}=ae(),_=c([]),k=c(!1),o=c(null),f=c(1),R=c(1),S=c(0),D=c(20),p=c("all"),g=c("all"),V=c(""),j=K(()=>{let a=_.value;if(p.value!=="all"&&(a=a.filter(u=>u.platform===p.value)),g.value!=="all"&&(a=a.filter(u=>u.syncStatus===g.value)),V.value.trim()){const u=V.value.toLowerCase().trim();a=a.filter(A=>A.name.toLowerCase().includes(u)||A.fullName.toLowerCase().includes(u))}return a}),B=[{value:"all",title:"Todas as Plataformas"},{value:"gitlab",title:"GitLab"},{value:"github",title:"GitHub"},{value:"bitbucket",title:"Bitbucket"}],E=[{value:"all",title:"Todos os Status"},{value:"active",title:"Ativo"},{value:"paused",title:"Pausado"},{value:"error",title:"Erro"}];async function w(){k.value=!0,o.value=null;try{const a={platform:p.value!=="all"?p.value:void 0,status:g.value!=="all"?g.value:void 0,search:V.value||void 0},u=await oe.getRepositories(f.value,D.value,a);_.value=u.data,R.value=u.totalPages,S.value=u.total}catch(a){o.value=a instanceof Error?a.message:"Erro ao carregar repositórios",console.error("Error loading repositories:",a)}finally{k.value=!1}}function I(a){switch(a.toLowerCase()){case"gitlab":return"mdi-gitlab";case"github":return"mdi-github";case"bitbucket":return"mdi-bitbucket";default:return"mdi-source-repository"}}function M(a){switch(a.toLowerCase()){case"gitlab":return"orange";case"github":return"grey-darken-2";case"bitbucket":return"blue";default:return"grey"}}function O(a){switch(a){case"active":return"success";case"paused":return"warning";case"error":return"error";default:return"grey"}}function Q(a){switch(a){case"active":return"Ativo";case"paused":return"Pausado";case"error":return"Erro";default:return a}}function q(a){return a?new Date(a).toLocaleString("pt-BR"):"Nunca"}function G(a){h.push(`/repositories/${a.id}`)}function H(a){f.value=a,w()}function W(){f.value=1,w()}function X(a){a.webUrl&&window.open(a.webUrl,"_blank")}Y(()=>{w()});const z={router:h,isDemoUser:t,repositories:_,loading:k,error:o,currentPage:f,totalPages:R,totalRepositories:S,itemsPerPage:D,platformFilter:p,statusFilter:g,searchQuery:V,filteredRepositories:j,platformOptions:B,statusOptions:E,loadRepositories:w,getPlatformIcon:I,getPlatformColor:M,getStatusColor:O,getStatusText:Q,formatDate:q,viewRepositoryDetails:G,changePage:H,refreshRepositories:W,openRepository:X};return Object.defineProperty(z,"__isScriptSetup",{enumerable:!1,value:!0}),z}}),pe={class:"repositories-page"},ge={class:"d-flex align-center justify-space-between mb-6"},xe={class:"d-flex align-center gap-3"},be={class:"d-flex align-center justify-space-between mb-4"},ye={class:"text-body-2 text-grey-darken-1"},_e={key:1,class:"text-center py-12"},ke={key:2},Ve={class:"flex-grow-1"},we={class:"text-h6 font-weight-bold text-truncate"},Ce={class:"text-caption text-grey-darken-1 text-truncate"},he={class:"text-center"},Pe={class:"text-h6 font-weight-bold text-primary"},Re={class:"text-center"},Se={key:0,class:"mb-3"},De={class:"d-flex align-center justify-space-between mb-1"},ze={class:"text-caption font-weight-medium"},Ae={class:"text-caption text-grey-darken-1"},Fe={class:"mb-1"},Ne={key:3,class:"text-center py-12"},Ue={key:1,class:"text-body-2 text-grey-darken-1 mt-2"},Le={key:4,class:"d-flex justify-center mt-6"};function Te(T,e,h,t,_,k){return i(),m("div",pe,[r("div",ge,[e[9]||(e[9]=r("div",null,[r("h1",{class:"text-h4 font-weight-bold text-grey-darken-3 mb-2"}," Repositórios "),r("p",{class:"text-body-1 text-grey-darken-1"}," Gerencie e monitore todos os repositórios conectados ")],-1)),r("div",xe,[s(y,{color:"primary","prepend-icon":"mdi-refresh",onClick:t.refreshRepositories,loading:t.loading},{default:l(()=>[...e[7]||(e[7]=[d(" Atualizar ",-1)])]),_:1},8,["loading"]),t.isDemoUser?b("",!0):(i(),x(y,{key:0,color:"success","prepend-icon":"mdi-plus",variant:"elevated",onClick:e[0]||(e[0]=o=>t.router.push("/repositories/add"))},{default:l(()=>[...e[8]||(e[8]=[d(" Adicionar Repositório ",-1)])]),_:1}))])]),s(N,{class:"mb-6",elevation:"2"},{default:l(()=>[s(U,null,{default:l(()=>[s(P,null,{default:l(()=>[s(v,{cols:"12",md:"4"},{default:l(()=>[s(me,{modelValue:t.searchQuery,"onUpdate:modelValue":e[1]||(e[1]=o=>t.searchQuery=o),label:"Buscar repositórios","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),s(v,{cols:"12",md:"4"},{default:l(()=>[s(L,{modelValue:t.platformFilter,"onUpdate:modelValue":e[2]||(e[2]=o=>t.platformFilter=o),items:t.platformOptions,label:"Plataforma",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),s(v,{cols:"12",md:"4"},{default:l(()=>[s(L,{modelValue:t.statusFilter,"onUpdate:modelValue":e[3]||(e[3]=o=>t.statusFilter=o),items:t.statusOptions,label:"Status",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),r("div",be,[r("div",ye," Mostrando "+n(t.filteredRepositories.length)+" de "+n(t.totalRepositories)+" repositórios ",1)]),t.error?(i(),x(ue,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:"","onClick:close":e[4]||(e[4]=o=>t.error=null)},{default:l(()=>[d(n(t.error),1)]),_:1})):b("",!0),t.loading?(i(),m("div",_e,[s(le,{indeterminate:"",color:"primary",size:"64"}),e[10]||(e[10]=r("p",{class:"text-body-1 text-grey-darken-1 mt-4"}," Carregando repositórios... ",-1))])):t.filteredRepositories.length>0?(i(),m("div",ke,[s(P,null,{default:l(()=>[(i(!0),m($,null,ee(t.filteredRepositories,o=>(i(),x(v,{key:o.id,cols:"12",md:"6",lg:"4"},{default:l(()=>[s(N,{elevation:"2",hover:"",class:"repository-card h-100",onClick:f=>t.viewRepositoryDetails(o)},{default:l(()=>[s(ie,{class:"d-flex align-center"},{default:l(()=>[s(C,{icon:t.getPlatformIcon(o.platform),color:t.getPlatformColor(o.platform),class:"me-2",size:"24"},null,8,["icon","color"]),r("div",Ve,[r("div",we,n(o.name),1),r("div",Ce,n(o.fullName),1)]),s(se,{color:t.getStatusColor(o.syncStatus),size:"small",variant:"tonal"},{default:l(()=>[d(n(t.getStatusText(o.syncStatus)),1)]),_:2},1032,["color"])]),_:2},1024),s(U,null,{default:l(()=>[s(P,{class:"mb-3"},{default:l(()=>[s(v,{cols:"6"},{default:l(()=>[r("div",he,[r("div",Pe,n(o.analysesCount),1),e[11]||(e[11]=r("div",{class:"text-caption text-grey-darken-1"},"Análises",-1))])]),_:2},1024),s(v,{cols:"6"},{default:l(()=>[r("div",Re,[r("div",{class:te(["text-h6 font-weight-bold",o.issuesCount>0?"text-warning":"text-success"])},n(o.issuesCount),3),e[12]||(e[12]=r("div",{class:"text-caption text-grey-darken-1"},"Issues",-1))])]),_:2},1024)]),_:2},1024),o.averageScore?(i(),m("div",Se,[r("div",De,[e[13]||(e[13]=r("span",{class:"text-caption text-grey-darken-1"},"Score Médio",-1)),r("span",ze,n(o.averageScore.toFixed(1)),1)]),s(ne,{"model-value":o.averageScore*10,color:o.averageScore>=8?"success":o.averageScore>=6?"warning":"error",height:"4",rounded:""},null,8,["model-value","color"])])):b("",!0),r("div",Ae,[r("div",Fe,[s(C,{size:"12",class:"me-1"},{default:l(()=>[...e[14]||(e[14]=[d("mdi-clock-outline",-1)])]),_:1}),d(" Última análise: "+n(t.formatDate(o.lastAnalysisAt)),1)]),r("div",null,[s(C,{size:"12",class:"me-1"},{default:l(()=>[...e[15]||(e[15]=[d("mdi-sync",-1)])]),_:1}),d(" Última sincronização: "+n(t.formatDate(o.lastSyncAt)),1)])])]),_:2},1024),s(de,null,{default:l(()=>[s(y,{variant:"text",size:"small","prepend-icon":"mdi-eye",onClick:F(f=>t.viewRepositoryDetails(o),["stop"])},{default:l(()=>[...e[16]||(e[16]=[d(" Ver Detalhes ",-1)])]),_:1},8,["onClick"]),s(fe),o.webUrl?(i(),x(y,{key:0,variant:"text",size:"small",icon:t.getPlatformIcon(o.platform),onClick:F(f=>t.openRepository(o),["stop"])},null,8,["icon","onClick"])):b("",!0)]),_:2},1024)]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})])):(i(),m("div",Ne,[s(C,{size:"64",color:"grey-lighten-1",class:"mb-4"},{default:l(()=>[...e[17]||(e[17]=[d(" mdi-source-repository-multiple ",-1)])]),_:1}),e[20]||(e[20]=r("h3",{class:"text-h6 text-grey-darken-1 mb-2"}," Nenhum repositório encontrado ",-1)),e[21]||(e[21]=r("p",{class:"text-body-2 text-grey-darken-1 mb-4"}," Não há repositórios que correspondam aos filtros selecionados. ",-1)),t.isDemoUser?(i(),m("div",Ue,[...e[19]||(e[19]=[r("em",null,"No modo demonstração, não é possível adicionar novos repositórios.",-1)])])):(i(),x(y,{key:0,color:"success","prepend-icon":"mdi-plus",variant:"elevated",onClick:e[5]||(e[5]=o=>t.router.push("/repositories/add"))},{default:l(()=>[...e[18]||(e[18]=[d(" Adicionar Primeiro Repositório ",-1)])]),_:1}))])),t.totalPages>1?(i(),m("div",Le,[s(ce,{modelValue:t.currentPage,"onUpdate:modelValue":[e[6]||(e[6]=o=>t.currentPage=o),t.changePage],length:t.totalPages,"total-visible":7},null,8,["modelValue","length"])])):b("",!0)])}const lt=re(ve,[["render",Te],["__scopeId","data-v-5e274369"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/repositories/RepositoriesView.vue"]]);export{lt as default};
