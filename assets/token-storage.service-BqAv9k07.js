class o{ACCESS_TOKEN_KEY="mira_access_token";REFRESH_TOKEN_KEY="mira_refresh_token";USER_KEY="mira_user";setTokens(e,t,s){localStorage.setItem(this.ACCESS_TOKEN_KEY,e),localStorage.setItem(this.REFRESH_TOKEN_KEY,t),localStorage.setItem(this.USER_KEY,JSON.stringify(s))}getAccessToken(){return localStorage.getItem(this.ACCESS_TOKEN_KEY)}getRefreshToken(){return localStorage.getItem(this.REFRESH_TOKEN_KEY)}getUser(){const e=localStorage.getItem(this.USER_KEY);return e?JSON.parse(e):null}setAccessToken(e){localStorage.setItem(this.ACCESS_TOKEN_KEY,e)}hasTokens(){return!!(this.getAccessToken()&&this.getRefreshToken())}clearTokens(){localStorage.removeItem(this.ACCESS_TOKEN_KEY),localStorage.removeItem(this.REFRESH_TOKEN_KEY),localStorage.removeItem(this.USER_KEY)}isTokenExpired(){const e=this.getAccessToken();if(!e)return!0;try{const t=e.split(".");if(t.length!==3)return!0;const s=JSON.parse(atob(t[1])),r=Date.now()/1e3;return s.exp<r}catch{return!0}}}const a=new o;export{a as tokenStorage};
