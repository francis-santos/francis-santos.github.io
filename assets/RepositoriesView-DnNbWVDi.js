import{j as he,d as v,r as Se,h as T,w as _e,D as xe,Z as w,_ as m,n as s,u as _,a1 as o,y as t,V as d,a6 as be,a0 as p,$ as g,aa as n,v as ve,U as De,Y as Re,F as Pe,ah as Ne,q as le,ab as Ue}from"./vendor-vue-BKuzT1x2.js";import{r as Ce}from"./repositories-Bk5__bRQ.js";import{u as ke}from"./useDemoMode-DpDjlFnd.js";import{u as Ve,g as pe}from"./git-integrations-BZ_XeP7w.js";import{a as z,V as ze,c as Ie,b as Le}from"./VChip-BfcyEr4e.js";import{V as Q,b as fe}from"./VGrid-CBGRWS1y.js";import{a as c,_ as $e,b as A,c as Oe,t as je}from"./index-gFSB3kms.js";import{V as Fe}from"./VForm-DthKd8zl.js";import{a as J,V as Te}from"./VSelect-BorMXFwi.js";import{V as ie,d as ge,a as Be}from"./VList-Dg4abNUz.js";import{V as F}from"./VAlert-BZmB2o6G.js";import{V as we}from"./VAutocomplete-CYtzIYoF.js";import{V as Ee}from"./VSpacer-CTPiANoM.js";import{V as K,a as h}from"./VRow-C_u8820H.js";import{V as qe}from"./VPagination-B83tja3x.js";import{V as Ge}from"./VDialog-BfRWf8LZ.js";import"./auth.service-BozCwdnf.js";import"./vendor-utils-6xD0fNU8.js";import"./token-storage.service-BqAv9k07.js";import"./auth--EmZq-C7.js";import"./vendor-ui-Ca7vMALJ.js";import"./form-PEXhLZdP.js";import"./autofocus-Cv2p5X6o.js";import"./dialog-transition-B8nu4acL.js";import"./VMenu-BCjbZdow.js";import"./ssrBoot-DJyMk-ri.js";import"./filter-BaTOFc6H.js";const Me={class:"repository-form"},Qe={class:"d-flex align-center"},He={class:"org-icon-wrapper"},We={class:"flex-grow-1 ml-4"},Ye={class:"org-title"},Ze={class:"org-subtitle"},Je={class:"form-section mb-6"},Ke={class:"section-header mb-4"},Xe={class:"platform-icon-wrapper mr-3"},et={class:"text-caption"},tt={class:"d-flex align-center"},at={class:"platform-name"},st={class:"text-caption text--secondary"},ot={key:0,class:"mt-4"},lt={class:"d-flex align-center mb-3"},it={class:"font-weight-medium"},rt={class:"git-project-avatar mr-3"},nt={class:"me-2"},dt={class:"d-flex align-center"},ct={class:"font-weight-medium"},ut={class:"text-caption text--secondary"},mt={class:"mt-2 mb-0 pl-4"},vt={class:"d-flex align-center mb-3"},pt={class:"git-repo-avatar mr-3"},ft={class:"me-2"},gt={class:"d-flex align-center mr-3"},bt={class:"font-weight-medium"},yt={class:"text-caption text--secondary"},_t={key:3,class:"selected-repo-info mt-3"},wt={class:"d-flex align-center"},ht={key:0,class:"form-section mb-6"},St={class:"section-header mb-4"},xt={class:"text-field-display"},Ct={class:"field-label"},kt={class:"field-value"},Vt={class:"text-field-display"},zt={class:"field-label"},$t={class:"field-value"},At={class:"text-field-display"},Dt={class:"field-label"},Rt={class:"field-value"},Pt={class:"text-field-display"},Nt={class:"field-label"},Ut={class:"field-value"},It={key:1,class:"form-section mb-6"},Lt={class:"section-header mb-4"},Ot={class:"text-field-display"},jt={class:"field-label"},Ft={class:"field-value url-value"},Tt={class:"text-field-display"},Bt={class:"field-label"},Et={class:"field-value url-value"},qt={key:2,class:"form-section mb-6"},Gt={class:"section-header mb-4"},Mt={class:"text-field-display"},Qt={class:"field-label"},Ht={class:"field-value description-value"},Wt={class:"privacy-section readonly-section"},Yt={class:"privacy-display"},Zt={class:"privacy-label"},Jt={class:"privacy-text"},Kt={class:"privacy-hint"},Xt={class:"error-content"},ea={class:"error-message"},ta=he({__name:"RepositoryForm",emits:["success","cancel"],setup(Ae,{expose:re,emit:B}){const ne=B,L=v(),R=v(!1),P=v(!1),b=v(""),S=v([]),N=v(!1),D=v(null),C=v(""),x=v([]),k=v(!1),y=v(null),{isDemoUser:f}=ke(),{organizationId:E,organizationName:u}=Ve(),V=f.value?"b1e58ac3-6a88-4fc3-846d-352c8ca4a1db":E.value||"",H=f.value?"Mira Tech Solutions (Demo)":u.value||"Organização",i=Se({name:"",fullName:"",platform:null,externalId:"",cloneUrl:"",webUrl:"",description:"",defaultBranch:"main",isPrivate:!0,organizationId:V}),X=v([]),O=v(!1),q=T(()=>X.value.filter(e=>e.enabled).map(e=>{const a=e.type.toLowerCase(),l={gitlab:"mdi-gitlab",github:"mdi-github",bitbucket:"mdi-bitbucket"}[a]||"mdi-source-repository",$={gitlab:"#FC6D26",github:"#24292e",bitbucket:"#0052CC"}[a]||"#000000";return{title:e.name,value:a,icon:l,color:$,repositoryCount:e.repositoryCount||0,enabled:e.enabled}}));_e(()=>i.platform,async(e,a)=>{D.value=null,y.value=null,x.value=[],S.value=[],M.value=[],C.value="",se(),e&&e!==a&&await ee(e)}),_e(()=>D.value,async e=>{e?(await ce(i.platform,e.id),y.value=null,se()):x.value=[]});const W=T(()=>S.value.length>0),de=T(()=>x.value.length>0),G=T(()=>f.value||y.value!==null),j=T(()=>f.value?R.value:R.value&&y.value!==null),U={required:e=>!!e||"Campo obrigatório",repositoryRequired:e=>f.value?!0:!!e||"Selecione um repositório",maxLength:e=>a=>!a||a.length<=e||`Máximo ${e} caracteres`,url:e=>{if(!e)return!0;try{return new URL(e),!0}catch{return"URL inválida"}}},ee=async e=>{if(!e||!V){S.value=[];return}N.value=!0,b.value="";try{const a=await pe.getProjects(V,e.toUpperCase());M.value=a,S.value=[...a]}catch(a){b.value=`Erro ao carregar projetos do ${e.toUpperCase()}`,console.error("Error loading git projects:",a),S.value=[]}finally{N.value=!1}},M=v([]);let Y;const te=e=>{C.value=e,Y&&clearTimeout(Y),Y=setTimeout(()=>{if(e&&e.length>=2){const a=M.value.filter(l=>l.name.toLowerCase().includes(e.toLowerCase())||l.fullName.toLowerCase().includes(e.toLowerCase()));S.value=a}else e||(S.value=[...M.value])},300)},ce=async(e,a)=>{if(!e||!V){x.value=[];return}k.value=!0,b.value="";try{const l={limit:50,includeForks:!1};a&&(e.toLowerCase()==="gitlab"?l.projectId=a:e.toLowerCase()==="github"?l.owner=a:e.toLowerCase()==="bitbucket"&&(l.workspace=a));const $=await pe.discoverRepositories(V,e.toUpperCase(),l);x.value=$}catch(l){b.value=`Erro ao carregar repositórios do ${e.toUpperCase()}`,console.error("Error loading git repositories:",l),x.value=[]}finally{k.value=!1}},ue=e=>{D.value=e},ae=e=>{y.value=e,i.name=e.name,i.fullName=e.fullName,i.externalId=e.id,i.cloneUrl=e.cloneUrl,i.webUrl=e.webUrl,i.description=e.description||"",i.defaultBranch=e.defaultBranch,i.isPrivate=e.isPrivate},me=e=>({group:"purple",project:"blue",user:"green",organization:"orange",workspace:"teal"})[e]||"grey",Z=e=>({group:"Grupo",project:"Projeto",user:"Usuário",organization:"Organização",workspace:"Workspace"})[e]||e,se=()=>{i.name="",i.fullName="",i.externalId="",i.cloneUrl="",i.webUrl="",i.description="",i.defaultBranch="main",i.isPrivate=!0},oe=async()=>{if(!L.value)return;const{valid:e}=await L.value.validate();if(!f.value&&!y.value){b.value="Selecione um repositório para continuar";return}if(e){P.value=!0,b.value="";try{await Ce.createRepository(i),ne("success")}catch(a){b.value=a instanceof Error?a.message:"Erro ao criar repositório"}finally{P.value=!1}}},r=async()=>{if(V){O.value=!0;try{const e=await pe.getConfiguredPlatforms(V);X.value=e}catch(e){console.error("Error loading configured platforms:",e),b.value="Erro ao carregar plataformas configuradas"}finally{O.value=!1}}};return xe(()=>{r()}),re({handleSubmit:oe,loading:P,isFormValid:j}),(e,a)=>(m(),w("div",Me,[s(Q,{color:_(f)?"warning":"primary",variant:"tonal",class:"organization-card mb-6",elevation:"0"},{default:o(()=>[s(fe,{class:"pa-4"},{default:o(()=>[t("div",Qe,[t("div",He,[s(c,{icon:_(f)?"mdi-account-star":"mdi-domain",size:"24",class:"org-icon"},null,8,["icon"])]),t("div",We,[t("div",Ye,d(_(H)),1),t("div",Ze,d(_(f)?"Conta demo - repositório será simulado nesta organização":"O repositório será adicionado a esta organização"),1)])])]),_:1})]),_:1},8,["color"]),s(Fe,{ref_key:"form",ref:L,modelValue:R.value,"onUpdate:modelValue":a[1]||(a[1]=l=>R.value=l),onSubmit:be(oe,["prevent"]),class:"modern-form"},{default:o(()=>[t("div",Je,[t("div",Ke,[s(c,{icon:"mdi-git",class:"section-icon"}),a[3]||(a[3]=t("h3",{class:"section-title"},"Plataforma Git",-1))]),s(J,{modelValue:i.platform,"onUpdate:modelValue":a[0]||(a[0]=l=>i.platform=l),items:q.value,label:"Selecione a plataforma",variant:"outlined",required:"",rules:[U.required],class:"platform-select",loading:O.value,disabled:O.value||q.value.length===0,"hide-details":"auto",placeholder:"Escolha uma plataforma Git...","no-options-text":"Nenhuma plataforma disponível","no-data-text":"Nenhuma plataforma disponível",clearable:""},{item:o(({item:l,props:$})=>[s(ie,ve($,{class:"platform-item"}),{prepend:o(()=>[t("div",Xe,[s(c,{color:l.raw.color,size:"20"},{default:o(()=>[n(d(l.raw.icon),1)]),_:2},1032,["color"])])]),default:o(()=>[s(ge,{class:"d-flex align-center"},{default:o(()=>[s(z,{size:"x-small",color:l.raw.enabled?"success":"warning",variant:"tonal",class:"me-2"},{default:o(()=>[n(d(l.raw.enabled?"Ativo":"Inativo"),1)]),_:2},1032,["color"]),t("span",et,d(l.raw.repositoryCount)+" repositório(s) cadastrado(s)",1)]),_:2},1024)]),_:2},1040)]),selection:o(({item:l})=>[t("div",tt,[s(c,{color:l.raw.color,class:"me-3",size:"20"},{default:o(()=>[n(d(l.raw.icon),1)]),_:2},1032,["color"]),t("div",null,[t("span",at,d(l.raw.title),1),t("div",st,d(l.raw.repositoryCount)+" repositório(s) cadastrado(s)",1)])])]),_:1},8,["modelValue","items","rules","loading","disabled"]),q.value.length===0&&!O.value?(m(),g(F,{key:0,type:"warning",variant:"tonal",density:"compact",class:"mt-3"},{default:o(()=>[s(c,{icon:"mdi-alert-circle"}),a[4]||(a[4]=n(" Nenhuma plataforma Git configurada ou conectada. ",-1)),a[5]||(a[5]=t("br",null,null,-1)),a[6]||(a[6]=t("small",null,"Configure as integrações Git nas configurações da organização para descobrir repositórios automaticamente.",-1))]),_:1})):p("",!0),s(ze,null,{default:o(()=>[i.platform&&!_(f)?(m(),w("div",ot,[s(Q,{variant:"text",color:"secondary",class:"git-project-selector mb-4",loading:N.value},{default:o(()=>[s(fe,{class:"pa-4"},{default:o(()=>[t("div",lt,[s(c,{icon:"mdi-folder-multiple",class:"me-2",color:"secondary"}),t("span",it,d(i.platform==="gitlab"?"Selecione um projeto":i.platform==="github"?"Selecione um usuário ou organização":"Selecione um workspace"),1)]),W.value?(m(),g(we,{key:0,"model-value":D.value,items:S.value,label:i.platform==="gitlab"?"Buscar projeto...":i.platform==="github"?"Buscar usuário ou organização...":"Buscar workspace...",variant:"outlined","item-title":"name","item-value":"id","return-object":"",clearable:"","no-filter":"",class:"git-project-select",loading:N.value,"onUpdate:modelValue":ue,"onUpdate:search":te},{item:o(({item:l,props:$})=>[s(ie,ve($,{class:"git-project-item"}),{prepend:o(()=>[t("div",rt,[s(c,{icon:l.raw.type==="group"?"mdi-folder-multiple":l.raw.type==="user"?"mdi-account":l.raw.type==="organization"?"mdi-domain":l.raw.type==="workspace"?"mdi-briefcase":"mdi-folder",color:i.platform==="gitlab"?"#FC6D26":i.platform==="github"?"#24292e":"#0052CC",size:"20"},null,8,["icon","color"])])]),default:o(()=>[s(ge,{class:"d-flex align-center"},{default:o(()=>[t("span",nt,d(l.raw.fullName),1),s(z,{size:"x-small",color:me(l.raw.type),variant:"tonal"},{default:o(()=>[n(d(Z(l.raw.type)),1)]),_:2},1032,["color"]),l.raw.visibility?(m(),g(z,{key:0,size:"x-small",class:"ml-1",variant:"tonal"},{default:o(()=>[n(d(l.raw.visibility),1)]),_:2},1024)):p("",!0)]),_:2},1024)]),_:2},1040)]),selection:o(({item:l})=>[t("div",dt,[s(c,{icon:l.raw.type==="group"?"mdi-folder-multiple":l.raw.type==="user"?"mdi-account":l.raw.type==="organization"?"mdi-domain":l.raw.type==="workspace"?"mdi-briefcase":"mdi-folder",color:i.platform==="gitlab"?"#FC6D26":i.platform==="github"?"#24292e":"#0052CC",class:"me-3",size:"20"},null,8,["icon","color"]),t("div",null,[t("div",ct,[n(d(l.raw.name)+" - ",1),t("span",ut,d(l.raw.fullName),1)])])])]),"no-data":o(()=>[s(ie,null,{default:o(()=>[s(Be,null,{default:o(()=>[n(d(C.value?"Nenhum resultado encontrado":"Digite para pesquisar..."),1)]),_:1})]),_:1})]),_:1},8,["model-value","items","label","loading"])):N.value?p("",!0):(m(),g(F,{key:1,type:"warning",variant:"tonal",density:"compact",class:"mt-3"},{default:o(()=>[n(d(i.platform==="gitlab"?"Nenhum projeto encontrado.":i.platform==="github"?"Nenhum usuário ou organização encontrado.":"Nenhum workspace encontrado.")+" ",1),a[10]||(a[10]=t("br",null,null,-1)),t("small",null,[a[9]||(a[9]=n(" Verifique se: ",-1)),t("ul",mt,[t("li",null,"A integração com "+d(q.value.find(l=>l.value===i.platform)?.title)+" está configurada corretamente",1),a[7]||(a[7]=t("li",null,"O token de acesso possui permissões adequadas",-1)),a[8]||(a[8]=t("li",null,"Existem projetos acessíveis na plataforma",-1))])])]),_:1}))]),_:1})]),_:1},8,["loading"]),D.value?(m(),g(Q,{key:0,variant:"tonal",color:"primary",class:"git-repo-selector",loading:k.value},{default:o(()=>[s(fe,{class:"pa-4"},{default:o(()=>[t("div",vt,[s(c,{icon:"mdi-source-repository",class:"me-2",color:"primary"}),a[11]||(a[11]=t("span",{class:"font-weight-medium"},"Selecione um repositório do projeto selecionado *",-1))]),_(f)?p("",!0):(m(),g(F,{key:0,type:"info",variant:"tonal",density:"compact",class:"mb-3"},{default:o(()=>[...a[12]||(a[12]=[n(" A seleção de um repositório é obrigatória para prosseguir com o cadastro. ",-1)])]),_:1})),de.value?(m(),g(we,{key:1,"model-value":y.value,items:x.value,label:"Buscar repositório... *",variant:"outlined","item-title":"name","item-value":"id","return-object":"",clearable:"",class:"git-repo-select",loading:k.value,rules:[U.repositoryRequired],required:!_(f),"onUpdate:modelValue":ae},{item:o(({item:l,props:$})=>[s(ie,ve($,{class:"git-repo-item"}),{prepend:o(()=>[t("div",pt,[s(c,{icon:i.platform==="gitlab"?"mdi-gitlab":i.platform==="github"?"mdi-github":"mdi-bitbucket",color:i.platform==="gitlab"?"#FC6D26":i.platform==="github"?"#24292e":"#0052CC",size:"20"},null,8,["icon","color"])])]),default:o(()=>[s(ge,{class:"d-flex align-center"},{default:o(()=>[t("span",ft,d(l.raw.fullName),1),s(z,{size:"x-small",color:l.raw.isPrivate?"error":"success",variant:"tonal"},{default:o(()=>[n(d(l.raw.isPrivate?"Privado":"Público"),1)]),_:2},1032,["color"]),l.raw.primaryLanguage?(m(),g(z,{key:0,size:"x-small",class:"ml-1",variant:"tonal"},{default:o(()=>[n(d(l.raw.primaryLanguage),1)]),_:2},1024)):p("",!0)]),_:2},1024)]),_:2},1040)]),selection:o(({item:l})=>[t("div",gt,[s(c,{icon:i.platform==="gitlab"?"mdi-gitlab":i.platform==="github"?"mdi-github":"mdi-bitbucket",color:i.platform==="gitlab"?"#FC6D26":i.platform==="github"?"#24292e":"#0052CC",class:"me-3",size:"20"},null,8,["icon","color"]),t("div",null,[t("div",bt,d(l.raw.name),1),t("div",yt,d(l.raw.fullName),1)])])]),_:1},8,["model-value","items","loading","rules","required"])):k.value?p("",!0):(m(),g(F,{key:2,type:"warning",variant:"tonal",density:"compact",class:"mt-3"},{default:o(()=>[...a[13]||(a[13]=[n(" Nenhum repositório encontrado para o projeto selecionado. ",-1),t("br",null,null,-1),t("small",null,[n(" Verifique se: "),t("ul",{class:"mt-2 mb-0 pl-4"},[t("li",null,"O projeto/grupo selecionado contém repositórios"),t("li",null,"O token de acesso possui permissões para listar repositórios"),t("li",null,"Os repositórios não estão em estado privado sem acesso")])],-1)])]),_:1})),y.value?(m(),w("div",_t,[t("div",wt,[s(c,{icon:"mdi-check-circle",color:"success",class:"me-2"}),a[14]||(a[14]=t("span",{class:"text-success font-weight-medium"},"Repositório selecionado - dados preenchidos automaticamente",-1))])])):p("",!0)]),_:1})]),_:1},8,["loading"])):p("",!0)])):p("",!0)]),_:1})]),y.value||_(f)?(m(),w("div",ht,[t("div",St,[s(c,{icon:"mdi-folder-cog",class:"section-icon"}),a[16]||(a[16]=t("h3",{class:"section-title"},"Detalhes do Repositório",-1)),s(Ee),!G.value&&!_(f)?(m(),g(z,{key:0,size:"small",color:"warning",variant:"tonal"},{default:o(()=>[s(c,{icon:"mdi-lock",class:"me-1",size:"14"}),a[15]||(a[15]=n(" Bloqueado ",-1))]),_:1})):p("",!0)]),!G.value&&!_(f)?(m(),g(F,{key:0,type:"info",variant:"tonal",density:"compact",class:"mb-4"},{default:o(()=>[...a[17]||(a[17]=[n(" Selecione um repositório da plataforma Git acima para preencher automaticamente os detalhes. ",-1)])]),_:1})):p("",!0),s(K,{class:"form-fields"},{default:o(()=>[s(h,{cols:"12",md:"6"},{default:o(()=>[t("div",xt,[t("div",Ct,[s(c,{icon:"mdi-folder-outline",class:"field-icon"}),a[18]||(a[18]=n(" Nome do Repositório ",-1))]),t("div",kt,d(i.name||"Não informado"),1)])]),_:1}),s(h,{cols:"12",md:"6"},{default:o(()=>[t("div",Vt,[t("div",zt,[s(c,{icon:"mdi-folder-multiple-outline",class:"field-icon"}),a[19]||(a[19]=n(" Nome Completo ",-1))]),t("div",$t,d(i.fullName||"Não informado"),1)])]),_:1}),s(h,{cols:"12",md:"6"},{default:o(()=>[t("div",At,[t("div",Dt,[s(c,{icon:"mdi-identifier",class:"field-icon"}),a[20]||(a[20]=n(" ID Externo ",-1))]),t("div",Rt,d(i.externalId||"Não informado"),1),a[21]||(a[21]=t("div",{class:"field-hint"},"ID do repositório na plataforma",-1))])]),_:1}),s(h,{cols:"12",md:"6"},{default:o(()=>[t("div",Pt,[t("div",Nt,[s(c,{icon:"mdi-source-branch",class:"field-icon"}),a[22]||(a[22]=n(" Branch Padrão ",-1))]),t("div",Ut,d(i.defaultBranch||"main"),1)])]),_:1})]),_:1})])):p("",!0),y.value||_(f)?(m(),w("div",It,[t("div",Lt,[s(c,{icon:"mdi-link-variant",class:"section-icon"}),a[23]||(a[23]=t("h3",{class:"section-title"},"URLs de Acesso",-1))]),s(K,{class:"form-fields"},{default:o(()=>[s(h,{cols:"12"},{default:o(()=>[t("div",Ot,[t("div",jt,[s(c,{icon:"mdi-content-copy",class:"field-icon"}),a[24]||(a[24]=n(" URL de Clone ",-1))]),t("div",Ft,d(i.cloneUrl||"Não informado"),1)])]),_:1}),s(h,{cols:"12"},{default:o(()=>[t("div",Tt,[t("div",Bt,[s(c,{icon:"mdi-web",class:"field-icon"}),a[25]||(a[25]=n(" URL Web ",-1))]),t("div",Et,d(i.webUrl||"Não informado"),1)])]),_:1})]),_:1})])):p("",!0),y.value||_(f)?(m(),w("div",qt,[t("div",Gt,[s(c,{icon:"mdi-information",class:"section-icon"}),a[26]||(a[26]=t("h3",{class:"section-title"},"Informações Adicionais",-1))]),s(K,{class:"form-fields"},{default:o(()=>[s(h,{cols:"12"},{default:o(()=>[t("div",Mt,[t("div",Qt,[s(c,{icon:"mdi-text",class:"field-icon"}),a[27]||(a[27]=n(" Descrição ",-1))]),t("div",Ht,d(i.description||"Nenhuma descrição disponível"),1),a[28]||(a[28]=t("div",{class:"field-hint"},"Descrição opcional do repositório",-1))])]),_:1}),s(h,{cols:"12"},{default:o(()=>[t("div",Wt,[t("div",Yt,[t("div",Zt,[s(c,{icon:i.isPrivate?"mdi-lock":"mdi-lock-open",color:i.isPrivate?"error":"success",class:"me-3",size:"24"},null,8,["icon","color"]),t("div",null,[t("div",Jt,d(i.isPrivate?"Repositório Privado":"Repositório Público"),1),t("div",Kt,d(i.isPrivate?"Apenas membros da organização terão acesso":"Repositório será visível publicamente"),1)])])])])]),_:1})]),_:1})])):p("",!0)]),_:1},8,["modelValue"]),s(Ie,null,{default:o(()=>[b.value?(m(),g(F,{key:0,type:"error",variant:"tonal",class:"error-alert mt-4",closable:"","onClick:close":a[2]||(a[2]=l=>b.value="")},{prepend:o(()=>[s(c,{icon:"mdi-alert-circle"})]),default:o(()=>[t("div",Xt,[a[29]||(a[29]=t("div",{class:"error-title"},"Erro ao processar",-1)),t("div",ea,d(b.value),1)])]),_:1})):p("",!0)]),_:1})]))}}),aa=$e(ta,[["__scopeId","data-v-7a5692e7"]]),sa={class:"repositories-page pa-6"},oa={class:"d-flex align-center justify-space-between mb-6"},la={class:"d-flex align-center gap-3"},ia={class:"px-4 py-3 d-flex align-center justify-space-between border-b"},ra={class:"d-flex align-center gap-3"},na={class:"d-flex align-center"},da={class:"px-4 py-4 advanced-filters-section"},ca={class:"d-flex align-center gap-2"},ua={class:"d-flex align-center justify-end gap-2"},ma={class:"d-flex align-center justify-space-between mb-4"},va={class:"text-body-2 text-medium-emphasis"},pa={key:1,class:"text-center py-12"},fa={key:2,class:"repositories-grid"},ga={class:"card-header"},ba={class:"status-badge"},ya={class:"card-content"},_a={class:"repository-title-section"},wa={class:"repository-name"},ha={class:"repository-path"},Sa={class:"metrics-grid"},xa={class:"metric-item analyses-metric"},Ca={class:"metric-icon-wrapper"},ka={class:"metric-content"},Va={class:"metric-value"},za={class:"metric-item issues-metric"},$a={class:"metric-content"},Aa={key:0,class:"metric-item score-metric"},Da={class:"metric-icon-wrapper score-icon"},Ra={class:"metric-content"},Pa={class:"metric-value score-value"},Na={key:0,class:"quality-section"},Ua={class:"quality-header"},Ia={class:"quality-progress-wrapper"},La={class:"activity-section"},Oa={class:"activity-item"},ja={class:"activity-text"},Fa={class:"activity-item"},Ta={class:"activity-text"},Ba={class:"card-actions"},Ea={class:"hover-overlay"},qa={class:"hover-content"},Ga={key:3,class:"text-center py-12"},Ma={key:1,class:"text-body-2 text-medium-emphasis mt-2"},Qa={key:4,class:"d-flex justify-center mt-6"},Ha={class:"dialog-header"},Wa={class:"dialog-header-content"},Ya={class:"dialog-icon-wrapper"},Za={class:"dialog-content"},Ja={class:"dialog-footer"},Ka={class:"dialog-actions"},Xa=he({__name:"RepositoriesView",setup(Ae){const re=Ue(),{isDemoUser:B}=ke(),{organizationId:ne}=Ve(),L=v([]),R=v(!1),P=v(null),b=v(1),S=v(1),N=v(0),D=v(20),C=v(!1),x=v(),k=v(!1),y=v(null),f=v("lastAnalysisAt"),E=v("desc"),u=Se({search:"",platform:"all",status:"all"}),V=T(()=>{let r=0;return u.search&&r++,u.platform!=="all"&&r++,u.status!=="all"&&r++,r}),H=T(()=>{let r=L.value;if(u.platform!=="all"&&(r=r.filter(e=>e.platform===u.platform)),u.status!=="all"&&(r=r.filter(e=>e.syncStatus===u.status)),u?.search?.trim()){const e=u.search.toLowerCase().trim();r=r.filter(a=>a.name.toLowerCase().includes(e)||a.fullName.toLowerCase().includes(e))}return r}),i=[{value:"all",title:"Todas as Plataformas"},{value:"gitlab",title:"GitLab"},{value:"github",title:"GitHub"},{value:"bitbucket",title:"Bitbucket"}],X=[{value:"all",title:"Todos os Status"},{value:"active",title:"Ativo"},{value:"paused",title:"Pausado"},{value:"error",title:"Erro"}],O=r=>{u.platform="all",u.status="all",r==="active"?u.status="active":r==="gitlab"?u.platform="gitlab":r==="github"?u.platform="github":r==="recent"&&(f.value="lastAnalysisAt",E.value="desc"),j()},q=()=>{u.search="",u.platform="all",u.status="all",y.value=null,f.value="lastAnalysisAt",E.value="desc",U()};let W=null;const de=()=>{W&&clearTimeout(W),W=setTimeout(()=>{U()},300)};let G=null;const j=()=>{G&&clearTimeout(G),G=setTimeout(()=>{U()},300)};async function U(){R.value=!0,P.value=null;try{if(B.value){await new Promise(I=>setTimeout(I,800));let e=[{id:"repo-1",name:"mira-api",fullName:"mira-tech/mira-api",platform:"gitlab",webUrl:"https://gitlab.com/mira-tech/mira-api",syncStatus:"active",lastSyncAt:new Date(Date.now()-7200*1e3).toISOString(),lastAnalysisAt:new Date(Date.now()-1800*1e3).toISOString(),analysesCount:45,issuesCount:12,averageScore:8.7,createdAt:new Date(Date.now()-720*60*60*1e3).toISOString()},{id:"repo-2",name:"mira-client",fullName:"mira-tech/mira-client",platform:"gitlab",webUrl:"https://gitlab.com/mira-tech/mira-client",syncStatus:"active",lastSyncAt:new Date(Date.now()-3600*1e3).toISOString(),lastAnalysisAt:new Date(Date.now()-900*1e3).toISOString(),analysesCount:38,issuesCount:5,averageScore:9.2,createdAt:new Date(Date.now()-600*60*60*1e3).toISOString()},{id:"repo-3",name:"legacy-system",fullName:"organization/legacy-system",platform:"github",webUrl:"https://github.com/organization/legacy-system",syncStatus:"paused",lastSyncAt:new Date(Date.now()-10080*60*1e3).toISOString(),lastAnalysisAt:new Date(Date.now()-7200*60*1e3).toISOString(),analysesCount:15,issuesCount:28,averageScore:5.3,createdAt:new Date(Date.now()-4320*60*60*1e3).toISOString()},{id:"repo-4",name:"mobile-app",fullName:"startup/mobile-app",platform:"bitbucket",webUrl:"https://bitbucket.org/startup/mobile-app",syncStatus:"active",lastSyncAt:new Date(Date.now()-14400*1e3).toISOString(),lastAnalysisAt:new Date(Date.now()-7200*1e3).toISOString(),analysesCount:22,issuesCount:8,averageScore:7.8,createdAt:new Date(Date.now()-1080*60*60*1e3).toISOString()},{id:"repo-5",name:"documentation",fullName:"mira-tech/documentation",platform:"gitlab",webUrl:"https://gitlab.com/mira-tech/documentation",syncStatus:"active",lastSyncAt:new Date(Date.now()-720*60*1e3).toISOString(),lastAnalysisAt:new Date(Date.now()-480*60*1e3).toISOString(),analysesCount:8,issuesCount:2,averageScore:9.5,createdAt:new Date(Date.now()-360*60*60*1e3).toISOString()},{id:"repo-6",name:"error-prone-service",fullName:"test-org/error-prone-service",platform:"github",webUrl:"https://github.com/test-org/error-prone-service",syncStatus:"error",lastSyncAt:new Date(Date.now()-2880*60*1e3).toISOString(),lastAnalysisAt:new Date(Date.now()-4320*60*1e3).toISOString(),analysesCount:6,issuesCount:45,averageScore:3.2,createdAt:new Date(Date.now()-2160*60*60*1e3).toISOString()}];if(u.platform!=="all"&&(e=e.filter(I=>I.platform===u.platform)),u.status!=="all"&&(e=e.filter(I=>I.syncStatus===u.status)),u.search?.trim()){const I=u.search.toLowerCase().trim();e=e.filter(ye=>ye.name.toLowerCase().includes(I)||ye.fullName.toLowerCase().includes(I))}const a=(b.value-1)*D.value,l=a+D.value,$=e.slice(a,l);L.value=$,S.value=Math.ceil(e.length/D.value),N.value=e.length}else{const r={platform:u.platform!=="all"?u.platform:void 0,status:u.status!=="all"?u.status:void 0,search:u.search||void 0},e=await Ce.getRepositories(ne.value,b.value,D.value,r);L.value=e.data,S.value=e.totalPages,N.value=e.total}}catch(r){P.value=r instanceof Error?r.message:"Erro ao carregar repositórios",console.error("Error loading repositories:",r)}finally{R.value=!1}}function ee(r){switch(r.toLowerCase()){case"gitlab":return"mdi-gitlab";case"github":return"mdi-github";case"bitbucket":return"mdi-bitbucket";default:return"mdi-source-repository"}}function M(r){switch(r){case"active":return"success";case"paused":return"warning";case"error":return"error";default:return"grey"}}function Y(r){switch(r){case"active":return"Ativo";case"paused":return"Pausado";case"error":return"Erro";default:return r}}function te(r){return r?new Date(r).toLocaleString("pt-BR"):"Nunca"}function ce(r){return r>=8?"excellent":r>=6?"good":"needs-improvement"}function ue(r){return r>=8?"Excelente":r>=6?"Bom":"Precisa Melhorar"}function ae(r){re.push(`/repositories/${r.id}`)}function me(r){b.value=r,U()}function Z(){b.value=1,U()}function se(r){r.webUrl&&window.open(r.webUrl,"_blank")}function oe(){C.value=!1,Z()}return xe(()=>{U()}),(r,e)=>(m(),w("div",sa,[t("div",oa,[e[18]||(e[18]=t("div",null,[t("h1",{class:"text-h4 font-weight-bold text-high-emphasis mb-2"}," Repositórios "),t("p",{class:"text-body-1 text-medium-emphasis"}," Gerencie e monitore todos os repositórios conectados ")],-1)),t("div",la,[s(A,{color:"primary","prepend-icon":"mdi-refresh",onClick:Z,loading:R.value},{default:o(()=>[...e[16]||(e[16]=[n(" Atualizar ",-1)])]),_:1},8,["loading"]),_(B)?p("",!0):(m(),g(A,{key:0,color:"success","prepend-icon":"mdi-plus",variant:"elevated",onClick:e[0]||(e[0]=a=>C.value=!0)},{default:o(()=>[...e[17]||(e[17]=[n(" Adicionar Repositório ",-1)])]),_:1}))])]),s(Q,{class:"mb-6 filter-card"},{default:o(()=>[t("div",ia,[t("div",ra,[s(Te,{modelValue:u.search,"onUpdate:modelValue":e[1]||(e[1]=a=>u.search=a),label:"Buscar repositórios...","prepend-inner-icon":"mdi-magnify",variant:"solo",density:"compact","hide-details":"",clearable:"",style:{"min-width":"280px"},onInput:de},null,8,["modelValue"]),V.value>0?(m(),g(z,{key:0,size:"small",color:"primary",variant:"tonal",class:"ml-2"},{default:o(()=>[n(d(V.value)+" filtro"+d(V.value>1?"s":""),1)]),_:1})):p("",!0)]),t("div",na,[s(Le,{modelValue:y.value,"onUpdate:modelValue":[e[2]||(e[2]=a=>y.value=a),O],variant:"outlined",color:"primary"},{default:o(()=>[s(z,{value:"active",size:"small"},{default:o(()=>[s(c,{start:""},{default:o(()=>[...e[19]||(e[19]=[n("mdi-check-circle",-1)])]),_:1}),e[20]||(e[20]=n(" Ativos ",-1))]),_:1}),s(z,{value:"gitlab",size:"small"},{default:o(()=>[s(c,{start:""},{default:o(()=>[...e[21]||(e[21]=[n("mdi-gitlab",-1)])]),_:1}),e[22]||(e[22]=n(" GitLab ",-1))]),_:1}),s(z,{value:"github",size:"small"},{default:o(()=>[s(c,{start:""},{default:o(()=>[...e[23]||(e[23]=[n("mdi-github",-1)])]),_:1}),e[24]||(e[24]=n(" GitHub ",-1))]),_:1}),s(z,{value:"recent",size:"small"},{default:o(()=>[s(c,{start:""},{default:o(()=>[...e[25]||(e[25]=[n("mdi-clock-outline",-1)])]),_:1}),e[26]||(e[26]=n(" Recentes ",-1))]),_:1})]),_:1},8,["modelValue"]),s(A,{color:k.value?"primary":"default",variant:k.value?"flat":"outlined",size:"small",onClick:e[3]||(e[3]=a=>k.value=!k.value),class:"ml-1"},{default:o(()=>[s(c,null,{default:o(()=>[n("mdi-filter"+d(k.value?"-check":""),1)]),_:1}),e[27]||(e[27]=n(" Filtros ",-1))]),_:1},8,["color","variant"]),V.value>0?(m(),g(A,{key:0,variant:"outlined",size:"small",color:"error",onClick:q,class:"ml-2"},{default:o(()=>[s(c,{start:""},{default:o(()=>[...e[28]||(e[28]=[n("mdi-filter-remove",-1)])]),_:1}),e[29]||(e[29]=n(" Limpar ",-1))]),_:1})):p("",!0)])]),s(ze,null,{default:o(()=>[De(t("div",da,[s(K,null,{default:o(()=>[s(h,{cols:"12",sm:"6",md:"4"},{default:o(()=>[s(J,{modelValue:u.platform,"onUpdate:modelValue":[e[4]||(e[4]=a=>u.platform=a),j],label:"Plataforma",items:i,variant:"outlined",density:"compact","prepend-inner-icon":"mdi-source-repository"},null,8,["modelValue"])]),_:1}),s(h,{cols:"12",sm:"6",md:"4"},{default:o(()=>[s(J,{modelValue:u.status,"onUpdate:modelValue":[e[5]||(e[5]=a=>u.status=a),j],label:"Status de Sincronização",items:X,variant:"outlined",density:"compact","prepend-inner-icon":"mdi-sync"},null,8,["modelValue"])]),_:1}),s(h,{cols:"12",sm:"6",md:"4"},{default:o(()=>[s(J,{modelValue:f.value,"onUpdate:modelValue":[e[6]||(e[6]=a=>f.value=a),j],label:"Ordenar por",items:[{title:"Última Análise",value:"lastAnalysisAt"},{title:"Última Sincronização",value:"lastSyncAt"},{title:"Nome",value:"name"},{title:"Score",value:"averageScore"},{title:"Issues",value:"issuesCount"}],variant:"outlined",density:"compact","prepend-inner-icon":"mdi-sort"},null,8,["modelValue"])]),_:1}),s(h,{cols:"12",md:"8"},{default:o(()=>[t("div",ca,[s(J,{modelValue:E.value,"onUpdate:modelValue":[e[7]||(e[7]=a=>E.value=a),j],label:"Ordem",items:[{title:"Mais recente",value:"desc"},{title:"Mais antigo",value:"asc"}],variant:"outlined",density:"compact"},null,8,["modelValue"])])]),_:1}),s(h,{cols:"12",md:"4"},{default:o(()=>[t("div",ua,[s(A,{color:"primary","prepend-icon":"mdi-refresh",onClick:Z},{default:o(()=>[...e[30]||(e[30]=[n(" Atualizar ",-1)])]),_:1})])]),_:1})]),_:1})],512),[[Re,k.value]])]),_:1})]),_:1}),t("div",ma,[t("div",va," Mostrando "+d(H.value.length)+" de "+d(N.value)+" repositórios ",1)]),P.value?(m(),g(F,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:"","onClick:close":e[8]||(e[8]=a=>P.value=null)},{default:o(()=>[n(d(P.value),1)]),_:1})):p("",!0),R.value?(m(),w("div",pa,[s(Oe,{indeterminate:"",color:"primary",size:"64"}),e[31]||(e[31]=t("p",{class:"text-body-1 text-medium-emphasis mt-4"}," Carregando repositórios... ",-1))])):H.value.length>0?(m(),w("div",fa,[s(K,{class:"repositories-row"},{default:o(()=>[(m(!0),w(Pe,null,Ne(H.value,a=>(m(),g(h,{key:a.id,cols:"12",sm:"6",lg:"4",xl:"3"},{default:o(()=>[s(Q,{class:"modern-repository-card h-100",elevation:"0",onClick:l=>ae(a)},{default:o(()=>[t("div",ga,[t("div",{class:le(["platform-badge",`platform-${a.platform}`])},[s(c,{icon:ee(a.platform),size:"20",class:"platform-icon"},null,8,["icon"])],2),t("div",ba,[s(z,{color:M(a.syncStatus),size:"x-small",variant:"flat",class:"status-chip"},{default:o(()=>[s(c,{icon:a.syncStatus==="active"?"mdi-check-circle":a.syncStatus==="paused"?"mdi-pause-circle":"mdi-alert-circle",size:"12",class:"me-1"},null,8,["icon"]),n(" "+d(Y(a.syncStatus)),1)]),_:2},1032,["color"])])]),t("div",ya,[t("div",_a,[t("h3",wa,d(a.name),1),t("p",ha,d(a.fullName),1)]),t("div",Sa,[t("div",xa,[t("div",Ca,[s(c,{icon:"mdi-chart-line",size:"18"})]),t("div",ka,[t("div",Va,d(a.analysesCount),1),e[32]||(e[32]=t("div",{class:"metric-label"},"Análises",-1))])]),t("div",za,[t("div",{class:le(["metric-icon-wrapper",(a?.issuesCount??0)>0?"warning":"success"])},[s(c,{icon:"mdi-bug",size:"18"})],2),t("div",$a,[t("div",{class:le(["metric-value",(a?.issuesCount??0)>0?"text-warning":"text-success"])},d(a.issuesCount??0),3),e[33]||(e[33]=t("div",{class:"metric-label"},"Issues",-1))])]),a.averageScore?(m(),w("div",Aa,[t("div",Da,[s(c,{icon:"mdi-star",size:"18"})]),t("div",Ra,[t("div",Pa,d(a.averageScore.toFixed(1)),1),e[34]||(e[34]=t("div",{class:"metric-label"},"Score",-1))])])):p("",!0)]),a.averageScore?(m(),w("div",Na,[t("div",Ua,[e[35]||(e[35]=t("span",{class:"quality-label"},"Qualidade do Código",-1)),t("div",{class:le(["quality-badge",ce(a.averageScore)])},d(ue(a.averageScore)),3)]),t("div",Ia,[s(je,{"model-value":a.averageScore*10,color:a.averageScore>=8?"success":a.averageScore>=6?"warning":"error",height:"6",rounded:"",class:"quality-progress"},null,8,["model-value","color"])])])):p("",!0),t("div",La,[t("div",Oa,[s(c,{icon:"mdi-clock-outline",size:"14",class:"activity-icon"}),e[36]||(e[36]=t("span",{class:"activity-label"},"Última análise:",-1)),t("span",ja,d(te(a?.lastAnalysisAt)),1)]),t("div",Fa,[s(c,{icon:"mdi-sync",size:"14",class:"activity-icon"}),e[37]||(e[37]=t("span",{class:"activity-label"},"Última sincronização:",-1)),t("span",Ta,d(te(a?.lastSyncAt)),1)])])]),t("div",Ba,[s(A,{variant:"text",size:"small",class:"action-btn details-btn",onClick:be(l=>ae(a),["stop"])},{default:o(()=>[s(c,{icon:"mdi-eye",size:"16",class:"me-2"}),e[38]||(e[38]=n(" Detalhes ",-1))]),_:1},8,["onClick"]),a.webUrl&&!_(B)?(m(),g(A,{key:0,variant:"text",size:"small",class:"action-btn external-btn",onClick:be(l=>se(a),["stop"])},{default:o(()=>[s(c,{icon:ee(a.platform),size:"16",class:"me-2"},null,8,["icon"]),e[39]||(e[39]=n(" Abrir ",-1))]),_:2},1032,["onClick"])):p("",!0)]),t("div",Ea,[t("div",qa,[s(c,{icon:"mdi-arrow-right",size:"24"})])])]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})])):(m(),w("div",Ga,[s(c,{size:"64",color:"grey-lighten-1",class:"mb-4"},{default:o(()=>[...e[40]||(e[40]=[n(" mdi-source-repository-multiple ",-1)])]),_:1}),e[43]||(e[43]=t("h3",{class:"text-h6 text-medium-emphasis mb-2"}," Nenhum repositório encontrado ",-1)),e[44]||(e[44]=t("p",{class:"text-body-2 text-medium-emphasis mb-4"}," Não há repositórios que correspondam aos filtros selecionados. ",-1)),_(B)?(m(),w("div",Ma,[...e[42]||(e[42]=[t("em",null,"No modo demonstração, não é possível adicionar novos repositórios.",-1)])])):(m(),g(A,{key:0,color:"success","prepend-icon":"mdi-plus",variant:"elevated",onClick:e[9]||(e[9]=a=>C.value=!0)},{default:o(()=>[...e[41]||(e[41]=[n(" Adicionar Primeiro Repositório ",-1)])]),_:1}))])),S.value>1?(m(),w("div",Qa,[s(qe,{modelValue:b.value,"onUpdate:modelValue":[e[10]||(e[10]=a=>b.value=a),me],length:S.value,"total-visible":7},null,8,["modelValue","length"])])):p("",!0),s(Ge,{modelValue:C.value,"onUpdate:modelValue":e[15]||(e[15]=a=>C.value=a),"max-width":"900px",persistent:"",transition:"dialog-bottom-transition",class:"modern-dialog"},{default:o(()=>[s(Q,{elevation:"24",class:"dialog-card"},{default:o(()=>[t("div",Ha,[t("div",Wa,[t("div",Ya,[s(c,{icon:"mdi-plus-circle",size:"28",class:"dialog-icon"})]),e[45]||(e[45]=t("div",{class:"dialog-title-section"},[t("h2",{class:"dialog-title"},"Adicionar Repositório"),t("p",{class:"dialog-subtitle"},"Configure um novo repositório para análise de código")],-1))]),s(A,{icon:"mdi-close",variant:"text",size:"40",class:"dialog-close-btn",onClick:e[11]||(e[11]=a=>C.value=!1)})]),t("div",Za,[s(aa,{ref_key:"repositoryForm",ref:x,onSuccess:oe,onCancel:e[12]||(e[12]=a=>C.value=!1)},null,512)]),t("div",Ja,[t("div",Ka,[s(A,{variant:"outlined",size:"large",class:"action-btn cancel-btn",disabled:x.value?.loading,onClick:e[13]||(e[13]=a=>C.value=!1)},{default:o(()=>[...e[46]||(e[46]=[n(" Cancelar ",-1)])]),_:1},8,["disabled"]),s(A,{color:"success",variant:"elevated",size:"large",class:"action-btn primary-btn",loading:x.value?.loading,disabled:!x.value?.isFormValid,onClick:e[14]||(e[14]=a=>x.value?.handleSubmit())},{default:o(()=>[s(c,{start:""},{default:o(()=>[...e[47]||(e[47]=[n("mdi-plus-circle",-1)])]),_:1}),e[48]||(e[48]=n(" Adicionar Repositório ",-1))]),_:1},8,["loading","disabled"])])])]),_:1})]),_:1},8,["modelValue"])]))}}),zs=$e(Xa,[["__scopeId","data-v-87ede035"]]);export{zs as default};
