import{k as K,a6 as X,f as m,j as Y,E as Z,_ as c,z as i,q as a,$ as p,a0 as v,a1 as l,a8 as n,W as d,F as $,ae as ee,a2 as r,v as te,a9 as U}from"./vendor-vue-BOgiBTV5.js";import{r as oe}from"./repositories-B9xwD_Sb.js";import{u as se,V as ae}from"./VChip-CnfVI7ta.js";import{_ as ie,b as _,c as le,a as k,t as re}from"./index-Fi5SlckD.js";import{b as F,V as N,a as ne,c as de}from"./VGrid-BenhMHcZ.js";import{V as P,a as g}from"./VRow-i_tVuNAF.js";import{V as ue}from"./VTextField-B2IaUgQ6.js";import{V as L}from"./VSelect-0fCGXKgg.js";import{V as me}from"./VAlert-CGm6uEMH.js";import{V as ce}from"./VPagination-BthfBpUL.js";import{V as fe}from"./VSpacer-CoP99NGt.js";import"./auth-Dt5LZyuD.js";import"./vendor-utils-C9OYYH06.js";import"./token-storage.service-BqAv9k07.js";import"./index-DzEvJ-T3.js";import"./vendor-ui-BR0KSDoQ.js";import"./autofocus-BDwW2Sox.js";import"./VList-DIl281p1.js";import"./ssrBoot-Cswv876e.js";import"./VMenu-DelZx27A.js";import"./dialog-transition-BRPqoOP4.js";const pe=K({__name:"RepositoriesView",setup(B,{expose:e}){e();const C=X(),{isDemoUser:t}=se(),V=m([]),h=m(!1),o=m(null),f=m(1),R=m(1),S=m(0),D=m(20),x=m("all"),b=m("all"),w=m(""),T=Y(()=>{let s=V.value;if(x.value!=="all"&&(s=s.filter(u=>u.platform===x.value)),b.value!=="all"&&(s=s.filter(u=>u.syncStatus===b.value)),w.value.trim()){const u=w.value.toLowerCase().trim();s=s.filter(A=>A.name.toLowerCase().includes(u)||A.fullName.toLowerCase().includes(u))}return s}),j=[{value:"all",title:"Todas as Plataformas"},{value:"gitlab",title:"GitLab"},{value:"github",title:"GitHub"},{value:"bitbucket",title:"Bitbucket"}],E=[{value:"all",title:"Todos os Status"},{value:"active",title:"Ativo"},{value:"paused",title:"Pausado"},{value:"error",title:"Erro"}];async function y(){h.value=!0,o.value=null;try{const s={platform:x.value!=="all"?x.value:void 0,status:b.value!=="all"?b.value:void 0,search:w.value||void 0},u=await oe.getRepositories(f.value,D.value,s);V.value=u.data,R.value=u.totalPages,S.value=u.total}catch(s){o.value=s instanceof Error?s.message:"Erro ao carregar repositórios",console.error("Error loading repositories:",s)}finally{h.value=!1}}function I(s){switch(s.toLowerCase()){case"gitlab":return"mdi-gitlab";case"github":return"mdi-github";case"bitbucket":return"mdi-bitbucket";default:return"mdi-source-repository"}}function M(s){switch(s.toLowerCase()){case"gitlab":return"orange";case"github":return"grey-darken-2";case"bitbucket":return"blue";default:return"grey"}}function O(s){switch(s){case"active":return"success";case"paused":return"warning";case"error":return"error";default:return"grey"}}function q(s){switch(s){case"active":return"Ativo";case"paused":return"Pausado";case"error":return"Erro";default:return s}}function G(s){return s?new Date(s).toLocaleString("pt-BR"):"Nunca"}function Q(s){C.push(`/repositories/${s.id}`)}function H(s){f.value=s,y()}function W(){f.value=1,y()}function J(s){s.webUrl&&window.open(s.webUrl,"_blank")}Z(()=>{y()});const z={router:C,isDemoUser:t,repositories:V,loading:h,error:o,currentPage:f,totalPages:R,totalRepositories:S,itemsPerPage:D,platformFilter:x,statusFilter:b,searchQuery:w,filteredRepositories:T,platformOptions:j,statusOptions:E,loadRepositories:y,getPlatformIcon:I,getPlatformColor:M,getStatusColor:O,getStatusText:q,formatDate:G,viewRepositoryDetails:Q,changePage:H,refreshRepositories:W,openRepository:J};return Object.defineProperty(z,"__isScriptSetup",{enumerable:!1,value:!0}),z}}),ve={class:"repositories-page"},ge={class:"d-flex align-center justify-space-between mb-6"},xe={class:"d-flex align-center gap-3"},be={class:"d-flex align-center justify-space-between mb-4"},_e={class:"text-body-2 text-medium-emphasis"},Ve={key:1,class:"text-center py-12"},he={key:2},we={class:"flex-grow-1"},ye={class:"text-h6 font-weight-bold text-truncate"},ke={class:"text-caption text-medium-emphasis text-truncate"},Ce={class:"text-center"},Pe={class:"text-h6 font-weight-bold text-primary"},Re={class:"text-center"},Se={key:0,class:"mb-3"},De={class:"d-flex align-center justify-space-between mb-1"},ze={class:"text-caption font-weight-medium"},Ae={class:"text-caption text-medium-emphasis"},Ue={class:"mb-1"},Fe={key:3,class:"text-center py-12"},Ne={key:1,class:"text-body-2 text-medium-emphasis mt-2"},Le={key:4,class:"d-flex justify-center mt-6"};function Be(B,e,C,t,V,h){return r(),c("div",ve,[i("div",ge,[e[9]||(e[9]=i("div",null,[i("h1",{class:"text-h4 font-weight-bold text-high-emphasis mb-2"}," Repositórios "),i("p",{class:"text-body-1 text-medium-emphasis"}," Gerencie e monitore todos os repositórios conectados ")],-1)),i("div",xe,[a(_,{color:"primary","prepend-icon":"mdi-refresh",onClick:t.refreshRepositories,loading:t.loading},{default:l(()=>[...e[7]||(e[7]=[n(" Atualizar ",-1)])]),_:1},8,["loading"]),t.isDemoUser?v("",!0):(r(),p(_,{key:0,color:"success","prepend-icon":"mdi-plus",variant:"elevated",onClick:e[0]||(e[0]=o=>t.router.push("/repositories/add"))},{default:l(()=>[...e[8]||(e[8]=[n(" Adicionar Repositório ",-1)])]),_:1}))])]),a(N,{class:"mb-6",elevation:"2"},{default:l(()=>[a(F,null,{default:l(()=>[a(P,null,{default:l(()=>[a(g,{cols:"12",md:"4"},{default:l(()=>[a(ue,{modelValue:t.searchQuery,"onUpdate:modelValue":e[1]||(e[1]=o=>t.searchQuery=o),label:"Buscar repositórios","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),a(g,{cols:"12",md:"4"},{default:l(()=>[a(L,{modelValue:t.platformFilter,"onUpdate:modelValue":e[2]||(e[2]=o=>t.platformFilter=o),items:t.platformOptions,label:"Plataforma",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(g,{cols:"12",md:"4"},{default:l(()=>[a(L,{modelValue:t.statusFilter,"onUpdate:modelValue":e[3]||(e[3]=o=>t.statusFilter=o),items:t.statusOptions,label:"Status",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),i("div",be,[i("div",_e," Mostrando "+d(t.filteredRepositories.length)+" de "+d(t.totalRepositories)+" repositórios ",1)]),t.error?(r(),p(me,{key:0,type:"error",variant:"tonal",class:"mb-4",closable:"","onClick:close":e[4]||(e[4]=o=>t.error=null)},{default:l(()=>[n(d(t.error),1)]),_:1})):v("",!0),t.loading?(r(),c("div",Ve,[a(le,{indeterminate:"",color:"primary",size:"64"}),e[10]||(e[10]=i("p",{class:"text-body-1 text-medium-emphasis mt-4"}," Carregando repositórios... ",-1))])):t.filteredRepositories.length>0?(r(),c("div",he,[a(P,null,{default:l(()=>[(r(!0),c($,null,ee(t.filteredRepositories,o=>(r(),p(g,{key:o.id,cols:"12",md:"6",lg:"4"},{default:l(()=>[a(N,{elevation:"2",hover:"",class:"repository-card h-100 d-flex flex-column",onClick:f=>t.viewRepositoryDetails(o)},{default:l(()=>[a(ne,{class:"d-flex align-center"},{default:l(()=>[a(k,{icon:t.getPlatformIcon(o.platform),color:t.getPlatformColor(o.platform),class:"me-2",size:"24"},null,8,["icon","color"]),i("div",we,[i("div",ye,d(o.name),1),i("div",ke,d(o.fullName),1)]),a(ae,{color:t.getStatusColor(o.syncStatus),size:"small",variant:"tonal"},{default:l(()=>[n(d(t.getStatusText(o.syncStatus)),1)]),_:2},1032,["color"])]),_:2},1024),a(F,{class:"flex-grow-1"},{default:l(()=>[a(P,{class:"mb-3"},{default:l(()=>[a(g,{cols:"6"},{default:l(()=>[i("div",Ce,[i("div",Pe,d(o.analysesCount),1),e[11]||(e[11]=i("div",{class:"text-caption text-medium-emphasis"},"Análises",-1))])]),_:2},1024),a(g,{cols:"6"},{default:l(()=>[i("div",Re,[i("div",{class:te(["text-h6 font-weight-bold",o.issuesCount>0?"text-warning":"text-success"])},d(o.issuesCount),3),e[12]||(e[12]=i("div",{class:"text-caption text-medium-emphasis"},"Issues",-1))])]),_:2},1024)]),_:2},1024),o.averageScore?(r(),c("div",Se,[i("div",De,[e[13]||(e[13]=i("span",{class:"text-caption text-medium-emphasis"},"Score Médio",-1)),i("span",ze,d(o.averageScore.toFixed(1)),1)]),a(re,{"model-value":o.averageScore*10,color:o.averageScore>=8?"success":o.averageScore>=6?"warning":"error",height:"4",rounded:""},null,8,["model-value","color"])])):v("",!0),i("div",Ae,[i("div",Ue,[a(k,{size:"12",class:"me-1"},{default:l(()=>[...e[14]||(e[14]=[n("mdi-clock-outline",-1)])]),_:1}),n(" Última análise: "+d(t.formatDate(o.lastAnalysisAt)),1)]),i("div",null,[a(k,{size:"12",class:"me-1"},{default:l(()=>[...e[15]||(e[15]=[n("mdi-sync",-1)])]),_:1}),n(" Última sincronização: "+d(t.formatDate(o.lastSyncAt)),1)])])]),_:2},1024),t.isDemoUser?v("",!0):(r(),p(de,{key:0},{default:l(()=>[a(_,{variant:"text",size:"small","prepend-icon":"mdi-eye",onClick:U(f=>t.viewRepositoryDetails(o),["stop"])},{default:l(()=>[...e[16]||(e[16]=[n(" Ver Detalhes ",-1)])]),_:1},8,["onClick"]),a(fe),o.webUrl?(r(),p(_,{key:0,variant:"text",size:"small",icon:t.getPlatformIcon(o.platform),onClick:U(f=>t.openRepository(o),["stop"])},null,8,["icon","onClick"])):v("",!0)]),_:2},1024))]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1})])):(r(),c("div",Fe,[a(k,{size:"64",color:"grey-lighten-1",class:"mb-4"},{default:l(()=>[...e[17]||(e[17]=[n(" mdi-source-repository-multiple ",-1)])]),_:1}),e[20]||(e[20]=i("h3",{class:"text-h6 text-medium-emphasis mb-2"}," Nenhum repositório encontrado ",-1)),e[21]||(e[21]=i("p",{class:"text-body-2 text-medium-emphasis mb-4"}," Não há repositórios que correspondam aos filtros selecionados. ",-1)),t.isDemoUser?(r(),c("div",Ne,[...e[19]||(e[19]=[i("em",null,"No modo demonstração, não é possível adicionar novos repositórios.",-1)])])):(r(),p(_,{key:0,color:"success","prepend-icon":"mdi-plus",variant:"elevated",onClick:e[5]||(e[5]=o=>t.router.push("/repositories/add"))},{default:l(()=>[...e[18]||(e[18]=[n(" Adicionar Primeiro Repositório ",-1)])]),_:1}))])),t.totalPages>1?(r(),c("div",Le,[a(ce,{modelValue:t.currentPage,"onUpdate:modelValue":[e[6]||(e[6]=o=>t.currentPage=o),t.changePage],length:t.totalPages,"total-visible":7},null,8,["modelValue","length"])])):v("",!0)])}const at=ie(pe,[["render",Be],["__scopeId","data-v-5e274369"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/repositories/RepositoriesView.vue"]]);export{at as default};
