import{k as A,W as P,f as u,r as N,E as F,X as M,q as r,T as l,S as j,z as q,a4 as i,Z as G,x as H,a1 as v,aa as K,ab as W}from"./vendor-vue-BvKyvIVR.js";import{r as X}from"./repositories-DZyFHAle.js";import{o as Z}from"./organizations-BmzcVGpc.js";import{_ as J}from"./index-CQBjCOQw.js";import{V as Q}from"./VContainer-3okOeSxQ.js";import{V as E}from"./VDialog-C6XAQXKq.js";import{V as B,a as d}from"./VRow-C_rLTo1r.js";import{j as U,l as y,f as p,k as z,p as C}from"./VGrid-CuJrScxf.js";import{V}from"./VIcon-CM-KW5Qw.js";import{V as Y}from"./VForm-BjI_k9Xt.js";import{a as T,V as f}from"./VSelect-JVxEisdn.js";import{b as L}from"./VList-CaAoEaF2.js";import{V as h}from"./VTextarea-DdR9LUYO.js";import{V as $}from"./VSwitch-K3EdCM7X.js";import{V as R}from"./VSpacer-kp13s616.js";import"./auth-PiWOMLtm.js";import"./vendor-utils-Cfk84l6i.js";import"./token-storage.service-BqAv9k07.js";import"./VChip-BzUv3cXC.js";import"./vendor-ui-Dz8XL-co.js";import"./tag-Bnbpnddf.js";import"./dimensions-DVh0fwa7.js";import"./VMenu-B2XC7rkF.js";import"./lazy-DADzjSlN.js";import"./forwardRefs-D_qxKlPu.js";import"./autofocus-Bh6bNAdk.js";import"./ssrBoot-COakMcr6.js";var _=(s=>(s.GITLAB="gitlab",s.GITHUB="github",s.BITBUCKET="bitbucket",s))(_||{});const ee=A({__name:"AddRepositoryView",setup(s,{expose:e}){e();const D=P(),o=u(),S=u(!1),c=u(!1),a=u(!1),m=u(!1),w=u(""),g=N({name:"",fullName:"",platform:_.GITLAB,externalId:"",cloneUrl:"",webUrl:"",description:"",defaultBranch:"main",isPrivate:!0,organizationId:""}),O=[{title:"GitLab",value:"gitlab",icon:"mdi-gitlab",color:"#FC6D26"},{title:"GitHub",value:"github",icon:"mdi-github",color:"#24292e"},{title:"Bitbucket",value:"bitbucket",icon:"mdi-bitbucket",color:"#0052CC"}],b=u([]),x=u(!1),I=async()=>{x.value=!0;try{const t=await Z.getOrganizations();b.value=t.filter(n=>n.isActive).map(n=>({title:n.name,value:n.id,subtitle:n.description||`${n.tier} - ${n.status}`})),b.value.length>0&&!g.organizationId&&(g.organizationId=b.value[0]?.value||"")}catch(t){console.error("Erro ao carregar organizações:",t),w.value="Erro ao carregar organizações",m.value=!0}finally{x.value=!1}};F(()=>{I()});const k={router:D,form:o,isFormValid:S,loading:c,showSuccessDialog:a,showErrorDialog:m,errorMessage:w,formData:g,platformOptions:O,organizationOptions:b,loadingOrganizations:x,loadOrganizations:I,rules:{required:t=>!!t||"Campo obrigatório",maxLength:t=>n=>!n||n.length<=t||`Máximo ${t} caracteres`,url:t=>{if(!t)return!0;try{return new URL(t),!0}catch{return"URL inválida"}}},handleSubmit:async()=>{if(!o.value)return;const{valid:t}=await o.value.validate();if(t){c.value=!0;try{await X.createRepository(g),a.value=!0}catch(n){w.value=n instanceof Error?n.message:"Erro ao criar repositório",m.value=!0}finally{c.value=!1}}},goToRepositories:()=>{a.value=!1,D.push("/repositories")}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),oe={class:"add-repository-page"},re={class:"d-flex align-center"};function le(s,e,D,o,S,c){return j(),M("div",oe,[r(Q,null,{default:l(()=>[r(B,{justify:"center"},{default:l(()=>[r(d,{cols:"12",md:"8",lg:"6"},{default:l(()=>[r(U,null,{default:l(()=>[r(y,{class:"d-flex align-center"},{default:l(()=>[r(p,{icon:"",onClick:e[0]||(e[0]=a=>s.$router.back()),class:"me-3"},{default:l(()=>[r(V,null,{default:l(()=>[...e[16]||(e[16]=[i("mdi-arrow-left",-1)])]),_:1})]),_:1}),e[17]||(e[17]=q("span",null,"Adicionar Repositório",-1))]),_:1}),r(z,null,{default:l(()=>[r(Y,{ref:"form",modelValue:o.isFormValid,"onUpdate:modelValue":e[11]||(e[11]=a=>o.isFormValid=a),onSubmit:G(o.handleSubmit,["prevent"]),class:"mt-5"},{default:l(()=>[r(B,null,{default:l(()=>[r(d,{cols:"12"},{default:l(()=>[r(T,{modelValue:o.formData.organizationId,"onUpdate:modelValue":e[1]||(e[1]=a=>o.formData.organizationId=a),items:o.organizationOptions,label:"Organização",required:"",rules:[o.rules.required],"prepend-inner-icon":"mdi-domain",loading:o.loadingOrganizations,disabled:o.loadingOrganizations},{item:l(({item:a,props:m})=>[r(L,H(m,{subtitle:a.raw.subtitle}),null,16,["subtitle"])]),_:1},8,["modelValue","items","rules","loading","disabled"])]),_:1}),r(d,{cols:"12"},{default:l(()=>[r(T,{modelValue:o.formData.platform,"onUpdate:modelValue":e[2]||(e[2]=a=>o.formData.platform=a),items:o.platformOptions,label:"Plataforma Git",required:"",rules:[o.rules.required],"prepend-inner-icon":"mdi-git"},{item:l(({item:a,props:m})=>[r(L,K(W(m)),{prepend:l(()=>[r(V,{color:a.raw.color},{default:l(()=>[i(v(a.raw.icon),1)]),_:2},1032,["color"])]),_:2},1040)]),selection:l(({item:a})=>[q("div",re,[r(V,{color:a.raw.color,class:"me-2"},{default:l(()=>[i(v(a.raw.icon),1)]),_:2},1032,["color"]),i(" "+v(a.raw.title),1)])]),_:1},8,["modelValue","rules"])]),_:1}),r(d,{cols:"12",sm:"6"},{default:l(()=>[r(f,{modelValue:o.formData.name,"onUpdate:modelValue":e[3]||(e[3]=a=>o.formData.name=a),label:"Nome do Repositório",required:"",rules:[o.rules.required,o.rules.maxLength(255)],"prepend-inner-icon":"mdi-folder-outline",counter:"255"},null,8,["modelValue","rules"])]),_:1}),r(d,{cols:"12",sm:"6"},{default:l(()=>[r(f,{modelValue:o.formData.fullName,"onUpdate:modelValue":e[4]||(e[4]=a=>o.formData.fullName=a),label:"Nome Completo",required:"",rules:[o.rules.required,o.rules.maxLength(500)],"prepend-inner-icon":"mdi-folder-multiple-outline",counter:"500",hint:"Ex: organization/team/repository"},null,8,["modelValue","rules"])]),_:1}),r(d,{cols:"12",sm:"6"},{default:l(()=>[r(f,{modelValue:o.formData.externalId,"onUpdate:modelValue":e[5]||(e[5]=a=>o.formData.externalId=a),label:"ID Externo",required:"",rules:[o.rules.required,o.rules.maxLength(100)],"prepend-inner-icon":"mdi-identifier",counter:"100",hint:"ID do repositório na plataforma"},null,8,["modelValue","rules"])]),_:1}),r(d,{cols:"12",sm:"6"},{default:l(()=>[r(f,{modelValue:o.formData.defaultBranch,"onUpdate:modelValue":e[6]||(e[6]=a=>o.formData.defaultBranch=a),label:"Branch Padrão",rules:[o.rules.maxLength(100)],"prepend-inner-icon":"mdi-source-branch",counter:"100"},null,8,["modelValue","rules"])]),_:1}),r(d,{cols:"12"},{default:l(()=>[r(f,{modelValue:o.formData.cloneUrl,"onUpdate:modelValue":e[7]||(e[7]=a=>o.formData.cloneUrl=a),label:"URL de Clone",required:"",rules:[o.rules.required,o.rules.url],"prepend-inner-icon":"mdi-content-copy",hint:"Ex: https://gitlab.com/organization/repository.git"},null,8,["modelValue","rules"])]),_:1}),r(d,{cols:"12"},{default:l(()=>[r(f,{modelValue:o.formData.webUrl,"onUpdate:modelValue":e[8]||(e[8]=a=>o.formData.webUrl=a),label:"URL Web",required:"",rules:[o.rules.required,o.rules.url],"prepend-inner-icon":"mdi-web",hint:"Ex: https://gitlab.com/organization/repository"},null,8,["modelValue","rules"])]),_:1}),r(d,{cols:"12"},{default:l(()=>[r(h,{modelValue:o.formData.description,"onUpdate:modelValue":e[9]||(e[9]=a=>o.formData.description=a),label:"Descrição",rows:"3","prepend-inner-icon":"mdi-text",hint:"Descrição opcional do repositório"},null,8,["modelValue"])]),_:1}),r(d,{cols:"12"},{default:l(()=>[r($,{modelValue:o.formData.isPrivate,"onUpdate:modelValue":e[10]||(e[10]=a=>o.formData.isPrivate=a),label:"Repositório Privado",inset:"",color:"primary"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),r(C,{class:"pa-4"},{default:l(()=>[r(R),r(p,{variant:"outlined",onClick:e[12]||(e[12]=a=>s.$router.back()),disabled:o.loading},{default:l(()=>[...e[18]||(e[18]=[i(" Cancelar ",-1)])]),_:1},8,["disabled"]),r(p,{color:"primary",onClick:o.handleSubmit,loading:o.loading,disabled:!o.isFormValid},{default:l(()=>[...e[19]||(e[19]=[i(" Adicionar Repositório ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),r(E,{modelValue:o.showSuccessDialog,"onUpdate:modelValue":e[13]||(e[13]=a=>o.showSuccessDialog=a),"max-width":"400"},{default:l(()=>[r(U,null,{default:l(()=>[r(y,{class:"d-flex align-center text-success"},{default:l(()=>[r(V,{class:"me-2"},{default:l(()=>[...e[20]||(e[20]=[i("mdi-check-circle",-1)])]),_:1}),e[21]||(e[21]=i(" Sucesso! ",-1))]),_:1}),r(z,null,{default:l(()=>[...e[22]||(e[22]=[i(" Repositório criado com sucesso! ",-1)])]),_:1}),r(C,null,{default:l(()=>[r(R),r(p,{color:"primary",onClick:o.goToRepositories},{default:l(()=>[...e[23]||(e[23]=[i(" Ver Repositórios ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(E,{modelValue:o.showErrorDialog,"onUpdate:modelValue":e[15]||(e[15]=a=>o.showErrorDialog=a),"max-width":"400"},{default:l(()=>[r(U,null,{default:l(()=>[r(y,{class:"d-flex align-center text-error"},{default:l(()=>[r(V,{class:"me-2"},{default:l(()=>[...e[24]||(e[24]=[i("mdi-alert-circle",-1)])]),_:1}),e[25]||(e[25]=i(" Erro ",-1))]),_:1}),r(z,null,{default:l(()=>[i(v(o.errorMessage),1)]),_:1}),r(C,null,{default:l(()=>[r(R),r(p,{color:"primary",onClick:e[14]||(e[14]=a=>o.showErrorDialog=!1)},{default:l(()=>[...e[26]||(e[26]=[i(" OK ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Le=J(ee,[["render",le],["__scopeId","data-v-cc60d6e7"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/repositories/AddRepositoryView.vue"]]);export{Le as default};
