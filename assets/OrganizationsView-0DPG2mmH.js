import{n as _e,j as X,t as R,p as Se,q as a,z as l,F as ce,x as H,k as re,f as _,r as be,w as ae,Q as S,T as i,S as w,a4 as s,a1 as g,Z as ke,_ as E,aa as Oe,ab as Ae,X as Ve,E as Ce}from"./vendor-vue-BvKyvIVR.js";import{o as k}from"./organizations-BmzcVGpc.js";import{u as ye,a as L}from"./VChip-BzUv3cXC.js";import{_ as se}from"./index-CQBjCOQw.js";import{V as ne}from"./VDialog-C6XAQXKq.js";import{j as P,l as de,k as B,p as ue,f as D,i as ze}from"./VGrid-CuJrScxf.js";import{V as c}from"./VIcon-CM-KW5Qw.js";import{V as M,b as Te}from"./VList-CaAoEaF2.js";import{V as Pe}from"./VForm-BjI_k9Xt.js";import{V as Z,a as v}from"./VRow-C_rLTo1r.js";import{V as G,a as oe}from"./VSelect-JVxEisdn.js";import{V as Ee}from"./VTextarea-DdR9LUYO.js";import{V as le}from"./VSwitch-K3EdCM7X.js";import{V as me}from"./VSpacer-kp13s616.js";import{d as he}from"./vendor-utils-Cfk84l6i.js";import{c as Ue,a as Re,b as Be,d as Ie,u as Fe,p as Le,e as je,f as qe,g as Ne,h as Ge,i as He,j as Ze,k as ge,l as fe,m as ve,n as Me,o as We,q as Xe}from"./VDataTable-BIdz-mlh.js";import{g as Qe,p as Je,l as Ke,f as Ye}from"./vendor-ui-Dz8XL-co.js";import{V as pe}from"./VTable-BhCG_aMe.js";import{V as $e}from"./VSkeletonLoader-Dnxv1z-d.js";import{V as ie}from"./VTooltip-Bl0kBka4.js";import{V as et}from"./VAlert-ChhMmNH2.js";import"./auth-PiWOMLtm.js";import"./token-storage.service-BqAv9k07.js";import"./tag-Bnbpnddf.js";import"./VMenu-B2XC7rkF.js";import"./dimensions-DVh0fwa7.js";import"./lazy-DADzjSlN.js";import"./forwardRefs-D_qxKlPu.js";import"./ssrBoot-COakMcr6.js";import"./autofocus-Bh6bNAdk.js";import"./VPagination-C7VPvwfo.js";import"./filter-3ET2mAtK.js";const tt=Je({itemsLength:{type:[Number,String],required:!0},...Xe(),...We(),...Me()},"VDataTableServer"),at=Qe()({name:"VDataTableServer",props:tt(),emits:{"update:modelValue":n=>!0,"update:page":n=>!0,"update:itemsPerPage":n=>!0,"update:sortBy":n=>!0,"update:options":n=>!0,"update:expanded":n=>!0,"update:groupBy":n=>!0},setup(n,e){let{attrs:u,slots:t}=e;const{groupBy:p}=Ue(n),{sortBy:V,multiSort:o,mustSort:f}=Re(n),{page:b,itemsPerPage:d}=Be(n),{disableSort:y}=_e(n),x=X(()=>parseInt(n.itemsLength,10)),{columns:A,headers:j}=Ie(n,{groupBy:p,showSelect:R(()=>n.showSelect),showExpand:R(()=>n.showExpand)}),{items:C}=Fe(n,A),{toggleSort:h}=Le({sortBy:V,multiSort:o,mustSort:f,page:b}),{opened:O,isGroupOpen:U,toggleGroup:I,extractRows:q}=je({groupBy:p,sortBy:V,disableSort:y}),{pageCount:N,setItemsPerPage:F}=qe({page:b,itemsPerPage:d,itemsLength:x}),{flatItems:r}=Ne(C,p,O,()=>!!t["group-summary"]),{isSelected:Q,select:J,selectAll:K,toggleSelect:Y,someSelected:$,allSelected:ee}=Ge(n,{allItems:C,currentPage:C}),{isExpanded:W,toggleExpand:m}=He(n),T=X(()=>q(C.value));Ze({page:b,itemsPerPage:d,sortBy:V,groupBy:p,search:R(()=>n.search)}),Se("v-data-table",{toggleSort:h,sortBy:V}),Ke({VDataTableRows:{hideNoData:R(()=>n.hideNoData),noDataText:R(()=>n.noDataText),loading:R(()=>n.loading),loadingText:R(()=>n.loadingText)}});const z=X(()=>({page:b.value,itemsPerPage:d.value,sortBy:V.value,pageCount:N.value,toggleSort:h,setItemsPerPage:F,someSelected:$.value,allSelected:ee.value,isSelected:Q,select:J,selectAll:K,toggleSelect:Y,isExpanded:W,toggleExpand:m,isGroupOpen:U,toggleGroup:I,items:T.value.map(te=>te.raw),internalItems:T.value,groupedItems:r.value,columns:A.value,headers:j.value}));Ye(()=>{const te=ge.filterProps(n),xe=fe.filterProps(n),we=ve.filterProps(n),De=pe.filterProps(n);return a(pe,H({class:["v-data-table",{"v-data-table--loading":n.loading},n.class],style:n.style},De,{fixedHeader:n.fixedHeader||n.sticky}),{top:()=>t.top?.(z.value),default:()=>t.default?t.default(z.value):l(ce,null,[t.colgroup?.(z.value),!n.hideDefaultHeader&&l("thead",{key:"thead",class:"v-data-table__thead",role:"rowgroup"},[a(fe,xe,t)]),t.thead?.(z.value),!n.hideDefaultBody&&l("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[t["body.prepend"]?.(z.value),t.body?t.body(z.value):a(ve,H(u,we,{items:r.value}),t),t["body.append"]?.(z.value)]),t.tbody?.(z.value),t.tfoot?.(z.value)]),bottom:()=>t.bottom?t.bottom(z.value):!n.hideDefaultFooter&&l(ce,null,[a(M,null,null),a(ge,te,{prepend:t["footer.prepend"]})])})})}}),it=re({__name:"OrganizationFormDialog",props:{modelValue:{type:Boolean,required:!0},organization:{type:[Object,null],required:!1,default:null}},emits:["update:modelValue","saved"],setup(n,{expose:e,emit:u}){e();const t=n,p=u,V=_(),o=_(!1),f=_(!1),b=X(()=>!!t.organization),d=be({name:"",slug:"",email:"",website:"",tier:"free",description:"",isActive:!0}),y=k.getAvailableTiers(),x=[r=>!!r||"Nome é obrigatório",r=>r&&r.length>=2||"Nome deve ter pelo menos 2 caracteres",r=>r&&r.length<=100||"Nome deve ter no máximo 100 caracteres"],A=[r=>!!r||"Slug é obrigatório",r=>r&&r.length>=2||"Slug deve ter pelo menos 2 caracteres",r=>r&&r.length<=50||"Slug deve ter no máximo 50 caracteres",r=>/^[a-z0-9-]+$/.test(r)||"Slug deve conter apenas letras minúsculas, números e hífens"],j=[r=>!!r||"Email é obrigatório",r=>/.+@.+\..+/.test(r)||"Email deve ser válido"],C=[r=>!r||/^https?:\/\/.+/.test(r)||"Website deve ser uma URL válida (http:// ou https://)"],h=[r=>!!r||"Plano é obrigatório"],O=[r=>!r||r.length<=500||"Descrição deve ter no máximo 500 caracteres"];function U(){d.name="",d.slug="",d.email="",d.website="",d.tier="free",d.description="",d.isActive=!0,V.value?.resetValidation()}function I(r){d.name=r.name,d.slug=r.slug,d.email=r.email,d.website=r.website||"",d.tier=r.tier,d.description=r.description||"",d.isActive=r.isActive}async function q(){if(o.value){f.value=!0;try{if(b.value&&t.organization){const r={name:d.name,email:d.email,website:d.website||void 0,tier:d.tier,description:d.description||void 0,isActive:d.isActive};await k.updateOrganization(t.organization.id,r)}else{const r={name:d.name,slug:d.slug,email:d.email,website:d.website||void 0,tier:d.tier,description:d.description||void 0};await k.createOrganization(r)}p("saved")}catch(r){console.error("Erro ao salvar organização:",r)}finally{f.value=!1}}}function N(){p("update:modelValue",!1)}ae(()=>d.name,r=>{!b.value&&r&&(d.slug=r.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim())}),ae(()=>t.organization,r=>{r?I(r):U()},{immediate:!0}),ae(()=>t.modelValue,r=>{!r&&!t.organization&&setTimeout(U,300)});const F={props:t,emit:p,formRef:V,valid:o,loading:f,isEditing:b,formData:d,tierOptions:y,nameRules:x,slugRules:A,emailRules:j,websiteRules:C,tierRules:h,descriptionRules:O,resetForm:U,populateForm:I,handleSubmit:q,handleCancel:N};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}});function ot(n,e,u,t,p,V){return w(),S(ne,{"model-value":u.modelValue,"onUpdate:modelValue":e[8]||(e[8]=o=>n.$emit("update:modelValue",o)),"max-width":"600",persistent:""},{default:i(()=>[a(P,null,{default:i(()=>[a(de,{class:"text-h5 d-flex align-center"},{default:i(()=>[a(c,{class:"mr-2"},{default:i(()=>[...e[9]||(e[9]=[s("mdi-domain",-1)])]),_:1}),s(" "+g(t.isEditing?"Editar Organização":"Nova Organização"),1)]),_:1}),a(M),a(B,{class:"pa-6"},{default:i(()=>[a(Pe,{ref:"formRef",modelValue:t.valid,"onUpdate:modelValue":e[7]||(e[7]=o=>t.valid=o),onSubmit:ke(t.handleSubmit,["prevent"])},{default:i(()=>[a(Z,null,{default:i(()=>[a(v,{cols:"12"},{default:i(()=>[a(G,{modelValue:t.formData.name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.formData.name=o),label:"Nome da Organização *",rules:t.nameRules,variant:"outlined","prepend-inner-icon":"mdi-domain",required:""},null,8,["modelValue"])]),_:1}),t.isEditing?E("",!0):(w(),S(v,{key:0,cols:"12"},{default:i(()=>[a(G,{modelValue:t.formData.slug,"onUpdate:modelValue":e[1]||(e[1]=o=>t.formData.slug=o),label:"Slug *",rules:t.slugRules,variant:"outlined","prepend-inner-icon":"mdi-link",hint:"Identificador único usado nas URLs (ex: minha-empresa)","persistent-hint":"",required:""},null,8,["modelValue"])]),_:1})),a(v,{cols:"12"},{default:i(()=>[a(G,{modelValue:t.formData.email,"onUpdate:modelValue":e[2]||(e[2]=o=>t.formData.email=o),label:"Email de Contato *",rules:t.emailRules,variant:"outlined","prepend-inner-icon":"mdi-email",type:"email",required:""},null,8,["modelValue"])]),_:1}),a(v,{cols:"12"},{default:i(()=>[a(G,{modelValue:t.formData.website,"onUpdate:modelValue":e[3]||(e[3]=o=>t.formData.website=o),label:"Website",rules:t.websiteRules,variant:"outlined","prepend-inner-icon":"mdi-web",type:"url",placeholder:"https://exemplo.com"},null,8,["modelValue"])]),_:1}),a(v,{cols:"12"},{default:i(()=>[a(oe,{modelValue:t.formData.tier,"onUpdate:modelValue":e[4]||(e[4]=o=>t.formData.tier=o),items:t.tierOptions,label:"Plano *",rules:t.tierRules,variant:"outlined","prepend-inner-icon":"mdi-crown",required:""},{item:i(({props:o,item:f})=>[a(Te,Oe(Ae(o)),{prepend:i(()=>[a(c,{color:f.raw.color,class:"mr-2"},{default:i(()=>[...e[10]||(e[10]=[s(" mdi-crown ",-1)])]),_:1},8,["color"])]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),a(v,{cols:"12"},{default:i(()=>[a(Ee,{modelValue:t.formData.description,"onUpdate:modelValue":e[5]||(e[5]=o=>t.formData.description=o),label:"Descrição",variant:"outlined","prepend-inner-icon":"mdi-text",rows:"3",counter:"500",rules:t.descriptionRules},null,8,["modelValue"])]),_:1}),t.isEditing?(w(),S(v,{key:1,cols:"12"},{default:i(()=>[a(le,{modelValue:t.formData.isActive,"onUpdate:modelValue":e[6]||(e[6]=o=>t.formData.isActive=o),label:"Organização ativa",color:"success","hide-details":""},null,8,["modelValue"])]),_:1})):E("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(M),a(ue,{class:"pa-6"},{default:i(()=>[a(me),a(D,{variant:"text",onClick:t.handleCancel,disabled:t.loading},{default:i(()=>[...e[11]||(e[11]=[s(" Cancelar ",-1)])]),_:1},8,["disabled"]),a(D,{color:"primary",variant:"flat",loading:t.loading,disabled:!t.valid,onClick:t.handleSubmit},{default:i(()=>[s(g(t.isEditing?"Salvar Alterações":"Criar Organização"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["model-value"])}const lt=se(it,[["render",ot],["__scopeId","data-v-5c943b78"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/organizations/OrganizationFormDialog.vue"]]),rt=re({__name:"OrganizationDetailsDialog",props:{modelValue:{type:Boolean,required:!0},organization:{type:[Object,null],required:!1,default:null}},emits:["update:modelValue","edit"],setup(n,{expose:e}){e();const{isDemoUser:u}=ye(),t=k.getAvailableTiers(),p=k.getAvailableStatuses();function V(d){return t.find(x=>x.value===d)?.title||d}function o(d){return p.find(x=>x.value===d)?.title||d}function f(d){switch(d){case"active":return"mdi-check-circle";case"inactive":return"mdi-pause-circle";case"suspended":return"mdi-alert-circle";default:return"mdi-help-circle"}}const b={isDemoUser:u,tierOptions:t,statusOptions:p,getTierLabel:V,getStatusLabel:o,getStatusIcon:f,get organizationsService(){return k}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),st={class:"pa-6 bg-surface-variant"},nt={class:"d-flex align-center"},dt={class:"flex-grow-1"},ut={class:"text-h4 font-weight-bold mb-2"},mt={class:"d-flex align-center gap-2 mb-2"},ct={class:"text-body-2 text-grey-darken-1 mb-0"},gt={class:"pa-6"},ft={class:"mb-6"},vt={class:"text-h6 font-weight-bold mb-4 d-flex align-center"},pt={class:"detail-item"},bt={class:"font-weight-medium"},Vt={class:"detail-item"},yt={class:"font-weight-medium"},zt={class:"detail-item"},xt={class:"font-weight-medium"},wt=["href"],Dt={class:"detail-item"},_t={class:"font-weight-medium"},St=["href"],kt={class:"mb-6"},Ot={class:"text-h6 font-weight-bold mb-4 d-flex align-center"},At={class:"detail-item"},Ct={class:"font-weight-medium"},Tt={class:"detail-item"},Pt={class:"font-weight-medium"},Et={class:"mb-6"},ht={class:"text-h6 font-weight-bold mb-4 d-flex align-center"},Ut={key:0},Rt={class:"text-h6 font-weight-bold mb-4 d-flex align-center"},Bt={class:"d-flex gap-2 flex-wrap"};function It(n,e,u,t,p,V){return w(),S(ne,{"model-value":u.modelValue,"onUpdate:modelValue":e[2]||(e[2]=o=>n.$emit("update:modelValue",o)),"max-width":"700"},{default:i(()=>[a(P,null,{default:i(()=>[a(de,{class:"text-h5 d-flex align-center"},{default:i(()=>[a(c,{class:"mr-2"},{default:i(()=>[...e[3]||(e[3]=[s("mdi-information",-1)])]),_:1}),e[4]||(e[4]=s(" Detalhes da Organização ",-1))]),_:1}),a(M),u.organization?(w(),S(B,{key:0,class:"pa-0"},{default:i(()=>[l("div",st,[l("div",nt,[a(ze,{size:"80",color:"primary",class:"mr-4"},{default:i(()=>[a(c,{size:"40"},{default:i(()=>[...e[5]||(e[5]=[s("mdi-domain",-1)])]),_:1})]),_:1}),l("div",dt,[l("h2",ut,g(u.organization.name),1),l("div",mt,[a(L,{color:t.organizationsService.getTierColor(u.organization.tier),size:"small",variant:"tonal"},{default:i(()=>[a(c,{start:"",size:"12"},{default:i(()=>[...e[6]||(e[6]=[s("mdi-crown",-1)])]),_:1}),s(" "+g(t.getTierLabel(u.organization.tier)),1)]),_:1},8,["color"]),a(L,{color:t.organizationsService.getStatusColor(u.organization.status),size:"small",variant:"tonal"},{default:i(()=>[a(c,{start:"",size:"12"},{default:i(()=>[s(g(t.getStatusIcon(u.organization.status)),1)]),_:1}),s(" "+g(t.getStatusLabel(u.organization.status)),1)]),_:1},8,["color"]),a(L,{color:u.organization.isActive?"success":"error",size:"small",variant:"tonal"},{default:i(()=>[a(c,{start:"",size:"12"},{default:i(()=>[s(g(u.organization.isActive?"mdi-check":"mdi-close"),1)]),_:1}),s(" "+g(u.organization.isActive?"Ativa":"Inativa"),1)]),_:1},8,["color"])]),l("p",ct,g(u.organization.description||"Sem descrição"),1)])])]),l("div",gt,[l("div",ft,[l("h3",vt,[a(c,{class:"mr-2"},{default:i(()=>[...e[7]||(e[7]=[s("mdi-card-account-details",-1)])]),_:1}),e[8]||(e[8]=s(" Informações Básicas ",-1))]),a(Z,null,{default:i(()=>[a(v,{cols:"12",md:"6"},{default:i(()=>[l("div",pt,[a(c,{class:"mr-2 text-grey-darken-1"},{default:i(()=>[...e[9]||(e[9]=[s("mdi-identifier",-1)])]),_:1}),l("div",null,[e[10]||(e[10]=l("div",{class:"text-caption text-grey-darken-1"},"ID",-1)),l("div",bt,g(u.organization.id),1)])])]),_:1}),a(v,{cols:"12",md:"6"},{default:i(()=>[l("div",Vt,[a(c,{class:"mr-2 text-grey-darken-1"},{default:i(()=>[...e[11]||(e[11]=[s("mdi-link",-1)])]),_:1}),l("div",null,[e[12]||(e[12]=l("div",{class:"text-caption text-grey-darken-1"},"Slug",-1)),l("div",yt,g(u.organization.slug),1)])])]),_:1}),a(v,{cols:"12",md:"6"},{default:i(()=>[l("div",zt,[a(c,{class:"mr-2 text-grey-darken-1"},{default:i(()=>[...e[13]||(e[13]=[s("mdi-email",-1)])]),_:1}),l("div",null,[e[14]||(e[14]=l("div",{class:"text-caption text-grey-darken-1"},"Email",-1)),l("div",xt,[l("a",{href:`mailto:${u.organization.email}`,class:"text-decoration-none"},g(u.organization.email),9,wt)])])])]),_:1}),u.organization.website?(w(),S(v,{key:0,cols:"12",md:"6"},{default:i(()=>[l("div",Dt,[a(c,{class:"mr-2 text-grey-darken-1"},{default:i(()=>[...e[15]||(e[15]=[s("mdi-web",-1)])]),_:1}),l("div",null,[e[17]||(e[17]=l("div",{class:"text-caption text-grey-darken-1"},"Website",-1)),l("div",_t,[l("a",{href:u.organization.website,target:"_blank",class:"text-decoration-none"},[s(g(u.organization.website)+" ",1),a(c,{size:"12",class:"ml-1"},{default:i(()=>[...e[16]||(e[16]=[s("mdi-open-in-new",-1)])]),_:1})],8,St)])])])]),_:1})):E("",!0)]),_:1})]),l("div",kt,[l("h3",Ot,[a(c,{class:"mr-2"},{default:i(()=>[...e[18]||(e[18]=[s("mdi-clock",-1)])]),_:1}),e[19]||(e[19]=s(" Histórico ",-1))]),a(Z,null,{default:i(()=>[a(v,{cols:"12",md:"6"},{default:i(()=>[l("div",At,[a(c,{class:"mr-2 text-grey-darken-1"},{default:i(()=>[...e[20]||(e[20]=[s("mdi-calendar-plus",-1)])]),_:1}),l("div",null,[e[21]||(e[21]=l("div",{class:"text-caption text-grey-darken-1"},"Criada em",-1)),l("div",Ct,g(t.organizationsService.formatDate(u.organization.createdAt)),1)])])]),_:1}),a(v,{cols:"12",md:"6"},{default:i(()=>[l("div",Tt,[a(c,{class:"mr-2 text-grey-darken-1"},{default:i(()=>[...e[22]||(e[22]=[s("mdi-calendar-edit",-1)])]),_:1}),l("div",null,[e[23]||(e[23]=l("div",{class:"text-caption text-grey-darken-1"},"Última atualização",-1)),l("div",Pt,g(t.organizationsService.formatDate(u.organization.updatedAt)),1)])])]),_:1})]),_:1})]),l("div",Et,[l("h3",ht,[a(c,{class:"mr-2"},{default:i(()=>[...e[24]||(e[24]=[s("mdi-chart-line",-1)])]),_:1}),e[25]||(e[25]=s(" Estatísticas ",-1))]),a(Z,null,{default:i(()=>[a(v,{cols:"12",md:"4"},{default:i(()=>[a(P,{variant:"tonal",color:"primary"},{default:i(()=>[a(B,{class:"text-center"},{default:i(()=>[a(c,{size:"32",class:"mb-2"},{default:i(()=>[...e[26]||(e[26]=[s("mdi-account-group",-1)])]),_:1}),e[27]||(e[27]=l("div",{class:"text-h4 font-weight-bold"},"-",-1)),e[28]||(e[28]=l("div",{class:"text-caption"},"Usuários",-1))]),_:1})]),_:1})]),_:1}),a(v,{cols:"12",md:"4"},{default:i(()=>[a(P,{variant:"tonal",color:"success"},{default:i(()=>[a(B,{class:"text-center"},{default:i(()=>[a(c,{size:"32",class:"mb-2"},{default:i(()=>[...e[29]||(e[29]=[s("mdi-source-repository",-1)])]),_:1}),e[30]||(e[30]=l("div",{class:"text-h4 font-weight-bold"},"-",-1)),e[31]||(e[31]=l("div",{class:"text-caption"},"Repositórios",-1))]),_:1})]),_:1})]),_:1}),a(v,{cols:"12",md:"4"},{default:i(()=>[a(P,{variant:"tonal",color:"warning"},{default:i(()=>[a(B,{class:"text-center"},{default:i(()=>[a(c,{size:"32",class:"mb-2"},{default:i(()=>[...e[32]||(e[32]=[s("mdi-file-document-multiple",-1)])]),_:1}),e[33]||(e[33]=l("div",{class:"text-h4 font-weight-bold"},"-",-1)),e[34]||(e[34]=l("div",{class:"text-caption"},"Análises",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),t.isDemoUser?E("",!0):(w(),Ve("div",Ut,[l("h3",Rt,[a(c,{class:"mr-2"},{default:i(()=>[...e[35]||(e[35]=[s("mdi-cog",-1)])]),_:1}),e[36]||(e[36]=s(" Ações Rápidas ",-1))]),l("div",Bt,[a(D,{color:"primary",variant:"outlined","prepend-icon":"mdi-pencil",onClick:e[0]||(e[0]=o=>n.$emit("edit"))},{default:i(()=>[...e[37]||(e[37]=[s(" Editar ",-1)])]),_:1}),a(D,{color:"info",variant:"outlined","prepend-icon":"mdi-cog",to:"/settings"},{default:i(()=>[...e[38]||(e[38]=[s(" Configurações ",-1)])]),_:1}),a(D,{color:"success",variant:"outlined","prepend-icon":"mdi-account-group",disabled:""},{default:i(()=>[...e[39]||(e[39]=[s(" Usuários ",-1)])]),_:1}),a(D,{color:"warning",variant:"outlined","prepend-icon":"mdi-source-repository",disabled:""},{default:i(()=>[...e[40]||(e[40]=[s(" Repositórios ",-1)])]),_:1})])]))])]),_:1})):E("",!0),a(M),a(ue,{class:"pa-6"},{default:i(()=>[a(me),a(D,{variant:"text",onClick:e[1]||(e[1]=o=>n.$emit("update:modelValue",!1))},{default:i(()=>[...e[41]||(e[41]=[s(" Fechar ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}const Ft=se(rt,[["render",It],["__scopeId","data-v-6c911aee"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/organizations/OrganizationDetailsDialog.vue"]]),Lt=re({__name:"OrganizationsView",setup(n,{expose:e}){e();const{isDemoUser:u}=ye(),t=_([]),p=_(!1),V=_(!1),o=_(0),f=_(!1),b=_(!1),d=_(!1),y=_(null),x=be({search:"",tier:void 0,status:void 0,isActive:void 0,page:1,limit:20,sortBy:"createdAt",sortOrder:"desc"}),A=_([{key:"createdAt",order:"desc"}]),j=[{title:"Organização",key:"name",sortable:!0},{title:"Email",key:"email",sortable:!0},{title:"Plano",key:"tier",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Ativa",key:"isActive",sortable:!0},{title:"Criada em",key:"createdAt",sortable:!0},{title:"Ações",key:"actions",sortable:!1,align:"center"}],C=k.getAvailableTiers(),h=k.getAvailableStatuses();async function O(){try{p.value=!0,A.value.length>0&&(x.sortBy=A.value[0].key,x.sortOrder=A.value[0].order),await new Promise(T=>setTimeout(T,1e3));const m=[{id:"1",name:"PRODEB",slug:"prodeb",description:"Companhia de Processamento de Dados do Estado da Bahia",email:"contato@prodeb.ba.gov.br",website:"https://www.prodeb.ba.gov.br",status:"active",tier:"enterprise",isActive:!0,createdAt:"2024-01-15T10:00:00Z",updatedAt:"2024-11-13T08:30:00Z"},{id:"2",name:"TechCorp Solutions",slug:"techcorp-solutions",description:"Empresa de tecnologia especializada em soluções corporativas",email:"contato@techcorp.com.br",website:"https://www.techcorp.com.br",status:"active",tier:"professional",isActive:!0,createdAt:"2024-02-20T14:15:00Z",updatedAt:"2024-11-12T16:45:00Z"},{id:"3",name:"StartupX",slug:"startupx",description:"Startup inovadora em fase de crescimento",email:"hello@startupx.io",status:"inactive",tier:"basic",isActive:!1,createdAt:"2024-03-10T09:30:00Z",updatedAt:"2024-11-10T11:20:00Z"}];t.value=m,o.value=m.length}catch(m){console.error("Erro ao carregar organizações:",m),t.value=[],o.value=0}finally{p.value=!1}}const U=he(()=>{x.page=1,O()},500);function I(){x.page=1,O()}function q(m){y.value=m,b.value=!0}function N(m){y.value=m,f.value=!0}async function F(m){try{await k.updateOrganization(m.id,{isActive:!m.isActive}),m.isActive=!m.isActive}catch(T){console.error("Erro ao alterar status:",T)}}function r(m){y.value=m,d.value=!0}async function Q(){if(y.value)try{V.value=!0,await k.deleteOrganization(y.value.id),await O(),d.value=!1,y.value=null}catch(m){console.error("Erro ao excluir organização:",m)}finally{V.value=!1}}function J(){O(),f.value=!1,y.value=null}function K(){b.value=!1,f.value=!0}function Y(m){return C.find(z=>z.value===m)?.title||m}function $(m){return h.find(z=>z.value===m)?.title||m}function ee(m){switch(m){case"active":return"mdi-check-circle";case"inactive":return"mdi-pause-circle";case"suspended":return"mdi-alert-circle";default:return"mdi-help-circle"}}Ce(()=>{O()});const W={isDemoUser:u,organizations:t,loading:p,deleting:V,totalItems:o,showCreateDialog:f,showDetailsDialog:b,showDeleteDialog:d,selectedOrganization:y,filters:x,sortBy:A,headers:j,tierOptions:C,statusOptions:h,loadOrganizations:O,debouncedSearch:U,applyFilters:I,viewOrganization:q,editOrganization:N,toggleActive:F,confirmDelete:r,deleteOrganization:Q,handleOrganizationSaved:J,handleEditFromDetails:K,getTierLabel:Y,getStatusLabel:$,getStatusIcon:ee,get organizationsService(){return k},OrganizationFormDialog:lt,OrganizationDetailsDialog:Ft};return Object.defineProperty(W,"__isScriptSetup",{enumerable:!1,value:!0}),W}}),jt={class:"organizations-page"},qt={class:"d-flex justify-space-between align-center mb-6"},Nt={class:"d-flex align-center"},Gt={class:"font-weight-bold"},Ht={class:"text-caption text-grey-darken-1"},Zt={class:"text-caption"},Mt={class:"d-flex gap-1"};function Wt(n,e,u,t,p,V){return w(),Ve("div",jt,[l("div",qt,[e[13]||(e[13]=l("div",null,[l("h1",{class:"text-h4 font-weight-bold text-grey-darken-3 mb-2"}," Organizações "),l("p",{class:"text-body-1 text-grey-darken-1"}," Gerencie as organizações do sistema ")],-1)),t.isDemoUser?E("",!0):(w(),S(D,{key:0,color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=o=>t.showCreateDialog=!0)},{default:i(()=>[...e[12]||(e[12]=[s(" Nova Organização ",-1)])]),_:1}))]),a(P,{class:"mb-6"},{default:i(()=>[a(B,null,{default:i(()=>[a(Z,null,{default:i(()=>[a(v,{cols:"12",md:"4"},{default:i(()=>[a(G,{modelValue:t.filters.search,"onUpdate:modelValue":e[1]||(e[1]=o=>t.filters.search=o),label:"Buscar organizações","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact","hide-details":"",clearable:"",onInput:t.debouncedSearch},null,8,["modelValue","onInput"])]),_:1}),a(v,{cols:"12",md:"3"},{default:i(()=>[a(oe,{modelValue:t.filters.tier,"onUpdate:modelValue":[e[2]||(e[2]=o=>t.filters.tier=o),t.applyFilters],items:t.tierOptions,label:"Plano",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue","items"])]),_:1}),a(v,{cols:"12",md:"3"},{default:i(()=>[a(oe,{modelValue:t.filters.status,"onUpdate:modelValue":[e[3]||(e[3]=o=>t.filters.status=o),t.applyFilters],items:t.statusOptions,label:"Status",variant:"outlined",density:"compact","hide-details":"",clearable:""},null,8,["modelValue","items"])]),_:1}),a(v,{cols:"12",md:"2"},{default:i(()=>[a(le,{modelValue:t.filters.isActive,"onUpdate:modelValue":[e[4]||(e[4]=o=>t.filters.isActive=o),t.applyFilters],label:"Apenas ativas",color:"primary","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(P,null,{default:i(()=>[a(at,{"items-per-page":t.filters.limit,"onUpdate:itemsPerPage":e[5]||(e[5]=o=>t.filters.limit=o),page:t.filters.page,"onUpdate:page":e[6]||(e[6]=o=>t.filters.page=o),"sort-by":t.sortBy,"onUpdate:sortBy":e[7]||(e[7]=o=>t.sortBy=o),headers:t.headers,items:t.organizations,"items-length":t.totalItems,loading:t.loading,"item-key":"id","onUpdate:options":t.loadOrganizations},{"item.name":i(({item:o})=>[l("div",Nt,[a(ze,{size:"40",color:"primary",class:"mr-3"},{default:i(()=>[a(c,null,{default:i(()=>[...e[14]||(e[14]=[s("mdi-domain",-1)])]),_:1})]),_:1}),l("div",null,[l("div",Gt,g(o.name),1),l("div",Ht,g(o.slug),1)])])]),"item.tier":i(({item:o})=>[a(L,{color:t.organizationsService.getTierColor(o.tier),size:"small",variant:"tonal"},{default:i(()=>[s(g(t.getTierLabel(o.tier)),1)]),_:2},1032,["color"])]),"item.status":i(({item:o})=>[a(L,{color:t.organizationsService.getStatusColor(o.status),size:"small",variant:"tonal"},{default:i(()=>[a(c,{start:"",size:"12"},{default:i(()=>[s(g(t.getStatusIcon(o.status)),1)]),_:2},1024),s(" "+g(t.getStatusLabel(o.status)),1)]),_:2},1032,["color"])]),"item.isActive":i(({item:o})=>[t.isDemoUser?(w(),S(L,{key:1,color:o.isActive?"success":"error",size:"small",variant:"tonal"},{default:i(()=>[s(g(o.isActive?"Ativa":"Inativa"),1)]),_:2},1032,["color"])):(w(),S(le,{key:0,"model-value":o.isActive,color:"success","hide-details":"","onUpdate:modelValue":f=>t.toggleActive(o)},null,8,["model-value","onUpdate:modelValue"]))]),"item.createdAt":i(({item:o})=>[l("div",Zt,g(t.organizationsService.formatDate(o.createdAt)),1)]),"item.actions":i(({item:o})=>[l("div",Mt,[a(ie,{text:"Ver detalhes"},{activator:i(({props:f})=>[a(D,H(f,{icon:"mdi-eye",variant:"text",size:"small",onClick:b=>t.viewOrganization(o)}),null,16,["onClick"])]),_:2},1024),t.isDemoUser?E("",!0):(w(),S(ie,{key:0,text:"Editar"},{activator:i(({props:f})=>[a(D,H(f,{icon:"mdi-pencil",variant:"text",size:"small",onClick:b=>t.editOrganization(o)}),null,16,["onClick"])]),_:2},1024)),t.isDemoUser?E("",!0):(w(),S(ie,{key:1,text:"Excluir"},{activator:i(({props:f})=>[a(D,H(f,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:b=>t.confirmDelete(o)}),null,16,["onClick"])]),_:2},1024))])]),loading:i(()=>[a($e,{type:"table-row@5"})]),_:2},1032,["items-per-page","page","sort-by","items","items-length","loading"])]),_:1}),a(t.OrganizationFormDialog,{modelValue:t.showCreateDialog,"onUpdate:modelValue":e[8]||(e[8]=o=>t.showCreateDialog=o),organization:t.selectedOrganization,onSaved:t.handleOrganizationSaved},null,8,["modelValue","organization"]),a(t.OrganizationDetailsDialog,{modelValue:t.showDetailsDialog,"onUpdate:modelValue":e[9]||(e[9]=o=>t.showDetailsDialog=o),organization:t.selectedOrganization,onEdit:t.handleEditFromDetails},null,8,["modelValue","organization"]),a(ne,{modelValue:t.showDeleteDialog,"onUpdate:modelValue":e[11]||(e[11]=o=>t.showDeleteDialog=o),"max-width":"500"},{default:i(()=>[a(P,null,{default:i(()=>[a(de,{class:"text-h5"},{default:i(()=>[...e[15]||(e[15]=[s(" Confirmar Exclusão ",-1)])]),_:1}),a(B,null,{default:i(()=>[e[17]||(e[17]=s(" Tem certeza que deseja excluir a organização ",-1)),l("strong",null,g(t.selectedOrganization?.name),1),e[18]||(e[18]=s("? ",-1)),a(et,{type:"warning",class:"mt-4"},{default:i(()=>[...e[16]||(e[16]=[s(" Esta ação não pode ser desfeita e todos os dados relacionados serão perdidos. ",-1)])]),_:1})]),_:1}),a(ue,null,{default:i(()=>[a(me),a(D,{variant:"text",onClick:e[10]||(e[10]=o=>t.showDeleteDialog=!1)},{default:i(()=>[...e[19]||(e[19]=[s(" Cancelar ",-1)])]),_:1}),a(D,{color:"error",variant:"flat",loading:t.deleting,onClick:t.deleteOrganization},{default:i(()=>[...e[20]||(e[20]=[s(" Excluir ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const ka=se(Lt,[["render",Wt],["__scopeId","data-v-24f8d7b6"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/organizations/OrganizationsView.vue"]]);export{ka as default};
