import{k as M,a9 as q,W as U,f as b,j as m,E as G,X as u,z as t,Q as h,_ as f,q as o,T as r,S as d,a4 as c,a1 as a,v as O,F as Q,a8 as W,Z as X}from"./vendor-vue-BvKyvIVR.js";import{r as Z}from"./repositories-DZyFHAle.js";import{_ as H}from"./index-CQBjCOQw.js";import{f as _,o as J,j as w,l as k,k as A,n as K}from"./VGrid-CuJrScxf.js";import{V as Y}from"./VAlert-ChhMmNH2.js";import{V as D,a as v}from"./VRow-C_rLTo1r.js";import{V as g}from"./VIcon-CM-KW5Qw.js";import{a as C}from"./VChip-BzUv3cXC.js";import{V as $}from"./VTable-BhCG_aMe.js";import"./auth-PiWOMLtm.js";import"./vendor-utils-Cfk84l6i.js";import"./token-storage.service-BqAv9k07.js";import"./vendor-ui-Dz8XL-co.js";import"./tag-Bnbpnddf.js";import"./dimensions-DVh0fwa7.js";const tt=M({__name:"RepositoryDetailsView",setup(R,{expose:s}){s();const x=q(),e=U(),l=b(null),p=b(!1),i=b(null),y=m(()=>x.params.id),z=m(()=>{if(!l.value)return"mdi-source-repository";switch(l.value.platform?.toLowerCase()){case"gitlab":return"mdi-gitlab";case"github":return"mdi-github";case"bitbucket":return"mdi-bitbucket";default:return"mdi-source-repository"}}),T=m(()=>{if(!l.value)return"grey";switch(l.value.platform?.toLowerCase()){case"gitlab":return"orange";case"github":return"grey-darken-2";case"bitbucket":return"blue";default:return"grey"}}),j=m(()=>{if(!l.value)return"grey";switch(l.value.syncStatus){case"active":return"success";case"paused":return"warning";case"error":return"error";default:return"grey"}}),I=m(()=>{if(!l.value)return"";switch(l.value.syncStatus){case"active":return"Ativo";case"paused":return"Pausado";case"error":return"Erro";default:return l.value.syncStatus}});async function S(){p.value=!0,i.value=null;try{l.value=await Z.getRepository(y.value)}catch(n){i.value=n instanceof Error?n.message:"Erro ao carregar repositório",console.error("Error loading repository details:",n)}finally{p.value=!1}}function B(n){return n?new Date(n).toLocaleString("pt-BR"):"N/A"}function F(n){switch(n){case"completed":return"success";case"processing":return"warning";case"pending":return"info";case"failed":return"error";default:return"grey"}}function N(n){switch(n){case"completed":return"Completa";case"processing":return"Processando";case"pending":return"Pendente";case"failed":return"Falhou";default:return n}}function P(n){e.push(`/analyses/${n.id}`)}function E(){e.push("/repositories")}function L(){l.value?.webUrl&&window.open(l.value.webUrl,"_blank")}G(()=>{S()});const V={route:x,router:e,repository:l,loading:p,error:i,repositoryId:y,platformIcon:z,platformColor:T,statusColor:j,statusText:I,loadRepositoryDetails:S,formatDate:B,getAnalysisStatusColor:F,getAnalysisStatusText:N,viewAnalysisDetails:P,goBack:E,openRepository:L};return Object.defineProperty(V,"__isScriptSetup",{enumerable:!1,value:!0}),V}}),et={class:"repository-details-page"},st={class:"d-flex align-center mb-6"},ot={key:0,class:"text-center py-12"},rt={key:2,class:"repository-details"},at={class:"flex-grow-1"},it={class:"text-h5 font-weight-bold"},lt={class:"text-body-2 text-grey-darken-1"},nt={key:0,class:"mb-4"},dt={class:"text-body-1"},ct={class:"mb-3"},ut={class:"text-body-1 font-weight-medium text-capitalize"},mt={class:"mb-3"},ft={class:"text-body-2"},pt={class:"mb-3"},yt={class:"text-body-2"},_t={class:"mb-3"},vt={class:"text-body-2"},gt={class:"mb-4"},xt={class:"d-flex align-center justify-space-between mb-2"},bt={class:"text-h6 font-weight-bold text-primary"},ht={class:"d-flex align-center justify-space-between mb-2"},wt={class:"text-body-1 font-weight-medium text-success"},kt={class:"d-flex align-center justify-space-between mb-2"},At={class:"text-body-1 font-weight-medium text-error"},Ct={class:"mb-4"},St={class:"d-flex align-center justify-space-between mb-2"},Vt={key:0,class:"mb-4"},Dt={class:"d-flex align-center justify-space-between mb-2"},Rt={class:"text-h6 font-weight-bold"},zt={class:"d-flex align-center justify-space-between mb-1"},Tt={class:"text-body-1 font-weight-medium"},jt={class:"d-flex align-center"},It=["onClick"],Bt={class:"text-caption"},Ft={key:0,class:"d-flex align-center"},Nt={class:"text-body-2"},Pt={key:1,class:"text-caption text-grey"},Et={class:"d-flex align-center"},Lt={class:"text-caption"};function Mt(R,s,x,e,l,p){return d(),u("div",et,[t("div",st,[o(_,{icon:"mdi-arrow-left",variant:"text",onClick:e.goBack,class:"me-3"}),s[0]||(s[0]=t("div",{class:"flex-grow-1"},[t("h1",{class:"text-h4 font-weight-bold text-grey-darken-3 mb-1"}," Detalhes do Repositório "),t("p",{class:"text-body-1 text-grey-darken-1"}," Informações completas e estatísticas ")],-1)),e.repository?.webUrl?(d(),h(_,{key:0,color:"primary","prepend-icon":e.platformIcon,onClick:e.openRepository,variant:"elevated"},{default:r(()=>[c(" Abrir no "+a(e.repository?.platform),1)]),_:1},8,["prepend-icon"])):f("",!0)]),e.loading?(d(),u("div",ot,[o(J,{indeterminate:"",color:"primary",size:"64"}),s[1]||(s[1]=t("p",{class:"text-body-1 text-grey-darken-1 mt-4"}," Carregando detalhes do repositório... ",-1))])):e.error?(d(),h(Y,{key:1,type:"error",variant:"tonal",class:"mb-4"},{default:r(()=>[c(a(e.error),1)]),_:1})):e.repository?(d(),u("div",rt,[o(D,{class:"mb-6"},{default:r(()=>[o(v,{cols:"12",md:"8"},{default:r(()=>[o(w,{elevation:"2"},{default:r(()=>[o(k,{class:"d-flex align-center"},{default:r(()=>[o(g,{icon:e.platformIcon,color:e.platformColor,class:"me-2",size:"32"},null,8,["icon","color"]),t("div",at,[t("div",it,a(e.repository.name),1),t("div",lt,a(e.repository.fullName),1)]),o(C,{color:e.statusColor,variant:"tonal"},{default:r(()=>[c(a(e.statusText),1)]),_:1},8,["color"])]),_:1}),o(A,null,{default:r(()=>[e.repository.description?(d(),u("div",nt,[s[2]||(s[2]=t("div",{class:"text-caption text-grey-darken-1"},"Descrição",-1)),t("div",dt,a(e.repository.description),1)])):f("",!0),o(D,null,{default:r(()=>[o(v,{cols:"12",sm:"6"},{default:r(()=>[t("div",ct,[s[3]||(s[3]=t("div",{class:"text-caption text-grey-darken-1"},"Plataforma",-1)),t("div",ut,a(e.repository.platform),1)]),t("div",mt,[s[4]||(s[4]=t("div",{class:"text-caption text-grey-darken-1"},"Criado em",-1)),t("div",ft,a(e.formatDate(e.repository.createdAt)),1)])]),_:1}),o(v,{cols:"12",sm:"6"},{default:r(()=>[t("div",pt,[s[5]||(s[5]=t("div",{class:"text-caption text-grey-darken-1"},"Última Sincronização",-1)),t("div",yt,a(e.formatDate(e.repository.lastSyncAt)),1)]),t("div",_t,[s[6]||(s[6]=t("div",{class:"text-caption text-grey-darken-1"},"Atualizado em",-1)),t("div",vt,a(e.formatDate(e.repository.updatedAt)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(v,{cols:"12",md:"4"},{default:r(()=>[o(w,{elevation:"2"},{default:r(()=>[o(k,{class:"d-flex align-center"},{default:r(()=>[o(g,{class:"me-2"},{default:r(()=>[...s[7]||(s[7]=[c("mdi-chart-box",-1)])]),_:1}),s[8]||(s[8]=c(" Estatísticas Gerais ",-1))]),_:1}),o(A,null,{default:r(()=>[t("div",gt,[t("div",xt,[s[9]||(s[9]=t("span",{class:"text-body-2"},"Total de Análises",-1)),t("span",bt,a(e.repository.statistics?.totalAnalyses||0),1)]),t("div",ht,[s[10]||(s[10]=t("span",{class:"text-body-2"},"Análises Completas",-1)),t("span",wt,a(e.repository.statistics?.completedAnalyses||0),1)]),t("div",kt,[s[11]||(s[11]=t("span",{class:"text-body-2"},"Análises Falhadas",-1)),t("span",At,a(e.repository.statistics?.failedAnalyses||0),1)])]),t("div",Ct,[t("div",St,[s[12]||(s[12]=t("span",{class:"text-body-2"},"Total de Issues",-1)),t("span",{class:O(["text-h6 font-weight-bold",e.repository.statistics?.totalIssues>0?"text-warning":"text-success"])},a(e.repository.statistics?.totalIssues||0),3)])]),e.repository.statistics?.averageScore?(d(),u("div",Vt,[t("div",Dt,[s[13]||(s[13]=t("span",{class:"text-body-2"},"Score Médio",-1)),t("span",Rt,a(e.repository.statistics.averageScore.toFixed(1)),1)]),o(K,{"model-value":e.repository.statistics.averageScore*10,color:e.repository.statistics.averageScore>=8?"success":e.repository.statistics.averageScore>=6?"warning":"error",height:"8",rounded:""},null,8,["model-value","color"])])):f("",!0),t("div",null,[t("div",zt,[s[14]||(s[14]=t("span",{class:"text-body-2"},"Branches Analisados",-1)),t("span",Tt,a(e.repository.statistics?.branches||0),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),e.repository.recentAnalyses&&e.repository.recentAnalyses.length>0?(d(),h(w,{key:0,elevation:"2"},{default:r(()=>[o(k,{class:"d-flex align-center justify-space-between"},{default:r(()=>[t("div",jt,[o(g,{class:"me-2"},{default:r(()=>[...s[15]||(s[15]=[c("mdi-history",-1)])]),_:1}),s[16]||(s[16]=c(" Análises Recentes ",-1))]),o(_,{variant:"text",size:"small",to:"/analyses","append-icon":"mdi-arrow-right"},{default:r(()=>[...s[17]||(s[17]=[c(" Ver Todas ",-1)])]),_:1})]),_:1}),o(A,null,{default:r(()=>[o($,null,{default:r(()=>[s[18]||(s[18]=t("thead",null,[t("tr",null,[t("th",null,"Branch"),t("th",null,"Commit"),t("th",null,"Status"),t("th",null,"Score"),t("th",null,"Issues"),t("th",null,"Data"),t("th",null,"Ações")])],-1)),t("tbody",null,[(d(!0),u(Q,null,W(e.repository.recentAnalyses,i=>(d(),u("tr",{key:i.id,class:"analysis-row",onClick:y=>e.viewAnalysisDetails(i)},[t("td",null,[o(C,{size:"small",variant:"tonal",color:"primary"},{default:r(()=>[c(a(i.branchName),1)]),_:2},1024)]),t("td",null,[t("code",Bt,a(i.commitSha),1)]),t("td",null,[o(C,{color:e.getAnalysisStatusColor(i.status),size:"small",variant:"tonal"},{default:r(()=>[c(a(e.getAnalysisStatusText(i.status)),1)]),_:2},1032,["color"])]),t("td",null,[i.qualityScore?(d(),u("div",Ft,[t("span",Nt,a(i.qualityScore.toFixed(1)),1)])):(d(),u("span",Pt,"N/A"))]),t("td",null,[t("div",Et,[o(g,{class:"me-1",size:"16",color:i.issuesFound>0?"warning":"success"},{default:r(()=>[c(a(i.issuesFound>0?"mdi-alert":"mdi-check-circle"),1)]),_:2},1032,["color"]),t("span",null,a(i.issuesFound),1)])]),t("td",null,[t("span",Lt,a(e.formatDate(i.createdAt)),1)]),t("td",null,[o(_,{icon:"mdi-eye",size:"small",variant:"text",color:"primary",onClick:X(y=>e.viewAnalysisDetails(i),["stop"])},null,8,["onClick"])])],8,It))),128))])]),_:1})]),_:1})]),_:1})):f("",!0)])):f("",!0)])}const se=H(tt,[["render",Mt],["__scopeId","data-v-60e1455d"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/repositories/RepositoryDetailsView.vue"]]);export{se as default};
