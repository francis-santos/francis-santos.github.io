import{k as K,W as Y,a9 as Z,f as C,E as h,X as m,_ as n,q as a,z as o,T as t,a1 as r,Q as p,S as i,a4 as s,x as $,F as E,a8 as z}from"./vendor-vue-BvKyvIVR.js";import{r as B}from"./rule-templates-_Ek9i4FY.js";import{r as ee}from"./rules-BedYAZrK.js";import{u as te,a as _}from"./VChip-BzUv3cXC.js";import{_ as le}from"./index-CQBjCOQw.js";import{o as ae,f as x,j as v,l as y,k as g,p as oe}from"./VGrid-CuJrScxf.js";import{V as f}from"./VIcon-CM-KW5Qw.js";import{V as se}from"./VMenu-B2XC7rkF.js";import{V as S,a as T}from"./VRow-C_rLTo1r.js";import{V as re}from"./VDialog-C6XAQXKq.js";import{a as ie,b as I,c as A,V as de}from"./VList-CaAoEaF2.js";import{V as ne}from"./VSpacer-kp13s616.js";import"./auth-PiWOMLtm.js";import"./vendor-utils-Cfk84l6i.js";import"./token-storage.service-BqAv9k07.js";import"./vendor-ui-Dz8XL-co.js";import"./tag-Bnbpnddf.js";import"./dimensions-DVh0fwa7.js";import"./lazy-DADzjSlN.js";import"./forwardRefs-D_qxKlPu.js";import"./ssrBoot-COakMcr6.js";const N="b1e58ac3-6a88-4fc3-846d-352c8ca4a1db",me=K({__name:"RuleTemplateDetailsView",setup(M,{expose:e}){e();const b=Y(),l=Z(),{isDemoUser:R}=te(),c=C(null),d=C(!1),k=C(null),w=C(!1),V=C(!1),L=async()=>{const u=l.params.id;if(!u){k.value="ID do template não encontrado";return}d.value=!0,k.value=null;try{c.value=await B.getRuleTemplate(u)}catch(D){k.value=D instanceof Error?D.message:"Erro ao carregar template"}finally{d.value=!1}},P=()=>{b.push("/rule-templates")},O=()=>{c.value&&b.push(`/rule-templates/${c.value.id}/edit`)},q=async()=>{if(c.value)try{const{id:u,createdAt:D,updatedAt:it,createdBy:dt,updatedBy:nt,...W}=c.value,X={...W,title:`${c.value.title} (Cópia)`,isGlobal:!1};await B.createRuleTemplate(X),b.push("/rule-templates")}catch(u){console.error("Erro ao duplicar template:",u)}},G=async()=>{if(c.value&&confirm("Tem certeza que deseja deletar este template?"))try{await B.deleteRuleTemplate(c.value.id),b.push("/rule-templates")}catch(u){console.error("Erro ao deletar template:",u)}},U=()=>{w.value=!0},F=async()=>{if(c.value){V.value=!0;try{await ee.createRuleConfig(N,{ruleTemplateId:c.value.id,isEnabled:!0,status:"enabled",customSeverity:c.value.severity}),w.value=!1,b.push("/rules")}catch(u){console.error("Erro ao configurar template:",u)}finally{V.value=!1}}},H=u=>{switch(u){case"low":return"success";case"medium":return"warning";case"high":return"orange";case"critical":return"error";default:return"grey"}},J=u=>{switch(u){case"low":return"Baixa";case"medium":return"Média";case"high":return"Alta";case"critical":return"Crítica";default:return"N/A"}},Q=u=>new Date(u).toLocaleString("pt-BR");h(()=>{L()});const j={router:b,route:l,isDemoUser:R,organizationId:N,template:c,loading:d,error:k,showConfigureDialog:w,configuringTemplate:V,loadTemplate:L,goBack:P,editTemplate:O,duplicateTemplate:q,deleteTemplate:G,configureTemplate:U,confirmConfigureTemplate:F,getSeverityColor:H,getSeverityLabel:J,formatDateTime:Q};return Object.defineProperty(j,"__isScriptSetup",{enumerable:!1,value:!0}),j}}),ue={class:"rule-template-details-page"},fe={key:0,class:"text-center py-8"},ce={key:1,class:"text-center py-8"},pe={class:"text-body-2 text-grey-darken-1 mb-4"},ve={class:"d-flex justify-center gap-3"},ge={key:2},_e={class:"d-flex align-center justify-space-between mb-6"},ye={class:"d-flex align-center"},be={class:"text-h4 font-weight-bold text-grey-darken-3 mb-1"},xe={class:"d-flex align-center gap-2"},ke={key:0,class:"d-flex align-center gap-3"},Ce={class:"text-body-1 mb-4"},Te={key:0},we={class:"text-body-2 text-grey-darken-1"},Ve={class:"text-body-1"},De={key:0,class:"mb-4"},Ee={class:"mb-2"},ze={class:"code-example"},Be={class:"mb-2"},Se={class:"code-example"},Ie={key:1},Ae={class:"d-flex align-center mb-2"},Re={class:"text-subtitle-2"},Le={class:"code-example mb-2"},je={key:0,class:"text-body-2"},Ne={key:1,class:"text-caption text-grey mt-1"},Me={class:"json-config"},Pe={class:"info-row"},Oe={class:"info-value"},qe={class:"info-row"},Ge={class:"info-value"},Ue={class:"info-row"},Fe={class:"info-value"},He={class:"info-row"},Je={class:"info-row"},Qe={class:"info-value"},We={key:0,class:"info-row"},Xe={class:"info-value"},Ke={class:"info-row"},Ye={class:"info-value"},Ze={class:"info-row"},he={class:"info-value"},$e={key:0,class:"info-row"},et={class:"info-value"},tt={key:1,class:"info-row"},lt={class:"info-value"},at={class:"mb-4"},ot={class:"text-h6 mb-2"},st={class:"text-body-2 text-grey-darken-1"};function rt(M,e,b,l,R,c){return i(),m("div",ue,[l.loading?(i(),m("div",fe,[a(ae,{indeterminate:"",color:"primary",size:"64"}),e[2]||(e[2]=o("div",{class:"mt-4 text-body-1"},"Carregando template...",-1))])):l.error?(i(),m("div",ce,[a(f,{size:"64",color:"error",class:"mb-4"},{default:t(()=>[...e[3]||(e[3]=[s("mdi-alert-circle",-1)])]),_:1}),e[6]||(e[6]=o("div",{class:"text-h6 mb-2"},"Erro ao carregar template",-1)),o("div",pe,r(l.error),1),o("div",ve,[a(x,{color:"primary",onClick:l.loadTemplate},{default:t(()=>[...e[4]||(e[4]=[s("Tentar Novamente",-1)])]),_:1}),a(x,{variant:"outlined",onClick:l.goBack},{default:t(()=>[...e[5]||(e[5]=[s("Voltar",-1)])]),_:1})])])):l.template?(i(),m("div",ge,[o("div",_e,[o("div",ye,[a(x,{icon:"mdi-arrow-left",variant:"text",onClick:l.goBack,class:"mr-3"}),o("div",null,[o("h1",be,r(l.template.title),1),o("div",xe,[a(_,{color:l.getSeverityColor(l.template.severity),size:"small"},{default:t(()=>[s(r(l.getSeverityLabel(l.template.severity)),1)]),_:1},8,["color"]),a(_,{color:l.template.isActive?"success":"error",size:"small"},{default:t(()=>[s(r(l.template.isActive?"Ativo":"Inativo"),1)]),_:1},8,["color"]),l.template.isGlobal?(i(),p(_,{key:0,color:"purple",size:"small"},{default:t(()=>[...e[7]||(e[7]=[s(" Global ",-1)])]),_:1})):n("",!0),a(_,{color:"info",size:"small",variant:"outlined"},{default:t(()=>[s(r(l.template.category),1)]),_:1})])])]),l.isDemoUser?n("",!0):(i(),m("div",ke,[a(x,{color:"primary","prepend-icon":"mdi-cog",onClick:l.configureTemplate},{default:t(()=>[...e[8]||(e[8]=[s(" Configurar para Organização ",-1)])]),_:1}),a(se,null,{activator:t(({props:d})=>[a(x,$({icon:"mdi-dots-vertical",variant:"outlined"},d),null,16)]),default:t(()=>[a(ie,null,{default:t(()=>[a(I,{onClick:l.editTemplate},{default:t(()=>[a(A,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[9]||(e[9]=[s("mdi-pencil",-1)])]),_:1}),e[10]||(e[10]=s(" Editar Template ",-1))]),_:1})]),_:1}),a(I,{onClick:l.duplicateTemplate},{default:t(()=>[a(A,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[11]||(e[11]=[s("mdi-content-copy",-1)])]),_:1}),e[12]||(e[12]=s(" Duplicar Template ",-1))]),_:1})]),_:1}),a(de),a(I,{onClick:l.deleteTemplate,class:"text-error"},{default:t(()=>[a(A,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[13]||(e[13]=[s("mdi-delete",-1)])]),_:1}),e[14]||(e[14]=s(" Deletar Template ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]))]),a(S,null,{default:t(()=>[a(T,{cols:"12",md:"8"},{default:t(()=>[a(v,{class:"mb-6"},{default:t(()=>[a(y,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[15]||(e[15]=[s("mdi-text-box",-1)])]),_:1}),e[16]||(e[16]=s(" Descrição da Regra ",-1))]),_:1}),a(g,null,{default:t(()=>[o("p",Ce,r(l.template.rule),1),l.template.description?(i(),m("div",Te,[e[17]||(e[17]=o("div",{class:"text-subtitle-2 mb-2"},"Descrição Detalhada:",-1)),o("p",we,r(l.template.description),1)])):n("",!0)]),_:1})]),_:1}),l.template.whyIsThisImportant?(i(),p(v,{key:0,class:"mb-6"},{default:t(()=>[a(y,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[18]||(e[18]=[s("mdi-lightbulb",-1)])]),_:1}),e[19]||(e[19]=s(" Por que é Importante ",-1))]),_:1}),a(g,null,{default:t(()=>[o("p",Ve,r(l.template.whyIsThisImportant),1)]),_:1})]),_:1})):n("",!0),l.template.badExample||l.template.goodExample||l.template.examples&&l.template.examples.length?(i(),p(v,{key:1,class:"mb-6"},{default:t(()=>[a(y,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[20]||(e[20]=[s("mdi-code-tags",-1)])]),_:1}),e[21]||(e[21]=s(" Exemplos ",-1))]),_:1}),a(g,null,{default:t(()=>[l.template.badExample||l.template.goodExample?(i(),m("div",De,[a(S,null,{default:t(()=>[l.template.badExample?(i(),p(T,{key:0,cols:"12",md:"6"},{default:t(()=>[o("div",Ee,[a(_,{color:"error",size:"small","prepend-icon":"mdi-close"},{default:t(()=>[...e[22]||(e[22]=[s(" Exemplo Ruim ",-1)])]),_:1})]),a(v,{color:"error",variant:"tonal"},{default:t(()=>[a(g,null,{default:t(()=>[o("pre",ze,r(l.template.badExample),1)]),_:1})]),_:1})]),_:1})):n("",!0),l.template.goodExample?(i(),p(T,{key:1,cols:"12",md:"6"},{default:t(()=>[o("div",Be,[a(_,{color:"success",size:"small","prepend-icon":"mdi-check"},{default:t(()=>[...e[23]||(e[23]=[s(" Exemplo Bom ",-1)])]),_:1})]),a(v,{color:"success",variant:"tonal"},{default:t(()=>[a(g,null,{default:t(()=>[o("pre",Se,r(l.template.goodExample),1)]),_:1})]),_:1})]),_:1})):n("",!0)]),_:1})])):n("",!0),l.template.examples&&l.template.examples.length?(i(),m("div",Ie,[e[24]||(e[24]=o("div",{class:"text-subtitle-2 mb-3"},"Exemplos Detalhados:",-1)),a(S,null,{default:t(()=>[(i(!0),m(E,null,z(l.template.examples,(d,k)=>(i(),p(T,{key:k,cols:"12",md:"6",class:"mb-3"},{default:t(()=>[a(v,{color:d.isCorrect?"success":"error",variant:"tonal"},{default:t(()=>[a(g,null,{default:t(()=>[o("div",Ae,[a(f,{color:d.isCorrect?"success":"error",class:"mr-2"},{default:t(()=>[s(r(d.isCorrect?"mdi-check-circle":"mdi-close-circle"),1)]),_:2},1032,["color"]),o("span",Re,r(d.isCorrect?"Correto":"Incorreto"),1)]),o("pre",Le,r(d.snippet),1),d.description?(i(),m("div",je,r(d.description),1)):n("",!0),d.context?(i(),m("div",Ne," Contexto: "+r(d.context),1)):n("",!0)]),_:2},1024)]),_:2},1032,["color"])]),_:2},1024))),128))]),_:1})])):n("",!0)]),_:1})]),_:1})):n("",!0),l.template.configuration?(i(),p(v,{key:2,class:"mb-6"},{default:t(()=>[a(y,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[25]||(e[25]=[s("mdi-cog",-1)])]),_:1}),e[26]||(e[26]=s(" Configuração ",-1))]),_:1}),a(g,null,{default:t(()=>[o("pre",Me,r(JSON.stringify(l.template.configuration,null,2)),1)]),_:1})]),_:1})):n("",!0)]),_:1}),a(T,{cols:"12",md:"4"},{default:t(()=>[a(v,{class:"mb-4"},{default:t(()=>[a(y,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[27]||(e[27]=[s("mdi-information",-1)])]),_:1}),e[28]||(e[28]=s(" Informações Básicas ",-1))]),_:1}),a(g,null,{default:t(()=>[o("div",Pe,[e[29]||(e[29]=o("div",{class:"info-label"},"Linguagem:",-1)),o("div",Oe,r(l.template.language),1)]),o("div",qe,[e[30]||(e[30]=o("div",{class:"info-label"},"Escopo:",-1)),o("div",Ge,r(l.template.scope),1)]),o("div",Ue,[e[31]||(e[31]=o("div",{class:"info-label"},"Categoria:",-1)),o("div",Fe,r(l.template.category),1)]),o("div",He,[e[32]||(e[32]=o("div",{class:"info-label"},"Severidade:",-1)),a(_,{color:l.getSeverityColor(l.template.severity),size:"small"},{default:t(()=>[s(r(l.getSeverityLabel(l.template.severity)),1)]),_:1},8,["color"])]),o("div",Je,[e[33]||(e[33]=o("div",{class:"info-label"},"Versão:",-1)),o("div",Qe,r(l.template.version),1)]),l.template.author?(i(),m("div",We,[e[34]||(e[34]=o("div",{class:"info-label"},"Autor:",-1)),o("div",Xe,r(l.template.author),1)])):n("",!0)]),_:1})]),_:1}),l.template.tags&&l.template.tags.length?(i(),p(v,{key:0,class:"mb-4"},{default:t(()=>[a(y,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[35]||(e[35]=[s("mdi-tag-multiple",-1)])]),_:1}),e[36]||(e[36]=s(" Tags ",-1))]),_:1}),a(g,null,{default:t(()=>[(i(!0),m(E,null,z(l.template.tags,d=>(i(),p(_,{key:d,size:"small",variant:"outlined",class:"mr-1 mb-1"},{default:t(()=>[s(r(d),1)]),_:2},1024))),128))]),_:1})]),_:1})):n("",!0),l.template.buckets&&l.template.buckets.length?(i(),p(v,{key:1,class:"mb-4"},{default:t(()=>[a(y,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[37]||(e[37]=[s("mdi-folder-multiple",-1)])]),_:1}),e[38]||(e[38]=s(" Categorias ",-1))]),_:1}),a(g,null,{default:t(()=>[(i(!0),m(E,null,z(l.template.buckets,d=>(i(),p(_,{key:d,size:"small",color:"info",variant:"outlined",class:"mr-1 mb-1"},{default:t(()=>[s(r(d),1)]),_:2},1024))),128))]),_:1})]),_:1})):n("",!0),a(v,{class:"mb-4"},{default:t(()=>[a(y,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[39]||(e[39]=[s("mdi-clock",-1)])]),_:1}),e[40]||(e[40]=s(" Histórico ",-1))]),_:1}),a(g,null,{default:t(()=>[o("div",Ke,[e[41]||(e[41]=o("div",{class:"info-label"},"Criado em:",-1)),o("div",Ye,r(l.formatDateTime(l.template.createdAt)),1)]),o("div",Ze,[e[42]||(e[42]=o("div",{class:"info-label"},"Atualizado em:",-1)),o("div",he,r(l.formatDateTime(l.template.updatedAt)),1)]),l.template.createdBy?(i(),m("div",$e,[e[43]||(e[43]=o("div",{class:"info-label"},"Criado por:",-1)),o("div",et,r(l.template.createdBy),1)])):n("",!0),l.template.updatedBy?(i(),m("div",tt,[e[44]||(e[44]=o("div",{class:"info-label"},"Atualizado por:",-1)),o("div",lt,r(l.template.updatedBy),1)])):n("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])):n("",!0),a(re,{modelValue:l.showConfigureDialog,"onUpdate:modelValue":e[1]||(e[1]=d=>l.showConfigureDialog=d),"max-width":"600px",persistent:""},{default:t(()=>[a(v,null,{default:t(()=>[a(y,null,{default:t(()=>[a(f,{class:"mr-2"},{default:t(()=>[...e[45]||(e[45]=[s("mdi-cog",-1)])]),_:1}),e[46]||(e[46]=s(" Configurar Template para Organização ",-1))]),_:1}),l.template?(i(),p(g,{key:0},{default:t(()=>[o("div",at,[o("h4",ot,r(l.template.title),1),o("p",st,r(l.template.rule),1)]),e[47]||(e[47]=o("p",{class:"text-body-2 mb-4"}," Este template será adicionado às regras configuradas da sua organização. Você poderá personalizar severidade, mensagens e outros parâmetros após a criação. ",-1))]),_:1})):n("",!0),a(oe,null,{default:t(()=>[a(ne),a(x,{onClick:e[0]||(e[0]=d=>l.showConfigureDialog=!1)},{default:t(()=>[...e[48]||(e[48]=[s("Cancelar",-1)])]),_:1}),a(x,{color:"primary",onClick:l.confirmConfigureTemplate,loading:l.configuringTemplate},{default:t(()=>[...e[49]||(e[49]=[s(" Configurar ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const It=le(me,[["render",rt],["__scopeId","data-v-4e7d5896"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/rule-templates/RuleTemplateDetailsView.vue"]]);export{It as default};
