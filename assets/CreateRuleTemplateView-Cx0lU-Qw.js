import{k as Z,a6 as $,af as ee,j as _,f as w,r as le,E as ae,_ as U,z as u,q as e,W as R,a1 as t,a8 as s,F as oe,ae as te,a9 as re,a2 as k}from"./vendor-vue-BOgiBTV5.js";import{r as q}from"./rule-templates-DhfUSUkA.js";import{_ as ie,b as y,a as p}from"./index-CPKBv9AR.js";import{V as c,a as n}from"./VRow-xKwg0MSP.js";import{V as g,a as E,b as v}from"./VGrid-BsndwDIl.js";import{V}from"./VTextField-DiiVGj7F.js";import{V as f}from"./VTextarea-ndrXJOcn.js";import{V as B}from"./VSelect-BBg-Hfm2.js";import{V as I}from"./VList-BKPY6TWC.js";import{V as O}from"./VCombobox-GEMXSY4H.js";import{V as D}from"./VSwitch-BvA2_gQQ.js";import{V as ne}from"./VForm-pUagEOzw.js";import"./auth-Dt5LZyuD.js";import"./vendor-utils-C9OYYH06.js";import"./token-storage.service-BqAv9k07.js";import"./VChip-rM5LjFon.js";import"./index-DzEvJ-T3.js";import"./vendor-ui-BR0KSDoQ.js";import"./autofocus-DZuUxpyU.js";import"./VMenu-vHpHdbAo.js";import"./dialog-transition-BRPqoOP4.js";import"./ssrBoot-Cswv876e.js";import"./filter-BU9fsv7R.js";const se=Z({__name:"CreateRuleTemplateView",setup(z,{expose:l}){l();const C=$(),a=ee(),b=_(()=>a.params.id),x=_(()=>!!b.value),r=w(!1),m=w(!1),d=w(""),T=w([]),i=le({title:"",rule:"",whyIsThisImportant:"",severity:"medium",badExample:"",goodExample:"",examples:[],language:"",buckets:[],scope:"code",category:"",isActive:!0,isGlobal:!1,version:"1.0.0",author:"",tags:[],description:"",configuration:null}),N=[{title:"Baixa",value:"low"},{title:"Média",value:"medium"},{title:"Alta",value:"high"},{title:"Crítica",value:"critical"}],j=[{title:"Código",value:"code"},{title:"Pull Request",value:"pull-request"},{title:"Organização",value:"organization"},{title:"Projeto",value:"project"}],J=[o=>!!o||"Título é obrigatório",o=>o.length>=10||"Título deve ter pelo menos 10 caracteres",o=>o.length<=200||"Título deve ter no máximo 200 caracteres"],P=[o=>!!o||"Descrição da regra é obrigatória",o=>o.length>=20||"Descrição deve ter pelo menos 20 caracteres"],G=[o=>!!o||"Explicação da importância é obrigatória",o=>o.length>=10||"Explicação deve ter pelo menos 10 caracteres"],L=[o=>!!o||"Severidade é obrigatória"],M=[o=>!!o||"Linguagem é obrigatória",o=>o.length>=2||"Linguagem deve ter pelo menos 2 caracteres"],F=[o=>!!o||"Categoria é obrigatória",o=>o.length>=2||"Categoria deve ter pelo menos 2 caracteres"],W=[o=>!!o||"Escopo é obrigatório"],H=()=>{i.examples.push({snippet:"",isCorrect:!1,description:"",context:""})},K=o=>{i.examples.splice(o,1)},Q=()=>{if(T.value=[],!d.value.trim()){i.configuration=null;return}try{i.configuration=JSON.parse(d.value)}catch{T.value=["JSON inválido"],i.configuration=null}},X=async()=>{if(r.value){m.value=!0;try{const o={...i,examples:i.examples.length>0?i.examples:void 0,badExample:i.badExample||void 0,goodExample:i.goodExample||void 0,author:i.author||void 0,description:i.description||void 0};x.value?await q.updateRuleTemplate(b.value,o):await q.createRuleTemplate(o),C.push("/rule-templates")}catch(o){console.error(`Erro ao ${x.value?"atualizar":"criar"} template:`,o)}finally{m.value=!1}}},Y=()=>{C.back()},S=async()=>{if(x.value){m.value=!0;try{const o=await q.getRuleTemplate(b.value);i.title=o.title,i.rule=o.rule,i.whyIsThisImportant=o.whyIsThisImportant,i.severity=o.severity,i.badExample=o.badExample||"",i.goodExample=o.goodExample||"",i.examples=o.examples||[],i.language=o.language,i.buckets=o.buckets,i.scope=o.scope,i.category=o.category,i.isActive=o.isActive,i.isGlobal=o.isGlobal,i.version=o.version,i.author=o.author||"",i.tags=o.tags,i.description=o.description||"",o.configuration&&(d.value=JSON.stringify(o.configuration,null,2))}catch(o){console.error("Erro ao carregar template:",o)}finally{m.value=!1}}};ae(()=>{S()});const h=_(()=>i.title||i.rule||i.whyIsThisImportant);window.addEventListener("beforeunload",o=>{h.value&&(o.preventDefault(),o.returnValue="")});const A={router:C,route:a,templateId:b,isEditing:x,valid:r,loading:m,configurationJson:d,configurationError:T,form:i,severityOptions:N,scopeOptions:j,titleRules:J,ruleRules:P,importanceRules:G,severityRules:L,languageRules:M,categoryRules:F,scopeRules:W,addExample:H,removeExample:K,validateConfiguration:Q,submit:X,goBack:Y,loadTemplateData:S,hasUnsavedChanges:h};return Object.defineProperty(A,"__isScriptSetup",{enumerable:!1,value:!0}),A}}),de={class:"create-rule-template-page"},ue={class:"d-flex align-center mb-6"},me={class:"text-h4 font-weight-bold text-grey-darken-3 mb-1"},fe={class:"text-body-2 text-grey-darken-1"},pe={class:"d-flex align-center justify-space-between mb-3"},ce={class:"d-flex justify-space-between align-center mb-3"},ge={class:"text-h6"},ve={class:"mb-3"},Ve={class:"d-flex flex-column gap-2"};function be(z,l,C,a,b,x){return k(),U("div",de,[u("div",ue,[e(y,{icon:"mdi-arrow-left",variant:"text",onClick:a.goBack,class:"mr-3"}),u("div",null,[u("h1",me,R(a.isEditing?"Editar Template de Regra":"Criar Template de Regra"),1),u("p",fe,R(a.isEditing?"Modifique as configurações do template de regra":"Defina um novo template de regra para análise de código"),1)])]),e(ne,{modelValue:a.valid,"onUpdate:modelValue":l[17]||(l[17]=r=>a.valid=r),onSubmit:re(a.submit,["prevent"])},{default:t(()=>[e(c,null,{default:t(()=>[e(n,{cols:"12",md:"8"},{default:t(()=>[e(g,{class:"mb-6"},{default:t(()=>[e(E,null,{default:t(()=>[e(p,{class:"mr-2"},{default:t(()=>[...l[18]||(l[18]=[s("mdi-information",-1)])]),_:1}),l[19]||(l[19]=s(" Informações Básicas ",-1))]),_:1}),e(v,null,{default:t(()=>[e(c,null,{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[e(V,{modelValue:a.form.title,"onUpdate:modelValue":l[0]||(l[0]=r=>a.form.title=r),label:"Título da Regra *",rules:a.titleRules,variant:"outlined","prepend-inner-icon":"mdi-format-title",required:"",hint:"Ex: Escreva um título de PR claro e específico"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12"},{default:t(()=>[e(f,{modelValue:a.form.rule,"onUpdate:modelValue":l[1]||(l[1]=r=>a.form.rule=r),label:"Descrição da Regra *",rules:a.ruleRules,variant:"outlined",rows:"3",required:"",hint:"Descreva detalhadamente o que a regra verifica"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12"},{default:t(()=>[e(f,{modelValue:a.form.whyIsThisImportant,"onUpdate:modelValue":l[2]||(l[2]=r=>a.form.whyIsThisImportant=r),label:"Por que é importante *",rules:a.importanceRules,variant:"outlined",rows:"2",required:"",hint:"Explique a importância desta regra para a qualidade do código"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12"},{default:t(()=>[e(f,{modelValue:a.form.description,"onUpdate:modelValue":l[3]||(l[3]=r=>a.form.description=r),label:"Descrição adicional",variant:"outlined",rows:"2",hint:"Informações adicionais sobre o template (opcional)"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(g,{class:"mb-6"},{default:t(()=>[e(E,null,{default:t(()=>[e(p,{class:"mr-2"},{default:t(()=>[...l[20]||(l[20]=[s("mdi-cog",-1)])]),_:1}),l[21]||(l[21]=s(" Configuração ",-1))]),_:1}),e(v,null,{default:t(()=>[e(c,null,{default:t(()=>[e(n,{cols:"12",md:"6"},{default:t(()=>[e(B,{modelValue:a.form.severity,"onUpdate:modelValue":l[4]||(l[4]=r=>a.form.severity=r),items:a.severityOptions,label:"Severidade *",rules:a.severityRules,variant:"outlined",required:"","item-title":"title","item-value":"value"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"6"},{default:t(()=>[e(V,{modelValue:a.form.language,"onUpdate:modelValue":l[5]||(l[5]=r=>a.form.language=r),label:"Linguagem *",rules:a.languageRules,variant:"outlined",required:"",hint:"Ex: javascript, python, general"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"6"},{default:t(()=>[e(V,{modelValue:a.form.category,"onUpdate:modelValue":l[6]||(l[6]=r=>a.form.category=r),label:"Categoria *",rules:a.categoryRules,variant:"outlined",required:"",hint:"Ex: security, performance, style"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"6"},{default:t(()=>[e(B,{modelValue:a.form.scope,"onUpdate:modelValue":l[7]||(l[7]=r=>a.form.scope=r),items:a.scopeOptions,label:"Escopo *",rules:a.scopeRules,variant:"outlined",required:"","item-title":"title","item-value":"value"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"6"},{default:t(()=>[e(V,{modelValue:a.form.version,"onUpdate:modelValue":l[8]||(l[8]=r=>a.form.version=r),label:"Versão",variant:"outlined",placeholder:"1.0.0"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"6"},{default:t(()=>[e(V,{modelValue:a.form.author,"onUpdate:modelValue":l[9]||(l[9]=r=>a.form.author=r),label:"Autor",variant:"outlined",hint:"Nome do autor do template"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(g,{class:"mb-6"},{default:t(()=>[e(E,null,{default:t(()=>[e(p,{class:"mr-2"},{default:t(()=>[...l[22]||(l[22]=[s("mdi-code-tags",-1)])]),_:1}),l[23]||(l[23]=s(" Exemplos ",-1))]),_:1}),e(v,null,{default:t(()=>[e(c,null,{default:t(()=>[e(n,{cols:"12",md:"6"},{default:t(()=>[e(f,{modelValue:a.form.badExample,"onUpdate:modelValue":l[10]||(l[10]=r=>a.form.badExample=r),label:"Exemplo Ruim",variant:"outlined",rows:"3",hint:"Exemplo de código que viola a regra"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"6"},{default:t(()=>[e(f,{modelValue:a.form.goodExample,"onUpdate:modelValue":l[11]||(l[11]=r=>a.form.goodExample=r),label:"Exemplo Bom",variant:"outlined",rows:"3",hint:"Exemplo de código que segue a regra"},null,8,["modelValue"])]),_:1})]),_:1}),e(I,{class:"my-4"}),u("div",pe,[l[25]||(l[25]=u("h4",{class:"text-h6"},"Exemplos Detalhados",-1)),e(y,{color:"primary",size:"small","prepend-icon":"mdi-plus",onClick:a.addExample},{default:t(()=>[...l[24]||(l[24]=[s(" Adicionar Exemplo ",-1)])]),_:1})]),(k(!0),U(oe,null,te(a.form.examples,(r,m)=>(k(),U("div",{key:m,class:"mb-4"},[e(g,{variant:"outlined"},{default:t(()=>[e(v,null,{default:t(()=>[u("div",ce,[u("h5",ge,"Exemplo "+R(m+1),1),e(y,{icon:"mdi-delete",size:"small",color:"error",variant:"text",onClick:d=>a.removeExample(m)},null,8,["onClick"])]),e(c,null,{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[e(f,{modelValue:r.snippet,"onUpdate:modelValue":d=>r.snippet=d,label:"Código *",variant:"outlined",rows:"2",required:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{cols:"12",md:"6"},{default:t(()=>[e(D,{modelValue:r.isCorrect,"onUpdate:modelValue":d=>r.isCorrect=d,label:"Código está correto?",color:"success","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{cols:"12",md:"6"},{default:t(()=>[e(V,{modelValue:r.context,"onUpdate:modelValue":d=>r.context=d,label:"Contexto",variant:"outlined",hint:"Contexto adicional para o exemplo"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(n,{cols:"12"},{default:t(()=>[e(f,{modelValue:r.description,"onUpdate:modelValue":d=>r.description=d,label:"Descrição",variant:"outlined",rows:"2",hint:"Explicação do exemplo"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})]),_:1}),e(g,{class:"mb-6"},{default:t(()=>[e(E,null,{default:t(()=>[e(p,{class:"mr-2"},{default:t(()=>[...l[26]||(l[26]=[s("mdi-tag-multiple",-1)])]),_:1}),l[27]||(l[27]=s(" Tags e Classificação ",-1))]),_:1}),e(v,null,{default:t(()=>[e(c,null,{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[e(O,{modelValue:a.form.tags,"onUpdate:modelValue":l[12]||(l[12]=r=>a.form.tags=r),label:"Tags",variant:"outlined",multiple:"",chips:"",clearable:"",hint:"Adicione tags para classificar a regra (pressione Enter para adicionar)"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12"},{default:t(()=>[e(O,{modelValue:a.form.buckets,"onUpdate:modelValue":l[13]||(l[13]=r=>a.form.buckets=r),label:"Buckets",variant:"outlined",multiple:"",chips:"",clearable:"",hint:"Categorias de organização (ex: security, performance, style)"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(n,{cols:"12",md:"4"},{default:t(()=>[e(g,{class:"mb-6",style:{position:"sticky",top:"20px"}},{default:t(()=>[e(E,null,{default:t(()=>[e(p,{class:"mr-2"},{default:t(()=>[...l[28]||(l[28]=[s("mdi-tune",-1)])]),_:1}),l[29]||(l[29]=s(" Configurações Avançadas ",-1))]),_:1}),e(v,null,{default:t(()=>[e(c,null,{default:t(()=>[e(n,{cols:"12"},{default:t(()=>[e(D,{modelValue:a.form.isActive,"onUpdate:modelValue":l[14]||(l[14]=r=>a.form.isActive=r),label:"Template ativo",color:"success",hint:"Define se o template está disponível para uso","persistent-hint":""},null,8,["modelValue"])]),_:1}),e(n,{cols:"12"},{default:t(()=>[e(D,{modelValue:a.form.isGlobal,"onUpdate:modelValue":l[15]||(l[15]=r=>a.form.isGlobal=r),label:"Template global",color:"primary",hint:"Disponível para todas as organizações","persistent-hint":""},null,8,["modelValue"])]),_:1})]),_:1}),e(I,{class:"my-4"}),u("div",ve,[l[30]||(l[30]=u("h4",{class:"text-h6 mb-2"},"Configuração JSON",-1)),e(f,{modelValue:a.configurationJson,"onUpdate:modelValue":l[16]||(l[16]=r=>a.configurationJson=r),label:"Configuração personalizada",variant:"outlined",rows:"6",hint:"JSON com configurações específicas (opcional)","error-messages":a.configurationError,onInput:a.validateConfiguration},null,8,["modelValue","error-messages"])]),e(I,{class:"my-4"}),u("div",Ve,[e(y,{type:"submit",color:"success",variant:"elevated",size:"large",loading:a.loading,disabled:!a.valid,block:""},{default:t(()=>[e(p,{class:"mr-2"},{default:t(()=>[...l[31]||(l[31]=[s("mdi-content-save",-1)])]),_:1}),s(" "+R(a.loading?a.isEditing?"Salvando...":"Criando...":a.isEditing?"Salvar Alterações":"Criar Template"),1)]),_:1},8,["loading","disabled"]),l[34]||(l[34]=u("br",null,null,-1)),e(y,{color:"grey",variant:"outlined",onClick:a.goBack,block:""},{default:t(()=>[e(p,{class:"mr-2"},{default:t(()=>[...l[32]||(l[32]=[s("mdi-arrow-left",-1)])]),_:1}),l[33]||(l[33]=s(" Cancelar ",-1))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const Ge=ie(se,[["render",be],["__scopeId","data-v-97bb09e1"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/rule-templates/CreateRuleTemplateView.vue"]]);export{Ge as default};
