import{j as Be,d as _,r as qe,h as He,w as Ge,D as Je,Z as N,y as s,n as t,$ as P,a0 as S,u as L,a1 as o,_ as k,aa as i,V as n,U as Qe,Y as Ye,ac as we,ad as _e,q as Te,F as Ze,ah as Ke}from"./vendor-vue-BKuzT1x2.js";import{b as H}from"./auth.service-BozCwdnf.js";import{u as se}from"./useDemoMode-DpDjlFnd.js";import{tokenStorage as he}from"./token-storage.service-BqAv9k07.js";import{a as R,b as Xe,V as et}from"./VChip-BfcyEr4e.js";import{b as h,a as c,c as tt,_ as ot}from"./index-gFSB3kms.js";import{V as st}from"./VAlert-BZmB2o6G.js";import{V as ue,a as E}from"./VRow-C_u8820H.js";import{V as C,b as F,e as D,a as G,c as Ve}from"./VGrid-CBGRWS1y.js";import{V as ce}from"./VDialog-BfRWf8LZ.js";import{V as oe,a as X}from"./VSelect-BorMXFwi.js";import{V as O,c as Ce,a as I,d as W}from"./VList-Dg4abNUz.js";import{V as lt}from"./VDataTable-CaN6duAr.js";import{V as at}from"./VPagination-B83tja3x.js";import{V as De}from"./VSpacer-CTPiANoM.js";import"./vendor-utils-6xD0fNU8.js";import"./auth--EmZq-C7.js";import"./vendor-ui-Ca7vMALJ.js";import"./dialog-transition-B8nu4acL.js";import"./autofocus-Cv2p5X6o.js";import"./form-PEXhLZdP.js";import"./VMenu-BCjbZdow.js";import"./ssrBoot-DJyMk-ri.js";import"./VTable-SZOAnLd3.js";import"./filter-BaTOFc6H.js";class it{async getWebhookLogs(m,g={},v=1,w=20){const{isDemoUser:p,getMockData:f,simulateApiDelay:A}=se();if(p.value){await A();const V=await f("webhooks",v,w,g),z=Math.ceil(V.total/w);return{...V,totalPages:z,hasNext:v<z,hasPrevious:v>1}}const x=new URLSearchParams({organizationId:m,page:v.toString(),limit:w.toString(),...Object.fromEntries(Object.entries(g).filter(([,V])=>V!==void 0&&V!==""))});return await H.get(`/webhooks/logs?${x}`)}async getWebhookLogDetails(m){const{isDemoUser:g,getMockItem:v,simulateApiDelay:w}=se();if(g.value){await w();const p=v("webhooks",m);if(!p)throw new Error("Webhook não encontrado");return p}return await H.get(`/webhooks/logs/${m}`)}async getWebhookLogStats(m,g={}){const{isDemoUser:v,simulateApiDelay:w}=se();if(v.value)return await w(),{total:156,processed:132,failed:8,pending:12,ignored:4,processingRate:84.6,errorRate:5.1,averageProcessingTime:2.3,topEventTypes:[{eventType:"push",count:78},{eventType:"pull_request",count:34},{eventType:"issue",count:22},{eventType:"merge_request",count:18},{eventType:"release",count:4}],topRepositories:[{repository:"demo/projeto-frontend-react",count:45},{repository:"demo/api-backend-node",count:38},{repository:"demo/mobile-app-flutter",count:29},{repository:"demo/infrastructure-terraform",count:24},{repository:"demo/documentation-site",count:20}]};const p=new URLSearchParams({organizationId:m,...Object.fromEntries(Object.entries(g).filter(([,y])=>y!==void 0&&y!==""))}),f=await H.get(`/webhooks/logs/stats?${p}`),A=Object.entries(f.byEventType).map(([y,r])=>({eventType:y,count:r})).sort((y,r)=>r.count-y.count).slice(0,5),x=Object.entries(f.byProvider).map(([y,r])=>({provider:y,count:r})).sort((y,r)=>r.count-y.count),V=new Date,z=[];for(let y=6;y>=0;y--){const r=new Date(V);r.setDate(r.getDate()-y);const $=r.toISOString().split("T")[0];z.push({date:$||"",count:Math.floor(Math.random()*10)})}return{total:f.total,processed:f.processed,failed:f.failed,pending:f.pending,retry:0,avgProcessingTime:f.averageProcessingTime,successRate:f.successRate,errorRate:100-f.successRate,topEventTypes:A,topProviders:x,recentActivity:z}}calculateStats(m){const{data:g,total:v}=m,w=g.filter(u=>u.status==="processed").length,p=g.filter(u=>u.status==="failed").length,f=g.filter(u=>u.status==="pending").length,A=g.filter(u=>u.status==="retry").length,x=g.filter(u=>u.processingTime!==null).map(u=>u.processingTime),V=x.length>0?x.reduce((u,b)=>u+b,0)/x.length:0,z=v>0?w/v*100:0,y=v>0?p/v*100:0,r=g.reduce((u,b)=>(u[b.eventType]=(u[b.eventType]||0)+1,u),{}),$=Object.entries(r).map(([u,b])=>({eventType:u,count:b})).sort((u,b)=>b.count-u.count).slice(0,5),J=g.reduce((u,b)=>(u[b.provider]=(u[b.provider]||0)+1,u),{}),M=Object.entries(J).map(([u,b])=>({provider:u,count:b})).sort((u,b)=>b.count-u.count),B=new Date,Q=[];for(let u=6;u>=0;u--){const b=new Date(B);b.setDate(b.getDate()-u);const Y=b.toISOString().split("T")[0],d=g.filter(le=>new Date(le.createdAt).toISOString().split("T")[0]===Y).length;Q.push({date:Y||"",count:d})}return{total:v,processed:w,failed:p,pending:f,retry:A,avgProcessingTime:V,successRate:z,errorRate:y,topEventTypes:$,topProviders:M,recentActivity:Q}}async retryWebhook(m){return await H.post(`/webhooks/logs/${m}/retry`)}async deleteWebhookLog(m){await H.delete(`/webhooks/logs/${m}`)}async bulkDeleteWebhookLogs(m){await H.post("/webhooks/logs/bulk-delete",{logIds:m})}async exportWebhookLogs(m,g={},v="csv"){const w=new URLSearchParams({organizationId:m,format:v,...Object.fromEntries(Object.entries(g).filter(([,x])=>x!==void 0&&x!==""))}),p={Accept:v==="csv"?"text/csv":"application/json"},f=he.getAccessToken();f&&!he.isTokenExpired()&&(p.Authorization=`Bearer ${f}`);const A=await fetch(`${H.getBaseURL()}/webhooks/logs/export?${w}`,{method:"GET",headers:p});if(!A.ok)throw new Error("Erro ao exportar dados");return await A.blob()}convertToCSV(m){if(m.length===0)return"";const g=["ID","Provider","Event Type","Status","Repository","Actor","Processing Time","Created At"],v=m.map(p=>[p.id,p.provider,p.eventType,p.status,p.repositoryFullName,p.actor,p.processingTime||"",p.createdAt]);return[g.join(","),...v.map(p=>p.map(f=>`"${f}"`).join(","))].join(`
`)}getEventTypes(){return[{title:"Push",value:"push"},{title:"Merge Request",value:"merge_request"},{title:"Pull Request",value:"pull_request"},{title:"Issue",value:"issue"},{title:"Pipeline",value:"pipeline"},{title:"Release",value:"release"},{title:"Tag",value:"tag"},{title:"Wiki",value:"wiki"}]}getProviders(){return[{title:"GitLab",value:"gitlab",icon:"mdi-gitlab"},{title:"GitHub",value:"github",icon:"mdi-github"},{title:"Bitbucket",value:"bitbucket",icon:"mdi-bitbucket"}]}getStatusOptions(){return[{title:"Processado",value:"processed",color:"success"},{title:"Falhou",value:"failed",color:"error"},{title:"Pendente",value:"pending",color:"warning"},{title:"Tentando Novamente",value:"retry",color:"info"}]}}const j=new it,rt={class:"webhooks-page pa-6"},nt={class:"d-flex justify-space-between align-center mb-6"},dt={class:"d-flex gap-2"},ut={class:"d-flex align-center"},ct={class:"flex-grow-1"},mt={class:"text-h4 font-weight-bold"},pt={class:"d-flex align-center"},vt={class:"flex-grow-1"},ft={class:"text-h4 font-weight-bold text-success"},gt={class:"d-flex align-center"},bt={class:"flex-grow-1"},yt={class:"text-h4 font-weight-bold text-info"},kt={class:"d-flex align-center"},xt={class:"flex-grow-1"},wt={class:"text-h4 font-weight-bold text-error"},_t={class:"px-4 py-3 d-flex align-center justify-space-between border-b"},Tt={class:"d-flex align-center gap-3"},ht={class:"d-flex align-center"},Vt={class:"px-4 py-4 advanced-filters-section"},Ct={class:"d-flex align-center gap-3"},Dt={class:"d-flex align-center gap-2"},zt={class:"d-flex align-center justify-end gap-2"},Pt={key:0,class:"text-center py-8"},St={key:1,class:"text-center py-8"},Et={class:"text-body-2 text-medium-emphasis mb-4"},At={key:2,class:"text-center py-8"},Lt={key:3},Rt={class:"d-flex align-center gap-2"},Ft={class:"text-capitalize"},Ot={class:"d-flex align-center gap-2"},jt={class:"text-truncate",style:{"max-width":"200px"}},Ut={class:"d-flex align-center gap-2"},Nt={class:"text-caption"},It={class:"ml-2"},Wt={class:"text-body-2"},$t={class:"text-caption text-grey-darken-1"},Mt={class:"d-flex gap-1"},Bt={class:"d-flex justify-center mt-4"},qt={class:"dialog-header"},Ht={class:"dialog-header-content"},Gt={class:"dialog-icon-wrapper"},Jt={class:"dialog-title-section"},Qt={class:"dialog-subtitle"},Yt={class:"dialog-content"},Zt={key:0},Kt={class:"mt-2"},Xt={key:1,class:"text-center py-6 text-medium-emphasis"},eo={class:"code-container mt-4"},to={class:"code-content"},oo={class:"code-container mt-4"},so={class:"code-content payload-content"},lo={class:"mb-4 mt-2"},ao={class:"text-caption bg-grey-lighten-4 pl-2 pt-1 pb-1 rounded d-block mt-1"},io={class:"mb-4"},ro={class:"text-body-2 mt-1"},no={class:"mb-4"},uo={class:"text-body-2 mt-1"},co={class:"text-caption text-medium-emphasis"},mo={class:"mb-4"},po={key:0,class:"mb-4"},vo={class:"text-body-2 mt-1"},fo={class:"dialog-footer"},go={class:"dialog-actions"},me="b1e58ac3-6a88-4fc3-846d-352c8ca4a1db",bo=Be({__name:"WebhooksView",setup(ze){const{isDemoUser:m}=se(),g=_([]),v=_(null),w=_(!1),p=_(null),f=_(1),A=_(1),x=_([]),V=_(!1),z=_(!1),y=_(!1),r=_(null),$=_(null),J=_(!1),M=_(!1),B=_(!1),Q=_(null),u=_(""),b=_("createdAt"),Y=_("desc"),d=qe({provider:"",eventType:"",status:"",actor:"",dateFrom:"",dateTo:""}),le=j.getProviders(),pe=j.getEventTypes(),Pe=j.getStatusOptions(),Se=[{title:"Data de Criação",value:"createdAt"},{title:"Provedor",value:"provider"},{title:"Status",value:"status"},{title:"Tempo de Processamento",value:"processingTime"}],Ee=[{title:"Mais recente",value:"desc"},{title:"Mais antigo",value:"asc"}],ee=He(()=>{let a=0;return u.value&&a++,d.provider&&a++,d.eventType&&a++,d.status&&a++,d.actor&&a++,d.dateFrom&&a++,d.dateTo&&a++,a}),Ae=[{title:"Provedor",key:"provider",sortable:!1},{title:"Evento",key:"eventType",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Repositório",key:"repositoryFullName",sortable:!1},{title:"Autor",key:"actor",sortable:!1},{title:"Tempo Proc.",key:"processingTime",sortable:!1},{title:"Data/Hora",key:"createdAt",sortable:!1},{title:"Ações",key:"actions",sortable:!1,width:120}];function Le(a){d.provider="",d.eventType="",d.status="",d.actor="",d.dateFrom="",d.dateTo="",a==="processed"?d.status="processed":a==="failed"?d.status="failed":a==="gitlab"?d.provider="gitlab":a==="github"&&(d.provider="github"),U()}function Re(){d.provider="",d.eventType="",d.status="",d.actor="",d.dateFrom="",d.dateTo="",u.value="",Q.value=null,b.value="createdAt",Y.value="desc",te()}function Fe(){q(),Z()}let ae=null;function U(){ae&&clearTimeout(ae),ae=setTimeout(()=>{te()},300)}let ie=null;function Oe(){ie&&clearTimeout(ie),ie=setTimeout(()=>{te()},300)}const q=async(a=f.value)=>{w.value=!0,p.value=null;try{const e=Object.fromEntries(Object.entries(d).filter(([,T])=>T!==""&&T!==null&&T!==void 0)),l=await j.getWebhookLogs(me,e,a,20);g.value=l.data,f.value=l.page,A.value=l.totalPages}catch(e){p.value=e instanceof Error?e.message:"Erro ao carregar logs"}finally{w.value=!1}},Z=async()=>{try{const a=Object.fromEntries(Object.entries(d).filter(([,e])=>e!==""&&e!==null&&e!==void 0));v.value=await j.getWebhookLogStats(me,a)}catch(a){console.error("Erro ao carregar estatísticas:",a)}},te=()=>{f.value=1,q(1),Z()},je=async a=>{try{r.value=await j.getWebhookLogDetails(a.id),V.value=!0}catch(e){console.error("Erro ao carregar detalhes do log:",e)}},Ue=a=>{$.value=a,z.value=!0},Ne=async()=>{if($.value){M.value=!0;try{await j.deleteWebhookLog($.value.id),await q(),await Z(),z.value=!1,$.value=null}catch(a){alert("Funcionalidade de exclusão não disponível na API atual"),console.error("Erro ao excluir log:",a)}finally{M.value=!1}}},Ie=()=>{x.value.length>0&&(y.value=!0)},We=async()=>{M.value=!0;try{await j.bulkDeleteWebhookLogs(x.value),x.value=[],await q(),await Z(),y.value=!1}catch(a){alert("Funcionalidade de exclusão em lote não disponível na API atual"),console.error("Erro ao excluir logs:",a)}finally{M.value=!1}},ve=async a=>{try{const e=await j.retryWebhook(a.id);e.success&&(alert(e.message),await q(),await Z())}catch(e){console.error("Erro ao tentar webhook novamente:",e)}},fe=async()=>{J.value=!0;try{const a=Object.fromEntries(Object.entries(d).filter(([,de])=>de!==""&&de!==null&&de!==void 0)),e=await j.exportWebhookLogs(me,a,"csv"),l=window.URL.createObjectURL(e),T=document.createElement("a");T.style.display="none",T.href=l,T.download=`webhook-logs-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(T),T.click(),window.URL.revokeObjectURL(l),document.body.removeChild(T)}catch(a){console.error("Erro ao exportar logs:",a)}finally{J.value=!1}},ge=a=>({gitlab:"mdi-gitlab",github:"mdi-github",bitbucket:"mdi-bitbucket"})[a]||"mdi-webhook",re=a=>({processed:"success",failed:"error",pending:"warning",retry:"info"})[a]||"grey",be=a=>({processed:"mdi-check",failed:"mdi-close",pending:"mdi-clock",retry:"mdi-refresh"})[a]||"mdi-help",ye=a=>({processed:"Processado",failed:"Falhou",pending:"Pendente",retry:"Tentando"})[a]||a,ke=a=>a?a<500?"text-success":a<1e3?"text-warning":"text-error":"",$e=a=>a?a.split(" ").map(e=>e[0]).join("").toUpperCase().substring(0,2):"??",ne=a=>{if(!a)return"Data inválida";const e=new Date(a);return isNaN(e.getTime())?"Data inválida":e.toLocaleDateString("pt-BR")},K=a=>{if(a==null)return"N/A";if(typeof a=="string"){const e=new Date(a);return isNaN(e.getTime())?"N/A":e.toLocaleTimeString("pt-BR")}return a<1e3?`${a.toFixed(0)}ms`:`${(a/1e3).toFixed(2)}s`},Me=a=>a===void 0?"0%":`${a.toFixed(1)}%`;let xe;return Ge(d,()=>{clearTimeout(xe),xe=setTimeout(()=>{te()},1e3)},{deep:!0}),Je(()=>{q(),Z()}),(a,e)=>(k(),N("div",rt,[s("div",nt,[e[22]||(e[22]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold text-high-emphasis mb-2"}," Logs de Webhooks "),s("p",{class:"text-body-1 text-grey-darken-1"}," Monitore e gerencie todos os webhooks recebidos pela organização ")],-1)),s("div",dt,[L(m)?S("",!0):(k(),P(h,{key:0,color:"primary",variant:"outlined","prepend-icon":"mdi-download",onClick:fe,loading:J.value},{default:o(()=>[...e[21]||(e[21]=[i(" Exportar ",-1)])]),_:1},8,["loading"])),L(m)?S("",!0):(k(),P(h,{key:1,color:"error",variant:"outlined","prepend-icon":"mdi-delete-sweep",onClick:Ie,disabled:!x.value.length,class:"ml-2"},{default:o(()=>[i(" Excluir Selecionados ("+n(x.value.length)+") ",1)]),_:1},8,["disabled"]))])]),t(st,{type:"info",class:"mb-6"},{default:o(()=>[...e[23]||(e[23]=[s("div",{class:"d-flex align-center"},[s("strong",{class:"mr-2"},"Visualização de Logs:"),i(" Esta página exibe os logs de webhooks recebidos. Algumas funcionalidades como exclusão e retry estão limitadas pela API atual. ")],-1)])]),_:1}),t(ue,{class:"mb-6"},{default:o(()=>[t(E,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(C,null,{default:o(()=>[t(F,null,{default:o(()=>[s("div",ut,[s("div",ct,[e[24]||(e[24]=s("p",{class:"text-body-2 text-medium-emphasis mb-1"},"Total de Logs",-1)),s("h3",mt,n(v.value?.total||0),1)]),t(D,{size:"48",color:"primary",variant:"tonal"},{default:o(()=>[t(c,{size:"24"},{default:o(()=>[...e[25]||(e[25]=[i("mdi-webhook",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),t(E,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(C,null,{default:o(()=>[t(F,null,{default:o(()=>[s("div",pt,[s("div",vt,[e[26]||(e[26]=s("p",{class:"text-body-2 text-medium-emphasis mb-1"},"Taxa de Sucesso",-1)),s("h3",ft,n(Me(v.value?.successRate)),1)]),t(D,{size:"48",color:"success",variant:"tonal"},{default:o(()=>[t(c,{size:"24"},{default:o(()=>[...e[27]||(e[27]=[i("mdi-check-circle",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),t(E,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(C,null,{default:o(()=>[t(F,null,{default:o(()=>[s("div",gt,[s("div",bt,[e[28]||(e[28]=s("p",{class:"text-body-2 text-medium-emphasis mb-1"},"Tempo Médio",-1)),s("h3",yt,n(K(v.value?.avgProcessingTime)),1)]),t(D,{size:"48",color:"info",variant:"tonal"},{default:o(()=>[t(c,{size:"24"},{default:o(()=>[...e[29]||(e[29]=[i("mdi-clock-outline",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),t(E,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(C,null,{default:o(()=>[t(F,null,{default:o(()=>[s("div",kt,[s("div",xt,[e[30]||(e[30]=s("p",{class:"text-body-2 text-medium-emphasis mb-1"},"Falhas",-1)),s("h3",wt,n(v.value?.failed||0),1)]),t(D,{size:"48",color:"error",variant:"tonal"},{default:o(()=>[t(c,{size:"24"},{default:o(()=>[...e[31]||(e[31]=[i("mdi-alert-circle",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),t(C,{class:"mb-6 filter-card"},{default:o(()=>[s("div",_t,[s("div",Tt,[t(oe,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=l=>u.value=l),label:"Buscar nos logs...","prepend-inner-icon":"mdi-magnify",variant:"solo",density:"compact","hide-details":"",clearable:"",style:{"min-width":"280px"},onInput:Oe},null,8,["modelValue"]),ee.value>0?(k(),P(R,{key:0,size:"small",color:"primary",variant:"tonal",class:"ml-2"},{default:o(()=>[i(n(ee.value)+" filtro"+n(ee.value>1?"s":""),1)]),_:1})):S("",!0)]),s("div",ht,[t(Xe,{modelValue:Q.value,"onUpdate:modelValue":[e[1]||(e[1]=l=>Q.value=l),Le],variant:"outlined",color:"primary"},{default:o(()=>[t(R,{value:"processed",size:"small"},{default:o(()=>[t(c,{start:""},{default:o(()=>[...e[32]||(e[32]=[i("mdi-check-circle",-1)])]),_:1}),e[33]||(e[33]=i(" Processados ",-1))]),_:1}),t(R,{value:"failed",size:"small"},{default:o(()=>[t(c,{start:""},{default:o(()=>[...e[34]||(e[34]=[i("mdi-alert-circle",-1)])]),_:1}),e[35]||(e[35]=i(" Falhas ",-1))]),_:1}),t(R,{value:"gitlab",size:"small"},{default:o(()=>[t(c,{start:""},{default:o(()=>[...e[36]||(e[36]=[i("mdi-gitlab",-1)])]),_:1}),e[37]||(e[37]=i(" GitLab ",-1))]),_:1}),t(R,{value:"github",size:"small"},{default:o(()=>[t(c,{start:""},{default:o(()=>[...e[38]||(e[38]=[i("mdi-github",-1)])]),_:1}),e[39]||(e[39]=i(" GitHub ",-1))]),_:1})]),_:1},8,["modelValue"]),t(h,{color:B.value?"primary":"default",variant:B.value?"flat":"outlined",size:"small",onClick:e[2]||(e[2]=l=>B.value=!B.value),class:"ml-1"},{default:o(()=>[t(c,null,{default:o(()=>[i("mdi-filter"+n(B.value?"-check":""),1)]),_:1}),e[40]||(e[40]=i(" Filtros ",-1))]),_:1},8,["color","variant"]),ee.value>0?(k(),P(h,{key:0,variant:"outlined",size:"small",color:"error",onClick:Re,class:"ml-2"},{default:o(()=>[t(c,{start:""},{default:o(()=>[...e[41]||(e[41]=[i("mdi-filter-remove",-1)])]),_:1}),e[42]||(e[42]=i(" Limpar ",-1))]),_:1})):S("",!0)])]),t(et,null,{default:o(()=>[Qe(s("div",Vt,[t(ue,null,{default:o(()=>[t(E,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(X,{modelValue:d.provider,"onUpdate:modelValue":[e[3]||(e[3]=l=>d.provider=l),U],items:L(le),label:"Provedor",clearable:"",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-source-repository","item-title":"title","item-value":"value"},{item:o(({props:l,item:T})=>[t(O,we(_e(l)),{prepend:o(()=>[t(c,{icon:T.raw.icon},null,8,["icon"])]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),t(E,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(X,{modelValue:d.eventType,"onUpdate:modelValue":[e[4]||(e[4]=l=>d.eventType=l),U],items:L(pe),label:"Tipo de Evento",clearable:"",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-webhook","item-title":"title","item-value":"value"},null,8,["modelValue","items"])]),_:1}),t(E,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(X,{modelValue:d.status,"onUpdate:modelValue":[e[5]||(e[5]=l=>d.status=l),U],items:L(Pe),label:"Status",clearable:"",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-check-circle","item-title":"title","item-value":"value"},{item:o(({props:l,item:T})=>[t(O,we(_e(l)),{prepend:o(()=>[t(R,{color:T.raw.color,size:"x-small"},null,8,["color"])]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),t(E,{cols:"12",sm:"6",md:"3"},{default:o(()=>[t(oe,{modelValue:d.actor,"onUpdate:modelValue":[e[6]||(e[6]=l=>d.actor=l),U],label:"Autor",clearable:"",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-account-search"},null,8,["modelValue"])]),_:1}),t(E,{cols:"12",md:"4"},{default:o(()=>[s("div",Ct,[t(c,{color:"medium-emphasis"},{default:o(()=>[...e[43]||(e[43]=[i("mdi-calendar-range",-1)])]),_:1}),e[44]||(e[44]=s("div",{class:"text-caption text-medium-emphasis"},"Período:",-1)),t(oe,{modelValue:d.dateFrom,"onUpdate:modelValue":e[7]||(e[7]=l=>d.dateFrom=l),type:"date",label:"De",variant:"outlined",density:"compact","hide-details":"",onChange:U},null,8,["modelValue"]),t(oe,{modelValue:d.dateTo,"onUpdate:modelValue":e[8]||(e[8]=l=>d.dateTo=l),type:"date",label:"Até",variant:"outlined",density:"compact","hide-details":"",onChange:U},null,8,["modelValue"])])]),_:1}),t(E,{cols:"12",md:"4"},{default:o(()=>[s("div",Dt,[t(X,{modelValue:b.value,"onUpdate:modelValue":[e[9]||(e[9]=l=>b.value=l),U],label:"Ordenar por",items:Se,variant:"outlined",density:"compact","prepend-inner-icon":"mdi-sort"},null,8,["modelValue"]),t(X,{modelValue:Y.value,"onUpdate:modelValue":[e[10]||(e[10]=l=>Y.value=l),U],label:"Ordem",items:Ee,variant:"outlined",density:"compact"},null,8,["modelValue"])])]),_:1}),t(E,{cols:"12",md:"4"},{default:o(()=>[s("div",zt,[L(m)?S("",!0):(k(),P(h,{key:0,variant:"outlined","prepend-icon":"mdi-download",onClick:fe,loading:J.value},{default:o(()=>[...e[45]||(e[45]=[i(" Exportar ",-1)])]),_:1},8,["loading"])),t(h,{color:"primary","prepend-icon":"mdi-refresh",onClick:Fe,loading:w.value},{default:o(()=>[...e[46]||(e[46]=[i(" Atualizar ",-1)])]),_:1},8,["loading"])])]),_:1})]),_:1})],512),[[Ye,B.value]])]),_:1})]),_:1}),t(C,null,{default:o(()=>[w.value?(k(),N("div",Pt,[t(tt,{indeterminate:"",color:"primary",size:"64"}),e[47]||(e[47]=s("div",{class:"mt-4 text-body-1"},"Carregando logs...",-1))])):p.value?(k(),N("div",St,[t(c,{size:"64",color:"error",class:"mb-4"},{default:o(()=>[...e[48]||(e[48]=[i("mdi-alert-circle",-1)])]),_:1}),e[50]||(e[50]=s("div",{class:"text-h6 mb-2"},"Erro ao carregar logs",-1)),s("div",Et,n(p.value),1),L(m)?S("",!0):(k(),P(h,{key:0,color:"primary",onClick:q},{default:o(()=>[...e[49]||(e[49]=[i("Tentar Novamente",-1)])]),_:1}))])):g.value.length?(k(),N("div",Lt,[t(lt,{modelValue:x.value,"onUpdate:modelValue":e[11]||(e[11]=l=>x.value=l),headers:Ae,items:g.value,loading:w.value,"item-value":"id","show-select":!L(m),class:"elevation-0"},{"item.provider":o(({item:l})=>[s("div",Rt,[t(c,{icon:ge(l.provider)},null,8,["icon"]),s("span",Ft,n(l.provider),1)])]),"item.eventType":o(({item:l})=>[t(R,{size:"small",color:"info",variant:"tonal"},{default:o(()=>[i(n(l.eventType),1)]),_:2},1024)]),"item.status":o(({item:l})=>[t(R,{size:"small",color:re(l.status),"prepend-icon":be(l.status)},{default:o(()=>[i(n(ye(l.status)),1)]),_:2},1032,["color","prepend-icon"])]),"item.repositoryFullName":o(({item:l})=>[s("div",Ot,[t(c,{size:"16"},{default:o(()=>[...e[54]||(e[54]=[i("mdi-source-repository",-1)])]),_:1}),s("span",jt,n(l.repositoryFullName),1)])]),"item.actor":o(({item:l})=>[s("div",Ut,[t(D,{size:"24",color:"primary"},{default:o(()=>[s("span",Nt,n($e(l.actor)),1)]),_:2},1024),s("span",It,n(l.actor),1)])]),"item.processingTime":o(({item:l})=>[s("span",{class:Te(ke(l.processingTime))},n(K(l.processingTime)),3)]),"item.createdAt":o(({item:l})=>[s("div",null,[s("div",Wt,n(ne(l.createdAt)),1),s("div",$t,n(K(l.createdAt)),1)])]),"item.actions":o(({item:l})=>[s("div",Mt,[t(h,{size:"small",variant:"text",icon:"mdi-eye",onClick:T=>je(l),title:"Ver Detalhes"},null,8,["onClick"]),l.status==="failed"&&!L(m)?(k(),P(h,{key:0,size:"small",variant:"text",icon:"mdi-refresh",color:"warning",onClick:T=>ve(l),title:"Tentar Novamente"},null,8,["onClick"])):S("",!0),L(m)?S("",!0):(k(),P(h,{key:1,size:"small",variant:"text",icon:"mdi-delete",color:"error",onClick:T=>Ue(l),title:"Excluir"},null,8,["onClick"]))])]),_:2},1032,["modelValue","items","loading","show-select"]),s("div",Bt,[t(at,{modelValue:f.value,"onUpdate:modelValue":[e[12]||(e[12]=l=>f.value=l),q],length:A.value,"total-visible":7},null,8,["modelValue","length"])])])):(k(),N("div",At,[t(c,{size:"64",color:"grey",class:"mb-4"},{default:o(()=>[...e[51]||(e[51]=[i("mdi-webhook",-1)])]),_:1}),e[52]||(e[52]=s("div",{class:"text-h6 mb-2"},"Nenhum log encontrado",-1)),e[53]||(e[53]=s("div",{class:"text-body-2 text-grey-darken-1"}," Não há logs de webhook com os filtros aplicados ",-1))]))]),_:1}),t(ce,{modelValue:V.value,"onUpdate:modelValue":e[16]||(e[16]=l=>V.value=l),"max-width":"1200px",persistent:"",transition:"dialog-bottom-transition",class:"modern-dialog"},{default:o(()=>[r.value?(k(),P(C,{key:0,elevation:"24",class:"dialog-card"},{default:o(()=>[s("div",qt,[s("div",Ht,[s("div",Gt,[t(c,{icon:"mdi-webhook",size:"28",class:"dialog-icon"})]),s("div",Jt,[e[55]||(e[55]=s("h2",{class:"dialog-title"},"Detalhes do Webhook",-1)),s("p",Qt,n(r.value.provider)+" • "+n(r.value.eventType)+" • "+n(ne(r.value.createdAt)),1)])]),t(h,{icon:"mdi-close",variant:"text",size:"40",class:"dialog-close-btn",onClick:e[13]||(e[13]=l=>V.value=!1)})]),s("div",Yt,[t(ue,null,{default:o(()=>[t(E,{cols:"12",md:"8"},{default:o(()=>[t(C,{class:"mb-4"},{default:o(()=>[t(G,{class:"info-card-title"},{default:o(()=>[t(c,{icon:"mdi-information",class:"me-2"}),e[56]||(e[56]=i(" Informações Básicas ",-1))]),_:1}),t(F,null,{default:o(()=>[t(Ce,{lines:"two",class:"info-list"},{default:o(()=>[t(O,null,{prepend:o(()=>[t(D,{color:"primary",size:"40",class:"info-avatar"},{default:o(()=>[t(c,{icon:ge(r.value.provider),color:"white"},null,8,["icon"])]),_:1})]),default:o(()=>[t(I,{class:"info-title"},{default:o(()=>[...e[57]||(e[57]=[i("Provedor",-1)])]),_:1}),t(W,{class:"info-value"},{default:o(()=>[i(n(r.value.provider),1)]),_:1})]),_:1}),t(O,null,{prepend:o(()=>[t(D,{color:"info",size:"40",class:"info-avatar"},{default:o(()=>[t(c,{icon:"mdi-webhook",color:"white"})]),_:1})]),default:o(()=>[t(I,{class:"info-title"},{default:o(()=>[...e[58]||(e[58]=[i("Tipo de Evento",-1)])]),_:1}),t(W,{class:"info-value"},{default:o(()=>[i(n(r.value.eventType),1)]),_:1})]),_:1}),t(O,null,{prepend:o(()=>[t(D,{color:re(r.value.status),size:"40",class:"info-avatar"},{default:o(()=>[t(c,{icon:be(r.value.status),color:"white"},null,8,["icon"])]),_:1},8,["color"])]),default:o(()=>[t(I,{class:"info-title"},{default:o(()=>[...e[59]||(e[59]=[i("Status",-1)])]),_:1}),t(W,{class:"info-value"},{default:o(()=>[t(R,{size:"small",color:re(r.value.status),variant:"tonal"},{default:o(()=>[i(n(ye(r.value.status)),1)]),_:1},8,["color"])]),_:1})]),_:1}),t(O,null,{prepend:o(()=>[t(D,{color:"secondary",size:"40",class:"info-avatar"},{default:o(()=>[t(c,{icon:"mdi-source-repository",color:"white"})]),_:1})]),default:o(()=>[t(I,{class:"info-title"},{default:o(()=>[...e[60]||(e[60]=[i("Repositório",-1)])]),_:1}),t(W,{class:"info-value"},{default:o(()=>[i(n(r.value.repositoryFullName),1)]),_:1})]),_:1}),t(O,null,{prepend:o(()=>[t(D,{color:"success",size:"40",class:"info-avatar"},{default:o(()=>[t(c,{icon:"mdi-account",color:"white"})]),_:1})]),default:o(()=>[t(I,{class:"info-title"},{default:o(()=>[...e[61]||(e[61]=[i("Autor",-1)])]),_:1}),t(W,{class:"info-value"},{default:o(()=>[i(n(r.value.actor),1)]),_:1})]),_:1}),t(O,null,{prepend:o(()=>[t(D,{color:"warning",size:"40",class:"info-avatar"},{default:o(()=>[t(c,{icon:"mdi-clock-outline",color:"white"})]),_:1})]),default:o(()=>[t(I,{class:"info-title"},{default:o(()=>[...e[62]||(e[62]=[i("Tempo de Processamento",-1)])]),_:1}),t(W,{class:"info-value"},{default:o(()=>[i(n(K(r.value.processingTime)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(C,{class:"mb-4"},{default:o(()=>[t(G,{class:"info-card-title"},{default:o(()=>[t(c,{icon:"mdi-cog-outline",class:"me-2"}),e[63]||(e[63]=i(" Resultado do Processamento ",-1))]),_:1}),t(F,null,{default:o(()=>[r.value.processingResult?(k(),N("div",Zt,[t(Ce,{lines:"two",class:"info-list"},{default:o(()=>[t(O,null,{prepend:o(()=>[t(D,{color:r.value.processingResult.success?"success":"error",size:"40",class:"info-avatar"},{default:o(()=>[t(c,{icon:r.value.processingResult.success?"mdi-check-circle":"mdi-alert-circle",color:"white"},null,8,["icon"])]),_:1},8,["color"])]),default:o(()=>[t(I,{class:"info-title"},{default:o(()=>[...e[64]||(e[64]=[i("Status de Processamento",-1)])]),_:1}),t(W,{class:"info-value"},{default:o(()=>[t(R,{size:"small",color:r.value.processingResult.success?"success":"error",variant:"tonal"},{default:o(()=>[i(n(r.value.processingResult.success?"Sucesso":"Falha"),1)]),_:1},8,["color"])]),_:1})]),_:1}),t(O,null,{prepend:o(()=>[t(D,{color:"info",size:"40",class:"info-avatar"},{default:o(()=>[t(c,{icon:"mdi-message-text",color:"white"})]),_:1})]),default:o(()=>[t(I,{class:"info-title"},{default:o(()=>[...e[65]||(e[65]=[i("Mensagem",-1)])]),_:1}),t(W,{class:"info-value"},{default:o(()=>[i(n(r.value.processingResult.message),1)]),_:1})]),_:1}),r.value.processingResult.triggeredActions?.length?(k(),P(O,{key:0},{prepend:o(()=>[t(D,{color:"primary",size:"40",class:"info-avatar"},{default:o(()=>[t(c,{icon:"mdi-play-circle",color:"white"})]),_:1})]),default:o(()=>[t(I,{class:"info-title"},{default:o(()=>[...e[66]||(e[66]=[i("Ações Executadas",-1)])]),_:1}),t(W,{class:"info-value"},{default:o(()=>[s("div",Kt,[(k(!0),N(Ze,null,Ke(r.value.processingResult.triggeredActions,l=>(k(),P(R,{key:l,size:"small",color:"info",variant:"tonal",class:"me-2 mb-2"},{default:o(()=>[t(c,{start:"",size:"16"},{default:o(()=>[...e[67]||(e[67]=[i("mdi-play",-1)])]),_:1}),i(" "+n(l),1)]),_:2},1024))),128))])]),_:1})]),_:1})):S("",!0)]),_:1})])):(k(),N("div",Xt,[t(c,{icon:"mdi-information-outline",size:"48",class:"mb-2"}),e[68]||(e[68]=s("div",{class:"text-body-2"},"Nenhum resultado de processamento disponível",-1))]))]),_:1})]),_:1}),t(C,{class:"mb-4"},{default:o(()=>[t(G,{class:"info-card-title"},{default:o(()=>[t(c,{icon:"mdi-code-braces",class:"me-2"}),e[69]||(e[69]=i(" Headers HTTP ",-1))]),_:1}),t(F,null,{default:o(()=>[s("div",eo,[s("pre",to,n(JSON.stringify(r.value.headers,null,2)),1)])]),_:1})]),_:1}),r.value.payload?(k(),P(C,{key:0,class:"mb-4"},{default:o(()=>[t(G,{class:"info-card-title"},{default:o(()=>[t(c,{icon:"mdi-code-json",class:"me-2"}),e[70]||(e[70]=i(" Payload ",-1))]),_:1}),t(F,null,{default:o(()=>[s("div",oo,[s("pre",so,n(JSON.stringify(r.value.payload,null,2)),1)])]),_:1})]),_:1})):S("",!0)]),_:1}),t(E,{cols:"12",md:"4",class:"sidebar-column"},{default:o(()=>[t(C,{class:"sticky-card"},{default:o(()=>[t(G,{class:"info-card-title"},{default:o(()=>[t(c,{icon:"mdi-chart-line",class:"me-2"}),e[71]||(e[71]=i(" Métricas ",-1))]),_:1}),t(F,null,{default:o(()=>[s("div",lo,[e[72]||(e[72]=s("strong",null,"ID do Log:",-1)),s("code",ao,n(r.value.id),1)]),s("div",io,[e[73]||(e[73]=s("strong",null,"IP de Origem:",-1)),s("div",ro,n(r.value.sourceIp),1)]),s("div",no,[e[74]||(e[74]=s("strong",null,"Data/Hora:",-1)),s("div",uo,n(ne(r.value.createdAt)),1),s("div",co,n(K(r.value.createdAt)),1)]),s("div",mo,[e[75]||(e[75]=s("strong",null,"Tempo de Resposta:",-1)),s("div",{class:Te(["text-body-2 mt-1",ke(r.value.processingTime)])},n(K(r.value.processingTime)),3)]),r.value.retryCount!==void 0?(k(),N("div",po,[e[76]||(e[76]=s("strong",null,"Tentativas:",-1)),s("div",vo,n(r.value.retryCount||0)+" tentativa"+n((r.value.retryCount||0)!==1?"s":""),1)])):S("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),s("div",fo,[s("div",go,[t(h,{variant:"outlined",size:"large",class:"action-btn cancel-btn",onClick:e[14]||(e[14]=l=>V.value=!1)},{default:o(()=>[...e[77]||(e[77]=[i(" Fechar ",-1)])]),_:1}),r.value.status==="failed"&&!L(m)?(k(),P(h,{key:0,color:"warning",variant:"elevated",size:"large",class:"action-btn primary-btn",onClick:e[15]||(e[15]=l=>{ve(r.value),V.value=!1})},{default:o(()=>[t(c,{start:""},{default:o(()=>[...e[78]||(e[78]=[i("mdi-refresh",-1)])]),_:1}),e[79]||(e[79]=i(" Tentar Novamente ",-1))]),_:1})):S("",!0)])])]),_:1})):S("",!0)]),_:1},8,["modelValue"]),t(ce,{modelValue:z.value,"onUpdate:modelValue":e[18]||(e[18]=l=>z.value=l),"max-width":"400"},{default:o(()=>[t(C,null,{default:o(()=>[t(G,null,{default:o(()=>[...e[80]||(e[80]=[i("Confirmar Exclusão",-1)])]),_:1}),t(F,null,{default:o(()=>[...e[81]||(e[81]=[i(" Tem certeza que deseja excluir este log de webhook? Esta ação não pode ser desfeita. ",-1)])]),_:1}),t(Ve,null,{default:o(()=>[t(De),t(h,{onClick:e[17]||(e[17]=l=>z.value=!1)},{default:o(()=>[...e[82]||(e[82]=[i("Cancelar",-1)])]),_:1}),t(h,{color:"error",onClick:Ne,loading:M.value},{default:o(()=>[...e[83]||(e[83]=[i("Excluir",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(ce,{modelValue:y.value,"onUpdate:modelValue":e[20]||(e[20]=l=>y.value=l),"max-width":"400"},{default:o(()=>[t(C,null,{default:o(()=>[t(G,null,{default:o(()=>[...e[84]||(e[84]=[i("Confirmar Exclusão em Lote",-1)])]),_:1}),t(F,null,{default:o(()=>[i(" Tem certeza que deseja excluir "+n(x.value.length)+" logs selecionados? Esta ação não pode ser desfeita. ",1)]),_:1}),t(Ve,null,{default:o(()=>[t(De),t(h,{onClick:e[19]||(e[19]=l=>y.value=!1)},{default:o(()=>[...e[85]||(e[85]=[i("Cancelar",-1)])]),_:1}),t(h,{color:"error",onClick:We,loading:M.value},{default:o(()=>[i(" Excluir "+n(x.value.length)+" logs ",1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),Mo=ot(bo,[["__scopeId","data-v-79e29b81"]]);export{Mo as default};
