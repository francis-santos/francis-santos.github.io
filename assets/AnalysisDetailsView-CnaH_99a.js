import{k as J,af as K,a6 as X,f as S,j as k,E as Y,_ as d,z as a,$ as g,a0 as m,q as l,a1 as t,a8 as o,W as i,F as R,ae as A,a2 as n}from"./vendor-vue-BOgiBTV5.js";import{d as Z}from"./dashboard.service-C1ebBwgX.js";import{_ as $,b as ss,c as z,a as c}from"./index-Fi5SlckD.js";import{V as B}from"./VAlert-CGm6uEMH.js";import{a as p,V as P}from"./VRow-i_tVuNAF.js";import{V as v,a as x,b as _}from"./VGrid-BenhMHcZ.js";import{V as h}from"./VChip-CnfVI7ta.js";import{V as es,a as ts,b as as,c as ls}from"./VExpansionPanels-Bf7sDZhx.js";import"./auth-Dt5LZyuD.js";import"./vendor-utils-C9OYYH06.js";import"./token-storage.service-BqAv9k07.js";import"./vendor-ui-BR0KSDoQ.js";import"./index-DzEvJ-T3.js";const is=J({__name:"AnalysisDetailsView",setup(E,{expose:s}){s();const V=K(),e=X(),f=S(null),C=S(!1),u=S(null),y=k(()=>V.params.id),D=k(()=>{if(!f.value)return"grey";switch(f.value.status){case"completed":return"success";case"processing":return"warning";case"pending":return"info";case"failed":return"error";default:return"grey"}}),I=k(()=>{if(!f.value)return"";switch(f.value.status){case"completed":return"Completa";case"processing":return"Processando";case"pending":return"Pendente";case"failed":return"Falhou";default:return f.value.status}}),N=k(()=>{if(!f.value?.qualityScore)return"grey";const r=f.value.qualityScore;return r>=8?"success":r>=6?"warning":"error"}),U=k(()=>{if(!f.value?.analysisResults?.issues)return{};const r={};return f.value.analysisResults.issues.forEach(w=>{const b=w.type||"Outros";r[b]=(r[b]||0)+1}),r}),F=k(()=>{if(!f.value?.analysisResults?.issues)return{};const r={};return f.value.analysisResults.issues.forEach(w=>{const b=w.severity||"low";r[b]=(r[b]||0)+1}),r});async function T(){C.value=!0,u.value=null;try{f.value=await Z.getAnalysisById(y.value)}catch(r){u.value=r instanceof Error?r.message:"Erro ao carregar análise",console.error("Error loading analysis details:",r)}finally{C.value=!1}}function M(r){return new Date(r).toLocaleString("pt-BR")}function L(r){switch(r.toLowerCase()){case"high":return"error";case"medium":return"warning";case"low":return"info";default:return"grey"}}function j(r){switch(r.toLowerCase()){case"high":return"Alta";case"medium":return"Média";case"low":return"Baixa";default:return r}}function O(r){if(!r)return"N/A";if(r<1e3)return`${r}ms`;if(r<6e4)return`${(r/1e3).toFixed(1)}s`;{const w=Math.floor(r/6e4),b=Math.floor(r%6e4/1e3);return`${w}m ${b}s`}}function Q(){e.push("/analyses")}function W(r){switch(r){case"github":return"mdi-github";case"gitlab":return"mdi-gitlab";case"bitbucket":return"mdi-bitbucket";default:return"mdi-git"}}function G(r){switch(r){case"github":return"#333333";case"gitlab":return"#FC6D26";case"bitbucket":return"#0052CC";default:return"grey"}}function H(r){switch(r){case"github":return"Pull Request";case"gitlab":return"Merge Request";case"bitbucket":return"Pull Request";default:return"Pull/Merge Request"}}Y(()=>{T()});const q={route:V,router:e,analysis:f,loading:C,error:u,analysisId:y,statusColor:D,statusText:I,qualityScoreColor:N,issuesByType:U,issuesBySeverity:F,loadAnalysisDetails:T,formatDate:M,getSeverityColor:L,getSeverityText:j,formatProcessingTime:O,goBack:Q,getPlatformIcon:W,getPlatformColor:G,getPullRequestLabel:H};return Object.defineProperty(q,"__isScriptSetup",{enumerable:!1,value:!0}),q}}),os={class:"analysis-details-page"},ns={class:"d-flex align-center mb-6"},rs={key:0,class:"text-center py-12"},ds={key:2,class:"analysis-details"},us={class:"mb-3"},cs={class:"text-body-1 font-weight-medium"},ms={class:"mb-3"},fs={class:"mb-3"},ys={class:"text-caption bg-surface-variant pa-1 rounded"},gs={key:0,class:"mb-3"},vs={class:"text-caption text-medium-emphasis"},xs={class:"d-flex align-center"},_s=["href"],ps={class:"font-weight-medium"},bs={key:0,class:"text-body-2 ml-2"},hs={key:0,class:"text-caption text-medium-emphasis mt-1"},ks={key:1,class:"mb-3"},ws={class:"d-flex align-center"},Rs=["href"],As={class:"mb-3"},Cs={class:"mb-3"},Ps={class:"text-body-2"},Vs={key:0,class:"mb-3"},Ss={class:"text-body-2"},Ts={key:1,class:"mb-3"},qs={class:"d-flex align-center"},zs={class:"text-body-2 font-weight-medium"},Bs={key:0,class:"mb-4"},Es={class:"text-body-2"},Ds={class:"d-flex align-center"},Is={key:1},Ns={class:"mb-4"},Us={class:"d-flex align-center"},Fs={class:"text-h6 font-weight-bold"},Ms={key:0,class:"mb-4"},Ls={class:"d-flex align-center"},js={class:"text-h6 font-weight-bold"},Os={key:1,class:"mb-4"},Qs={class:"d-flex align-center"},Ws={class:"text-body-2 font-weight-medium"},Gs={key:2},Hs={class:"mb-2"},Js={class:"text-body-2 font-weight-medium"},Ks={class:"text-body-2 font-weight-medium"},Xs={key:0},Ys={key:1,class:"text-body-2 text-grey-darken-1"},Zs={key:0},$s={class:"d-flex flex-wrap"},se={class:"mt-3"},ee={class:"text-caption text-grey-darken-1"},te={key:1,class:"text-body-2 text-grey-darken-1"},ae={class:"text-body-2"},le={class:"text-body-2"},ie={class:"d-flex align-center justify-space-between w-100"},oe={class:"d-flex align-center"},ne={class:"text-body-2"},re={class:"text-caption text-grey-darken-1"},de={class:"mb-3"},ue={class:"text-caption bg-grey-lighten-4 text-grey-darken-1 rounded d-block pl-2"},ce={class:"mb-3"},me={class:"text-body-2"},fe={key:0,class:"mb-3"},ye={class:"text-body-2"},ge={class:"text-body-1"},ve={key:0,class:"mt-3"},xe={class:"text-caption bg-surface-variant pa-2 rounded d-block mt-1"};function _e(E,s,V,e,f,C){return n(),d("div",os,[a("div",ns,[l(ss,{icon:"mdi-arrow-left",variant:"text",onClick:e.goBack,class:"me-3"}),s[0]||(s[0]=a("div",null,[a("h1",{class:"text-h4 font-weight-bold text-high-emphasis mb-1"}," Detalhes da Análise "),a("p",{class:"text-body-1 text-medium-emphasis"}," Informações completas sobre a análise ")],-1))]),e.loading?(n(),d("div",rs,[l(z,{indeterminate:"",color:"primary",size:"64"}),s[1]||(s[1]=a("p",{class:"text-body-1 text-medium-emphasis mt-4"}," Carregando detalhes da análise... ",-1))])):e.error?(n(),g(B,{key:1,type:"error",variant:"tonal",class:"mb-4"},{default:t(()=>[o(i(e.error),1)]),_:1})):e.analysis?(n(),d("div",ds,[l(P,{class:"mb-6"},{default:t(()=>[l(p,{cols:"12",md:"8"},{default:t(()=>[l(v,{elevation:"2"},{default:t(()=>[l(x,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"me-2"},{default:t(()=>[...s[2]||(s[2]=[o("mdi-clipboard-text",-1)])]),_:1}),s[3]||(s[3]=o(" Informações Básicas ",-1))]),_:1}),l(_,null,{default:t(()=>[l(P,null,{default:t(()=>[l(p,{cols:"12",sm:"6"},{default:t(()=>[a("div",us,[s[4]||(s[4]=a("div",{class:"text-caption text-medium-emphasis"},"Repositório",-1)),a("div",cs,i(e.analysis.repositoryName),1)]),a("div",ms,[s[5]||(s[5]=a("div",{class:"text-caption text-medium-emphasis"},"Branch",-1)),l(h,{size:"small",variant:"tonal",color:"primary"},{default:t(()=>[o(i(e.analysis.branchName),1)]),_:1})]),a("div",fs,[s[6]||(s[6]=a("div",{class:"text-caption text-medium-emphasis"},"Commit",-1)),a("code",ys,i(e.analysis.commitSha),1)]),e.analysis.pullRequestUrl?(n(),d("div",gs,[a("div",vs,i(e.getPullRequestLabel(e.analysis.gitPlatform)),1),a("div",xs,[l(c,{color:e.getPlatformColor(e.analysis.gitPlatform),size:"small",class:"me-2"},{default:t(()=>[o(i(e.getPlatformIcon(e.analysis.gitPlatform)),1)]),_:1},8,["color"]),a("a",{href:e.analysis.pullRequestUrl,target:"_blank",rel:"noopener noreferrer",class:"text-primary text-decoration-none"},[a("span",ps," #"+i(e.analysis.pullRequestId),1),e.analysis.pullRequestTitle?(n(),d("span",bs," - "+i(e.analysis.pullRequestTitle),1)):m("",!0)],8,_s),l(c,{size:"small",class:"ml-1",color:"grey"},{default:t(()=>[...s[7]||(s[7]=[o("mdi-open-in-new",-1)])]),_:1})]),e.analysis.pullRequestAuthor?(n(),d("div",hs," por "+i(e.analysis.pullRequestAuthor),1)):m("",!0)])):m("",!0),e.analysis.repositoryUrl?(n(),d("div",ks,[s[9]||(s[9]=a("div",{class:"text-caption text-medium-emphasis"},"Repositório",-1)),a("div",ws,[l(c,{color:e.getPlatformColor(e.analysis.gitPlatform),size:"small",class:"me-2"},{default:t(()=>[o(i(e.getPlatformIcon(e.analysis.gitPlatform)),1)]),_:1},8,["color"]),a("a",{href:e.analysis.repositoryUrl,target:"_blank",rel:"noopener noreferrer",class:"text-primary text-decoration-none"},i(e.analysis.repositoryName),9,Rs),l(c,{size:"small",class:"ml-1",color:"grey"},{default:t(()=>[...s[8]||(s[8]=[o("mdi-open-in-new",-1)])]),_:1})])])):m("",!0)]),_:1}),l(p,{cols:"12",sm:"6"},{default:t(()=>[a("div",As,[s[10]||(s[10]=a("div",{class:"text-caption text-medium-emphasis"},"Status",-1)),l(h,{color:e.statusColor,size:"small",variant:"tonal"},{default:t(()=>[o(i(e.statusText),1)]),_:1},8,["color"])]),a("div",Cs,[s[11]||(s[11]=a("div",{class:"text-caption text-medium-emphasis"},"Criado em",-1)),a("div",Ps,i(e.formatDate(e.analysis.createdAt)),1)]),e.analysis.completedAt?(n(),d("div",Vs,[s[12]||(s[12]=a("div",{class:"text-caption text-medium-emphasis"},"Concluído em",-1)),a("div",Ss,i(e.formatDate(e.analysis.completedAt)),1)])):m("",!0),e.analysis.processingTimeMs&&e.analysis.status==="completed"?(n(),d("div",Ts,[s[14]||(s[14]=a("div",{class:"text-caption text-medium-emphasis"},"Tempo de Processamento",-1)),a("div",qs,[l(c,{class:"me-2",color:"info",size:"small"},{default:t(()=>[...s[13]||(s[13]=[o("mdi-timer-outline",-1)])]),_:1}),a("span",zs,i(e.formatProcessingTime(e.analysis.processingTimeMs)),1)])])):m("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"4"},{default:t(()=>[l(v,{elevation:"2"},{default:t(()=>[l(x,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"me-2"},{default:t(()=>[...s[15]||(s[15]=[o("mdi-chart-line",-1)])]),_:1}),s[16]||(s[16]=o(" Métricas ",-1))]),_:1}),l(_,null,{default:t(()=>[e.analysis.status==="failed"?(n(),d("div",Bs,[s[19]||(s[19]=a("div",{class:"text-caption text-grey-darken-1"},"Erro na Análise",-1)),l(B,{type:"error",variant:"tonal",density:"compact",class:"mb-3"},{default:t(()=>[a("div",Es,i(e.analysis.errorMessage||"A análise falhou durante o processamento."),1)]),_:1}),a("div",Ds,[l(c,{class:"me-2",color:"error"},{default:t(()=>[...s[17]||(s[17]=[o("mdi-alert-circle",-1)])]),_:1}),s[18]||(s[18]=a("span",{class:"text-body-2 text-grey-darken-1"},"Análise não foi concluída",-1))])])):(n(),d("div",Is,[a("div",Ns,[s[20]||(s[20]=a("div",{class:"text-caption text-medium-emphasis"},"Issues Encontradas",-1)),a("div",Us,[l(c,{class:"me-2",color:e.analysis.issuesFound>0?"warning":"success"},{default:t(()=>[o(i(e.analysis.issuesFound>0?"mdi-alert":"mdi-check-circle"),1)]),_:1},8,["color"]),a("span",Fs,i(e.analysis.issuesFound),1)])]),e.analysis.qualityScore?(n(),d("div",Ms,[s[21]||(s[21]=a("div",{class:"text-caption text-medium-emphasis"},"Score de Qualidade",-1)),a("div",Ls,[l(z,{"model-value":e.analysis.qualityScore*10,color:e.qualityScoreColor,size:"40",width:"4",class:"me-3"},null,8,["model-value","color"]),a("span",js,i(e.analysis.qualityScore.toFixed(1)),1)])])):m("",!0),e.analysis.processingTimeMs?(n(),d("div",Os,[s[23]||(s[23]=a("div",{class:"text-caption text-medium-emphasis"},"Tempo de Processamento",-1)),a("div",Qs,[l(c,{class:"me-2",color:"info",size:"small"},{default:t(()=>[...s[22]||(s[22]=[o("mdi-clock-outline",-1)])]),_:1}),a("span",Ws,i(e.formatProcessingTime(e.analysis.processingTimeMs)),1)])])):m("",!0),e.analysis.analysisResults?.metrics?(n(),d("div",Gs,[a("div",Hs,[s[24]||(s[24]=a("div",{class:"text-caption text-medium-emphasis"},"Linhas de Código",-1)),a("div",Js,i(e.analysis.analysisResults.metrics.linesOfCode?.toLocaleString()||"N/A"),1)]),a("div",null,[s[25]||(s[25]=a("div",{class:"text-caption text-medium-emphasis"},"Arquivos Analisados",-1)),a("div",Ks,i(e.analysis.analysisResults.metrics.filesAnalyzed||"N/A"),1)])])):m("",!0)]))]),_:1})]),_:1})]),_:1})]),_:1}),e.analysis.status==="completed"&&(e.analysis.specialistsUsed&&e.analysis.specialistsUsed.length>0||e.analysis.rulesApplied&&e.analysis.rulesApplied.length>0)?(n(),g(P,{key:0,class:"mb-6"},{default:t(()=>[l(p,{cols:"12",md:"6"},{default:t(()=>[l(v,{elevation:"2"},{default:t(()=>[l(x,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"me-2"},{default:t(()=>[...s[26]||(s[26]=[o("mdi-account-multiple",-1)])]),_:1}),s[27]||(s[27]=o(" Especialistas Utilizados ",-1))]),_:1}),l(_,null,{default:t(()=>[e.analysis.specialistsUsed&&e.analysis.specialistsUsed.length>0?(n(),d("div",Xs,[(n(!0),d(R,null,A(e.analysis.specialistsUsed,u=>(n(),g(h,{key:u,size:"small",variant:"tonal",color:"primary",class:"me-2 mb-2"},{default:t(()=>[l(c,{start:"",size:"16"},{default:t(()=>[...s[28]||(s[28]=[o("mdi-account-star",-1)])]),_:1}),o(" "+i(u),1)]),_:2},1024))),128))])):(n(),d("div",Ys,[l(c,{class:"me-2",size:"20",color:"grey"},{default:t(()=>[...s[29]||(s[29]=[o("mdi-account-off",-1)])]),_:1}),s[30]||(s[30]=o(" Nenhum especialista específico foi utilizado ",-1))]))]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"6"},{default:t(()=>[l(v,{elevation:"2"},{default:t(()=>[l(x,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"me-2"},{default:t(()=>[...s[31]||(s[31]=[o("mdi-shield-check",-1)])]),_:1}),s[32]||(s[32]=o(" Regras Utilizadas ",-1))]),_:1}),l(_,null,{default:t(()=>[e.analysis.rulesApplied&&e.analysis.rulesApplied.length>0?(n(),d("div",Zs,[a("div",$s,[(n(!0),d(R,null,A(e.analysis.rulesApplied,u=>(n(),g(h,{key:u,size:"small",variant:"tonal",color:"success",class:"me-2 mb-2"},{default:t(()=>[l(c,{start:"",size:"16"},{default:t(()=>[...s[33]||(s[33]=[o("mdi-check-circle",-1)])]),_:1}),o(" "+i(u),1)]),_:2},1024))),128))]),a("div",se,[a("div",ee," Total: "+i(e.analysis.rulesApplied.length)+" regra"+i(e.analysis.rulesApplied.length!==1?"s":"")+" aplicada"+i(e.analysis.rulesApplied.length!==1?"s":""),1)])])):(n(),d("div",te,[l(c,{class:"me-2",size:"20",color:"grey"},{default:t(()=>[...s[34]||(s[34]=[o("mdi-shield-off",-1)])]),_:1}),s[35]||(s[35]=o(" Nenhuma regra específica foi aplicada ",-1))]))]),_:1})]),_:1})]),_:1})]),_:1})):m("",!0),e.analysis.status==="completed"&&e.analysis.analysisResults?.issues&&e.analysis.analysisResults.issues.length>0?(n(),g(P,{key:1,class:"mb-6"},{default:t(()=>[l(p,{cols:"12",md:"6"},{default:t(()=>[l(v,{elevation:"2"},{default:t(()=>[l(x,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"me-2"},{default:t(()=>[...s[36]||(s[36]=[o("mdi-chart-pie",-1)])]),_:1}),s[37]||(s[37]=o(" Issues por Tipo ",-1))]),_:1}),l(_,null,{default:t(()=>[(n(!0),d(R,null,A(e.issuesByType,(u,y)=>(n(),d("div",{key:y,class:"d-flex align-center justify-space-between mb-2"},[a("span",ae,i(y),1),l(h,{size:"small",variant:"tonal",color:"primary"},{default:t(()=>[o(i(u),1)]),_:2},1024)]))),128))]),_:1})]),_:1})]),_:1}),l(p,{cols:"12",md:"6"},{default:t(()=>[l(v,{elevation:"2"},{default:t(()=>[l(x,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"me-2"},{default:t(()=>[...s[38]||(s[38]=[o("mdi-alert-octagon",-1)])]),_:1}),s[39]||(s[39]=o(" Issues por Severidade ",-1))]),_:1}),l(_,null,{default:t(()=>[(n(!0),d(R,null,A(e.issuesBySeverity,(u,y)=>(n(),d("div",{key:y,class:"d-flex align-center justify-space-between mb-2"},[a("span",le,i(e.getSeverityText(y)),1),l(h,{size:"small",variant:"tonal",color:e.getSeverityColor(y)},{default:t(()=>[o(i(u),1)]),_:2},1032,["color"])]))),128))]),_:1})]),_:1})]),_:1})]),_:1})):m("",!0),e.analysis.status==="completed"&&e.analysis.analysisResults?.issues&&e.analysis.analysisResults.issues.length>0?(n(),g(v,{key:2,elevation:"2"},{default:t(()=>[l(x,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"me-2"},{default:t(()=>[...s[40]||(s[40]=[o("mdi-bug",-1)])]),_:1}),o(" Issues Encontradas ("+i(e.analysis.analysisResults.issues.length)+") ",1)]),_:1}),l(_,null,{default:t(()=>[l(es,null,{default:t(()=>[(n(!0),d(R,null,A(e.analysis.analysisResults.issues,(u,y)=>(n(),g(ts,{key:y},{default:t(()=>[l(as,null,{default:t(()=>[a("div",ie,[a("div",oe,[l(h,{size:"x-small",variant:"tonal",color:e.getSeverityColor(u.severity),class:"me-2"},{default:t(()=>[o(i(e.getSeverityText(u.severity)),1)]),_:2},1032,["color"]),a("span",ne,i(u.message),1)]),a("div",re,i(u.file)+":"+i(u.line),1)])]),_:2},1024),l(ls,null,{default:t(()=>[a("div",de,[s[41]||(s[41]=a("div",{class:"text-caption text-medium-emphasis"},"Arquivo",-1)),a("code",ue,i(u.file)+":"+i(u.line),1)]),a("div",ce,[s[42]||(s[42]=a("div",{class:"text-caption text-medium-emphasis"},"Tipo",-1)),a("div",me,i(u.type),1)]),u.suggestion?(n(),d("div",fe,[s[43]||(s[43]=a("div",{class:"text-caption text-medium-emphasis"},"Sugestão",-1)),a("div",ye,i(u.suggestion),1)])):m("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})):m("",!0),e.analysis.status==="completed"&&e.analysis.analysisResults?.summary?(n(),g(v,{key:3,elevation:"2",class:"mt-6"},{default:t(()=>[l(x,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"me-2"},{default:t(()=>[...s[44]||(s[44]=[o("mdi-text-box",-1)])]),_:1}),s[45]||(s[45]=o(" Resumo da Análise ",-1))]),_:1}),l(_,null,{default:t(()=>[a("p",ge,i(e.analysis.analysisResults.summary),1)]),_:1})]),_:1})):m("",!0),e.analysis.status==="failed"?(n(),g(v,{key:4,elevation:"2",class:"mt-6"},{default:t(()=>[l(x,{class:"d-flex align-center"},{default:t(()=>[l(c,{class:"me-2",color:"error"},{default:t(()=>[...s[46]||(s[46]=[o("mdi-alert-circle",-1)])]),_:1}),s[47]||(s[47]=o(" Análise Falhada ",-1))]),_:1}),l(_,null,{default:t(()=>[s[49]||(s[49]=a("p",{class:"text-body-1 text-grey-darken-1"}," A análise não pôde ser concluída devido a um erro durante o processamento. Verifique os logs ou tente executar a análise novamente. ",-1)),e.analysis.errorMessage?(n(),d("div",ve,[s[48]||(s[48]=a("div",{class:"text-caption text-medium-emphasis"},"Detalhes do erro:",-1)),a("code",xe,i(e.analysis.errorMessage),1)])):m("",!0)]),_:1})]),_:1})):m("",!0)])):m("",!0)])}const ze=$(is,[["render",_e],["__scopeId","data-v-5be12ca1"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/analyses/AnalysisDetailsView.vue"]]);export{ze as default};
