import{k as Le,f as x,r as Pe,w as Se,E as Ce,_ as O,z as a,q as o,$ as R,a0 as F,a1 as l,a8 as i,W as d,ag as re,ah as ie,v as Ee,F as Oe,ae as Re,a2 as y}from"./vendor-vue-BOgiBTV5.js";import{b as U}from"./auth-Dt5LZyuD.js";import{u as K,V as M}from"./VChip-rM5LjFon.js";import{tokenStorage as ne}from"./token-storage.service-BqAv9k07.js";import{_ as je,b as w,a as S,c as ze}from"./index-CPKBv9AR.js";import{V as Ae}from"./VAlert-qYEn-PTR.js";import{a as T,V as Z}from"./VRow-xKwg0MSP.js";import{V as _,b as D,e as q,a as W,c as $}from"./VGrid-BsndwDIl.js";import{V as ee}from"./VSelect-BBg-Hfm2.js";import{b as de,e as Fe}from"./VList-BKPY6TWC.js";import{V as te}from"./VTextField-DiiVGj7F.js";import{V as Ue}from"./VDataTable-CI-izd_C.js";import{V as We}from"./VPagination-BAn_hqPp.js";import{V as oe}from"./VSpacer-CBt-5M7F.js";import{V as le}from"./VDialog-CkQu3sn-.js";import"./vendor-utils-C9OYYH06.js";import"./index-DzEvJ-T3.js";import"./vendor-ui-BR0KSDoQ.js";import"./autofocus-DZuUxpyU.js";import"./VMenu-vHpHdbAo.js";import"./dialog-transition-BRPqoOP4.js";import"./ssrBoot-Cswv876e.js";import"./VTable-C8WajvOs.js";import"./filter-BU9fsv7R.js";class Ne{async getWebhookLogs(e,m={},t=1,v=20){const{isDemoUser:u,getMockData:s,simulateApiDelay:f}=K();if(u.value){await f();const k=await s("webhooks",t,v,m),V=Math.ceil(k.total/v);return{...k,totalPages:V,hasNext:t<V,hasPrevious:t>1}}const h=new URLSearchParams({organizationId:e,page:t.toString(),limit:v.toString(),...Object.fromEntries(Object.entries(m).filter(([,k])=>k!==void 0&&k!==""))});return await U.get(`/webhooks/logs?${h}`)}async getWebhookLogDetails(e){const{isDemoUser:m,getMockItem:t,simulateApiDelay:v}=K();if(m.value){await v();const u=t("webhooks",e);if(!u)throw new Error("Webhook não encontrado");return u}return await U.get(`/webhooks/logs/${e}`)}async getWebhookLogStats(e,m={}){const{isDemoUser:t,simulateApiDelay:v}=K();if(t.value)return await v(),{total:156,processed:132,failed:8,pending:12,ignored:4,processingRate:84.6,errorRate:5.1,averageProcessingTime:2.3,topEventTypes:[{eventType:"push",count:78},{eventType:"pull_request",count:34},{eventType:"issue",count:22},{eventType:"merge_request",count:18},{eventType:"release",count:4}],topRepositories:[{repository:"demo/projeto-frontend-react",count:45},{repository:"demo/api-backend-node",count:38},{repository:"demo/mobile-app-flutter",count:29},{repository:"demo/infrastructure-terraform",count:24},{repository:"demo/documentation-site",count:20}]};const u=new URLSearchParams({organizationId:e,...Object.fromEntries(Object.entries(m).filter(([,p])=>p!==void 0&&p!==""))}),s=await U.get(`/webhooks/logs/stats?${u}`),f=Object.entries(s.byEventType).map(([p,b])=>({eventType:p,count:b})).sort((p,b)=>b.count-p.count).slice(0,5),h=Object.entries(s.byProvider).map(([p,b])=>({provider:p,count:b})).sort((p,b)=>b.count-p.count),k=new Date,V=[];for(let p=6;p>=0;p--){const b=new Date(k);b.setDate(b.getDate()-p);const N=b.toISOString().split("T")[0];V.push({date:N||"",count:Math.floor(Math.random()*10)})}return{total:s.total,processed:s.processed,failed:s.failed,pending:s.pending,retry:0,avgProcessingTime:s.averageProcessingTime,successRate:s.successRate,errorRate:100-s.successRate,topEventTypes:f,topProviders:h,recentActivity:V}}calculateStats(e){const{data:m,total:t}=e,v=m.filter(n=>n.status==="processed").length,u=m.filter(n=>n.status==="failed").length,s=m.filter(n=>n.status==="pending").length,f=m.filter(n=>n.status==="retry").length,h=m.filter(n=>n.processingTime!==null).map(n=>n.processingTime),k=h.length>0?h.reduce((n,g)=>n+g,0)/h.length:0,V=t>0?v/t*100:0,p=t>0?u/t*100:0,b=m.reduce((n,g)=>(n[g.eventType]=(n[g.eventType]||0)+1,n),{}),N=Object.entries(b).map(([n,g])=>({eventType:n,count:g})).sort((n,g)=>g.count-n.count).slice(0,5),j=m.reduce((n,g)=>(n[g.provider]=(n[g.provider]||0)+1,n),{}),B=Object.entries(j).map(([n,g])=>({provider:n,count:g})).sort((n,g)=>g.count-n.count),z=new Date,L=[];for(let n=6;n>=0;n--){const g=new Date(z);g.setDate(g.getDate()-n);const H=g.toISOString().split("T")[0],Q=m.filter(E=>new Date(E.createdAt).toISOString().split("T")[0]===H).length;L.push({date:H||"",count:Q})}return{total:t,processed:v,failed:u,pending:s,retry:f,avgProcessingTime:k,successRate:V,errorRate:p,topEventTypes:N,topProviders:B,recentActivity:L}}async retryWebhook(e){return await U.post(`/webhooks/logs/${e}/retry`)}async deleteWebhookLog(e){await U.delete(`/webhooks/logs/${e}`)}async bulkDeleteWebhookLogs(e){await U.post("/webhooks/logs/bulk-delete",{logIds:e})}async exportWebhookLogs(e,m={},t="csv"){const v=new URLSearchParams({organizationId:e,format:t,...Object.fromEntries(Object.entries(m).filter(([,h])=>h!==void 0&&h!==""))}),u={Accept:t==="csv"?"text/csv":"application/json"},s=ne.getAccessToken();s&&!ne.isTokenExpired()&&(u.Authorization=`Bearer ${s}`);const f=await fetch(`${U.getBaseURL()}/webhooks/logs/export?${v}`,{method:"GET",headers:u});if(!f.ok)throw new Error("Erro ao exportar dados");return await f.blob()}convertToCSV(e){if(e.length===0)return"";const m=["ID","Provider","Event Type","Status","Repository","Actor","Processing Time","Created At"],t=e.map(u=>[u.id,u.provider,u.eventType,u.status,u.repositoryFullName,u.actor,u.processingTime||"",u.createdAt]);return[m.join(","),...t.map(u=>u.map(s=>`"${s}"`).join(","))].join(`
`)}getEventTypes(){return[{title:"Push",value:"push"},{title:"Merge Request",value:"merge_request"},{title:"Pull Request",value:"pull_request"},{title:"Issue",value:"issue"},{title:"Pipeline",value:"pipeline"},{title:"Release",value:"release"},{title:"Tag",value:"tag"},{title:"Wiki",value:"wiki"}]}getProviders(){return[{title:"GitLab",value:"gitlab",icon:"mdi-gitlab"},{title:"GitHub",value:"github",icon:"mdi-github"},{title:"Bitbucket",value:"bitbucket",icon:"mdi-bitbucket"}]}getStatusOptions(){return[{title:"Processado",value:"processed",color:"success"},{title:"Falhou",value:"failed",color:"error"},{title:"Pendente",value:"pending",color:"warning"},{title:"Tentando Novamente",value:"retry",color:"info"}]}}const C=new Ne,J="b1e58ac3-6a88-4fc3-846d-352c8ca4a1db",Ie=Le({__name:"WebhooksView",setup(se,{expose:e}){e();const{isDemoUser:m}=K(),t=x([]),v=x(null),u=x(!1),s=x(null),f=x(1),h=x(1),k=x([]),V=x(!1),p=x(!1),b=x(!1),N=x(null),j=x(null),B=x(!1),z=x(!1),L=Pe({provider:"",eventType:"",status:"",actor:"",dateFrom:"",dateTo:""}),n=C.getProviders(),g=C.getEventTypes(),H=C.getStatusOptions(),Q=[{title:"Provedor",key:"provider",sortable:!1},{title:"Evento",key:"eventType",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Repositório",key:"repositoryFullName",sortable:!1},{title:"Autor",key:"actor",sortable:!1},{title:"Tempo Proc.",key:"processingTime",sortable:!1},{title:"Data/Hora",key:"createdAt",sortable:!1},{title:"Ações",key:"actions",sortable:!1,width:120}],E=async(r=f.value)=>{u.value=!0,s.value=null;try{const c=Object.fromEntries(Object.entries(L).filter(([,P])=>P!==""&&P!==null&&P!==void 0)),I=await C.getWebhookLogs(J,c,r,20);t.value=I.data,f.value=I.page,h.value=I.totalPages}catch(c){s.value=c instanceof Error?c.message:"Erro ao carregar logs"}finally{u.value=!1}},A=async()=>{try{const r=Object.fromEntries(Object.entries(L).filter(([,c])=>c!==""&&c!==null&&c!==void 0));v.value=await C.getWebhookLogStats(J,r)}catch(r){console.error("Erro ao carregar estatísticas:",r)}},X=()=>{f.value=1,E(1),A()},ce=()=>{Object.keys(L).forEach(r=>{L[r]=""}),X()},ue=async r=>{try{N.value=await C.getWebhookLogDetails(r.id),V.value=!0}catch(c){console.error("Erro ao carregar detalhes do log:",c)}},me=r=>{j.value=r,p.value=!0},ge=async()=>{if(j.value){z.value=!0;try{await C.deleteWebhookLog(j.value.id),await E(),await A(),p.value=!1,j.value=null}catch(r){alert("Funcionalidade de exclusão não disponível na API atual"),console.error("Erro ao excluir log:",r)}finally{z.value=!1}}},fe=()=>{k.value.length>0&&(b.value=!0)},pe=async()=>{z.value=!0;try{await C.bulkDeleteWebhookLogs(k.value),k.value=[],await E(),await A(),b.value=!1}catch(r){alert("Funcionalidade de exclusão em lote não disponível na API atual"),console.error("Erro ao excluir logs:",r)}finally{z.value=!1}},ve=async r=>{try{const c=await C.retryWebhook(r.id);c.success&&(alert(c.message),await E(),await A())}catch(c){console.error("Erro ao tentar webhook novamente:",c)}},be=async()=>{B.value=!0;try{const r=Object.fromEntries(Object.entries(L).filter(([,Y])=>Y!==""&&Y!==null&&Y!==void 0)),c=await C.exportWebhookLogs(J,r,"csv"),I=window.URL.createObjectURL(c),P=document.createElement("a");P.style.display="none",P.href=I,P.download=`webhook-logs-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(P),P.click(),window.URL.revokeObjectURL(I),document.body.removeChild(P)}catch(r){console.error("Erro ao exportar logs:",r)}finally{B.value=!1}},ye=r=>({gitlab:"mdi-gitlab",github:"mdi-github",bitbucket:"mdi-bitbucket"})[r]||"mdi-webhook",ke=r=>({processed:"success",failed:"error",pending:"warning",retry:"info"})[r]||"grey",xe=r=>({processed:"mdi-check",failed:"mdi-close",pending:"mdi-clock",retry:"mdi-refresh"})[r]||"mdi-help",we=r=>({processed:"Processado",failed:"Falhou",pending:"Pendente",retry:"Tentando"})[r]||r,Te=r=>r?r<500?"text-success":r<1e3?"text-warning":"text-error":"",he=r=>r?r.split(" ").map(c=>c[0]).join("").toUpperCase().substring(0,2):"??",_e=r=>{if(!r)return"Data inválida";const c=new Date(r);return isNaN(c.getTime())?"Data inválida":c.toLocaleDateString("pt-BR")},De=r=>{if(r==null)return"N/A";if(typeof r=="string"){const c=new Date(r);return isNaN(c.getTime())?"N/A":c.toLocaleTimeString("pt-BR")}return r<1e3?`${r.toFixed(0)}ms`:`${(r/1e3).toFixed(2)}s`},Ve=r=>r===void 0?"0%":`${r.toFixed(1)}%`;let G;Se(L,()=>{clearTimeout(G),G=setTimeout(()=>{X()},1e3)},{deep:!0}),Ce(()=>{E(),A()});const ae={organizationId:J,isDemoUser:m,logs:t,stats:v,loading:u,error:s,currentPage:f,totalPages:h,selectedLogs:k,detailsDialog:V,deleteDialog:p,bulkDeleteDialog:b,selectedLog:N,logToDelete:j,exporting:B,deleting:z,filters:L,providerOptions:n,eventTypeOptions:g,statusOptions:H,tableHeaders:Q,loadWebhookLogs:E,loadStats:A,applyFilters:X,clearFilters:ce,viewLogDetails:ue,confirmDelete:me,executeDelete:ge,confirmBulkDelete:fe,executeBulkDelete:pe,retryWebhook:ve,exportLogs:be,getProviderIcon:ye,getStatusColor:ke,getStatusIcon:xe,getStatusText:we,getProcessingTimeClass:Te,getInitials:he,formatDate:_e,formatTime:De,formatPercentage:Ve,get filterTimeout(){return G},set filterTimeout(r){G=r}};return Object.defineProperty(ae,"__isScriptSetup",{enumerable:!1,value:!0}),ae}}),Me={class:"webhooks-page"},Be={class:"d-flex justify-space-between align-center mb-6"},qe={class:"d-flex gap-2"},He={class:"d-flex align-center"},Ge={class:"flex-grow-1"},Je={class:"text-h4 font-weight-bold"},Ke={class:"d-flex align-center"},Qe={class:"flex-grow-1"},Xe={class:"text-h4 font-weight-bold text-success"},Ye={class:"d-flex align-center"},Ze={class:"flex-grow-1"},$e={class:"text-h4 font-weight-bold text-info"},et={class:"d-flex align-center"},tt={class:"flex-grow-1"},ot={class:"text-h4 font-weight-bold text-error"},lt={class:"px-4 py-2"},st={class:"d-flex justify-end gap-2 mt-4"},at={key:0,class:"text-center py-8"},rt={key:1,class:"text-center py-8"},it={class:"text-body-2 text-medium-emphasis mb-4"},nt={key:2,class:"text-center py-8"},dt={key:3},ct={class:"d-flex align-center gap-2"},ut={class:"text-capitalize"},mt={class:"d-flex align-center gap-2"},gt={class:"text-truncate",style:{"max-width":"200px"}},ft={class:"d-flex align-center gap-2"},pt={class:"text-caption"},vt={class:"ml-2"},bt={class:"text-body-2"},yt={class:"text-caption text-grey-darken-1"},kt={class:"d-flex gap-1"},xt={class:"d-flex justify-center mt-4"},wt={class:"d-flex align-center"},Tt={class:"d-flex flex-column gap-2"},ht={key:0},_t={class:"mb-2"},Dt={class:"mb-2"},Vt={class:"mb-2"},Lt={class:"mt-1"},Pt={key:1,class:"text-grey-darken-1"},St={class:"text-caption"},Ct={class:"text-caption",style:{"max-height":"400px","overflow-y":"auto"}};function Et(se,e,m,t,v,u){return y(),O("div",Me,[a("div",Be,[e[16]||(e[16]=a("div",null,[a("h1",{class:"text-h4 font-weight-bold text-high-emphasis mb-2"}," Logs de Webhooks "),a("p",{class:"text-body-1 text-grey-darken-1"}," Monitore e gerencie todos os webhooks recebidos pela organização ")],-1)),a("div",qe,[t.isDemoUser?F("",!0):(y(),R(w,{key:0,color:"primary",variant:"outlined","prepend-icon":"mdi-download",onClick:t.exportLogs,loading:t.exporting},{default:l(()=>[...e[15]||(e[15]=[i(" Exportar ",-1)])]),_:1},8,["loading"])),t.isDemoUser?F("",!0):(y(),R(w,{key:1,color:"error",variant:"outlined","prepend-icon":"mdi-delete-sweep",onClick:t.confirmBulkDelete,disabled:!t.selectedLogs.length,class:"ml-2"},{default:l(()=>[i(" Excluir Selecionados ("+d(t.selectedLogs.length)+") ",1)]),_:1},8,["disabled"]))])]),o(Ae,{type:"info",class:"mb-6"},{default:l(()=>[...e[17]||(e[17]=[a("div",{class:"d-flex align-center"},[a("strong",{class:"mr-2"},"Visualização de Logs:"),i(" Esta página exibe os logs de webhooks recebidos. Algumas funcionalidades como exclusão e retry estão limitadas pela API atual. ")],-1)])]),_:1}),o(Z,{class:"mb-6"},{default:l(()=>[o(T,{cols:"12",sm:"6",md:"3"},{default:l(()=>[o(_,null,{default:l(()=>[o(D,null,{default:l(()=>[a("div",He,[a("div",Ge,[e[18]||(e[18]=a("p",{class:"text-body-2 text-medium-emphasis mb-1"},"Total de Logs",-1)),a("h3",Je,d(t.stats?.total||0),1)]),o(q,{size:"48",color:"primary",variant:"tonal"},{default:l(()=>[o(S,{size:"24"},{default:l(()=>[...e[19]||(e[19]=[i("mdi-webhook",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),o(T,{cols:"12",sm:"6",md:"3"},{default:l(()=>[o(_,null,{default:l(()=>[o(D,null,{default:l(()=>[a("div",Ke,[a("div",Qe,[e[20]||(e[20]=a("p",{class:"text-body-2 text-medium-emphasis mb-1"},"Taxa de Sucesso",-1)),a("h3",Xe,d(t.formatPercentage(t.stats?.successRate)),1)]),o(q,{size:"48",color:"success",variant:"tonal"},{default:l(()=>[o(S,{size:"24"},{default:l(()=>[...e[21]||(e[21]=[i("mdi-check-circle",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),o(T,{cols:"12",sm:"6",md:"3"},{default:l(()=>[o(_,null,{default:l(()=>[o(D,null,{default:l(()=>[a("div",Ye,[a("div",Ze,[e[22]||(e[22]=a("p",{class:"text-body-2 text-medium-emphasis mb-1"},"Tempo Médio",-1)),a("h3",$e,d(t.formatTime(t.stats?.avgProcessingTime)),1)]),o(q,{size:"48",color:"info",variant:"tonal"},{default:l(()=>[o(S,{size:"24"},{default:l(()=>[...e[23]||(e[23]=[i("mdi-clock-outline",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),o(T,{cols:"12",sm:"6",md:"3"},{default:l(()=>[o(_,null,{default:l(()=>[o(D,null,{default:l(()=>[a("div",et,[a("div",tt,[e[24]||(e[24]=a("p",{class:"text-body-2 text-medium-emphasis mb-1"},"Falhas",-1)),a("h3",ot,d(t.stats?.failed||0),1)]),o(q,{size:"48",color:"error",variant:"tonal"},{default:l(()=>[o(S,{size:"24"},{default:l(()=>[...e[25]||(e[25]=[i("mdi-alert-circle",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),o(_,{class:"mb-6"},{default:l(()=>[o(D,null,{default:l(()=>[o(Z,null,{default:l(()=>[o(T,{cols:"12",md:"3"},{default:l(()=>[o(ee,{modelValue:t.filters.provider,"onUpdate:modelValue":e[0]||(e[0]=s=>t.filters.provider=s),items:t.providerOptions,label:"Provedor",clearable:"",variant:"outlined","item-title":"title","item-value":"value"},{"prepend-item":l(()=>[a("div",lt,[o(Fe,null,{default:l(()=>[...e[26]||(e[26]=[i("Provedores",-1)])]),_:1})])]),item:l(({props:s,item:f})=>[o(de,re(ie(s)),{prepend:l(()=>[o(S,{icon:f.raw.icon},null,8,["icon"])]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),o(T,{cols:"12",md:"3"},{default:l(()=>[o(ee,{modelValue:t.filters.eventType,"onUpdate:modelValue":e[1]||(e[1]=s=>t.filters.eventType=s),items:t.eventTypeOptions,label:"Tipo de Evento",clearable:"",variant:"outlined","item-title":"title","item-value":"value"},null,8,["modelValue","items"])]),_:1}),o(T,{cols:"12",md:"3"},{default:l(()=>[o(ee,{modelValue:t.filters.status,"onUpdate:modelValue":e[2]||(e[2]=s=>t.filters.status=s),items:t.statusOptions,label:"Status",clearable:"",variant:"outlined","item-title":"title","item-value":"value"},{item:l(({props:s,item:f})=>[o(de,re(ie(s)),{prepend:l(()=>[o(M,{color:f.raw.color,size:"x-small"},null,8,["color"])]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),o(T,{cols:"12",md:"3"},{default:l(()=>[o(te,{modelValue:t.filters.actor,"onUpdate:modelValue":e[3]||(e[3]=s=>t.filters.actor=s),label:"Autor",clearable:"",variant:"outlined","prepend-inner-icon":"mdi-account-search"},null,8,["modelValue"])]),_:1}),o(T,{cols:"12",md:"6"},{default:l(()=>[o(te,{modelValue:t.filters.dateFrom,"onUpdate:modelValue":e[4]||(e[4]=s=>t.filters.dateFrom=s),label:"Data Inicial",type:"date",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),o(T,{cols:"12",md:"6"},{default:l(()=>[o(te,{modelValue:t.filters.dateTo,"onUpdate:modelValue":e[5]||(e[5]=s=>t.filters.dateTo=s),label:"Data Final",type:"date",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),a("div",st,[o(w,{color:"grey",variant:"outlined",onClick:t.clearFilters},{default:l(()=>[...e[27]||(e[27]=[i(" Limpar Filtros ",-1)])]),_:1}),o(w,{color:"primary",onClick:t.applyFilters,loading:t.loading,class:"ml-2"},{default:l(()=>[...e[28]||(e[28]=[i(" Aplicar Filtros ",-1)])]),_:1},8,["loading"])])]),_:1})]),_:1}),o(_,null,{default:l(()=>[o(D,null,{default:l(()=>[t.loading?(y(),O("div",at,[o(ze,{indeterminate:"",color:"primary",size:"64"}),e[29]||(e[29]=a("div",{class:"mt-4 text-body-1"},"Carregando logs...",-1))])):t.error?(y(),O("div",rt,[o(S,{size:"64",color:"error",class:"mb-4"},{default:l(()=>[...e[30]||(e[30]=[i("mdi-alert-circle",-1)])]),_:1}),e[32]||(e[32]=a("div",{class:"text-h6 mb-2"},"Erro ao carregar logs",-1)),a("div",it,d(t.error),1),t.isDemoUser?F("",!0):(y(),R(w,{key:0,color:"primary",onClick:t.loadWebhookLogs},{default:l(()=>[...e[31]||(e[31]=[i("Tentar Novamente",-1)])]),_:1}))])):t.logs.length?(y(),O("div",dt,[o(Ue,{modelValue:t.selectedLogs,"onUpdate:modelValue":e[6]||(e[6]=s=>t.selectedLogs=s),headers:t.tableHeaders,items:t.logs,loading:t.loading,"item-value":"id","show-select":!t.isDemoUser,class:"elevation-0"},{"item.provider":l(({item:s})=>[a("div",ct,[o(S,{icon:t.getProviderIcon(s.provider)},null,8,["icon"]),a("span",ut,d(s.provider),1)])]),"item.eventType":l(({item:s})=>[o(M,{size:"small",color:"info",variant:"tonal"},{default:l(()=>[i(d(s.eventType),1)]),_:2},1024)]),"item.status":l(({item:s})=>[o(M,{size:"small",color:t.getStatusColor(s.status),"prepend-icon":t.getStatusIcon(s.status)},{default:l(()=>[i(d(t.getStatusText(s.status)),1)]),_:2},1032,["color","prepend-icon"])]),"item.repositoryFullName":l(({item:s})=>[a("div",mt,[o(S,{size:"16"},{default:l(()=>[...e[36]||(e[36]=[i("mdi-source-repository",-1)])]),_:1}),a("span",gt,d(s.repositoryFullName),1)])]),"item.actor":l(({item:s})=>[a("div",ft,[o(q,{size:"24",color:"primary"},{default:l(()=>[a("span",pt,d(t.getInitials(s.actor)),1)]),_:2},1024),a("span",vt,d(s.actor),1)])]),"item.processingTime":l(({item:s})=>[a("span",{class:Ee(t.getProcessingTimeClass(s.processingTime))},d(t.formatTime(s.processingTime)),3)]),"item.createdAt":l(({item:s})=>[a("div",null,[a("div",bt,d(t.formatDate(s.createdAt)),1),a("div",yt,d(t.formatTime(s.createdAt)),1)])]),"item.actions":l(({item:s})=>[a("div",kt,[o(w,{size:"small",variant:"text",icon:"mdi-eye",onClick:f=>t.viewLogDetails(s),title:"Ver Detalhes"},null,8,["onClick"]),s.status==="failed"&&!t.isDemoUser?(y(),R(w,{key:0,size:"small",variant:"text",icon:"mdi-refresh",color:"warning",onClick:f=>t.retryWebhook(s),title:"Tentar Novamente"},null,8,["onClick"])):F("",!0),t.isDemoUser?F("",!0):(y(),R(w,{key:1,size:"small",variant:"text",icon:"mdi-delete",color:"error",onClick:f=>t.confirmDelete(s),title:"Excluir"},null,8,["onClick"]))])]),_:2},1032,["modelValue","items","loading","show-select"]),a("div",xt,[o(We,{modelValue:t.currentPage,"onUpdate:modelValue":[e[7]||(e[7]=s=>t.currentPage=s),t.loadWebhookLogs],length:t.totalPages,"total-visible":7},null,8,["modelValue","length"])])])):(y(),O("div",nt,[o(S,{size:"64",color:"grey",class:"mb-4"},{default:l(()=>[...e[33]||(e[33]=[i("mdi-webhook",-1)])]),_:1}),e[34]||(e[34]=a("div",{class:"text-h6 mb-2"},"Nenhum log encontrado",-1)),e[35]||(e[35]=a("div",{class:"text-body-2 text-grey-darken-1"}," Não há logs de webhook com os filtros aplicados ",-1))]))]),_:1})]),_:1}),o(le,{modelValue:t.detailsDialog,"onUpdate:modelValue":e[10]||(e[10]=s=>t.detailsDialog=s),"max-width":"1200",scrollable:""},{default:l(()=>[t.selectedLog?(y(),R(_,{key:0},{default:l(()=>[o(W,{class:"text-h6 d-flex align-center justify-space-between bg-primary text-white sticky-header"},{default:l(()=>[a("div",wt,[o(S,{class:"me-2"},{default:l(()=>[...e[37]||(e[37]=[i("mdi-webhook",-1)])]),_:1}),e[38]||(e[38]=i(" Detalhes do Webhook ",-1))]),o(w,{icon:"mdi-close",variant:"text",size:"small",color:"white",onClick:e[8]||(e[8]=s=>t.detailsDialog=!1)})]),_:1}),o(D,null,{default:l(()=>[o(Z,null,{default:l(()=>[o(T,{cols:"12",md:"6"},{default:l(()=>[o(_,{variant:"outlined"},{default:l(()=>[o(W,null,{default:l(()=>[...e[39]||(e[39]=[i("Informações Básicas",-1)])]),_:1}),o(D,null,{default:l(()=>[a("div",Tt,[a("div",null,[e[40]||(e[40]=a("strong",null,"ID:",-1)),i(" "+d(t.selectedLog.id),1)]),a("div",null,[e[41]||(e[41]=a("strong",null,"Provedor:",-1)),i(" "+d(t.selectedLog.provider),1)]),a("div",null,[e[42]||(e[42]=a("strong",null,"Evento:",-1)),i(" "+d(t.selectedLog.eventType),1)]),a("div",null,[e[43]||(e[43]=a("strong",null,"Status:",-1)),o(M,{size:"small",color:t.getStatusColor(t.selectedLog.status)},{default:l(()=>[i(d(t.getStatusText(t.selectedLog.status)),1)]),_:1},8,["color"])]),a("div",null,[e[44]||(e[44]=a("strong",null,"Repositório:",-1)),i(" "+d(t.selectedLog.repositoryFullName),1)]),a("div",null,[e[45]||(e[45]=a("strong",null,"Autor:",-1)),i(" "+d(t.selectedLog.actor),1)]),a("div",null,[e[46]||(e[46]=a("strong",null,"IP:",-1)),i(" "+d(t.selectedLog.sourceIp),1)]),a("div",null,[e[47]||(e[47]=a("strong",null,"Tempo de Processamento:",-1)),i(" "+d(t.formatTime(t.selectedLog.processingTime)),1)])])]),_:1})]),_:1})]),_:1}),o(T,{cols:"12",md:"6"},{default:l(()=>[o(_,{variant:"outlined"},{default:l(()=>[o(W,null,{default:l(()=>[...e[48]||(e[48]=[i("Resultado do Processamento",-1)])]),_:1}),o(D,null,{default:l(()=>[t.selectedLog.processingResult?(y(),O("div",ht,[a("div",_t,[e[49]||(e[49]=a("strong",null,"Sucesso:",-1)),o(M,{size:"small",color:t.selectedLog.processingResult.success?"success":"error"},{default:l(()=>[i(d(t.selectedLog.processingResult.success?"Sim":"Não"),1)]),_:1},8,["color"])]),a("div",Dt,[e[50]||(e[50]=a("strong",null,"Mensagem:",-1)),i(" "+d(t.selectedLog.processingResult.message),1)]),a("div",Vt,[e[51]||(e[51]=a("strong",null,"Ações Executadas:",-1)),a("div",Lt,[(y(!0),O(Oe,null,Re(t.selectedLog.processingResult.triggeredActions,s=>(y(),R(M,{key:s,size:"small",color:"info",class:"mr-1 mb-1"},{default:l(()=>[i(d(s),1)]),_:2},1024))),128))])])])):(y(),O("div",Pt," Nenhum resultado de processamento disponível "))]),_:1})]),_:1})]),_:1}),o(T,{cols:"12"},{default:l(()=>[o(_,{variant:"outlined"},{default:l(()=>[o(W,null,{default:l(()=>[...e[52]||(e[52]=[i("Headers",-1)])]),_:1}),o(D,null,{default:l(()=>[a("pre",St,d(JSON.stringify(t.selectedLog.headers,null,2)),1)]),_:1})]),_:1})]),_:1}),t.selectedLog.payload?(y(),R(T,{key:0,cols:"12"},{default:l(()=>[o(_,{variant:"outlined"},{default:l(()=>[o(W,null,{default:l(()=>[...e[53]||(e[53]=[i("Payload",-1)])]),_:1}),o(D,null,{default:l(()=>[a("pre",Ct,d(JSON.stringify(t.selectedLog.payload,null,2)),1)]),_:1})]),_:1})]),_:1})):F("",!0)]),_:1})]),_:1}),o($,{class:"px-6 py-4 bg-surface border-t"},{default:l(()=>[o(oe),o(w,{variant:"text",color:"primary",onClick:e[9]||(e[9]=s=>t.detailsDialog=!1)},{default:l(()=>[...e[54]||(e[54]=[i(" Fechar ",-1)])]),_:1})]),_:1})]),_:1})):F("",!0)]),_:1},8,["modelValue"]),o(le,{modelValue:t.deleteDialog,"onUpdate:modelValue":e[12]||(e[12]=s=>t.deleteDialog=s),"max-width":"400"},{default:l(()=>[o(_,null,{default:l(()=>[o(W,null,{default:l(()=>[...e[55]||(e[55]=[i("Confirmar Exclusão",-1)])]),_:1}),o(D,null,{default:l(()=>[...e[56]||(e[56]=[i(" Tem certeza que deseja excluir este log de webhook? Esta ação não pode ser desfeita. ",-1)])]),_:1}),o($,null,{default:l(()=>[o(oe),o(w,{onClick:e[11]||(e[11]=s=>t.deleteDialog=!1)},{default:l(()=>[...e[57]||(e[57]=[i("Cancelar",-1)])]),_:1}),o(w,{color:"error",onClick:t.executeDelete,loading:t.deleting},{default:l(()=>[...e[58]||(e[58]=[i("Excluir",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(le,{modelValue:t.bulkDeleteDialog,"onUpdate:modelValue":e[14]||(e[14]=s=>t.bulkDeleteDialog=s),"max-width":"400"},{default:l(()=>[o(_,null,{default:l(()=>[o(W,null,{default:l(()=>[...e[59]||(e[59]=[i("Confirmar Exclusão em Lote",-1)])]),_:1}),o(D,null,{default:l(()=>[i(" Tem certeza que deseja excluir "+d(t.selectedLogs.length)+" logs selecionados? Esta ação não pode ser desfeita. ",1)]),_:1}),o($,null,{default:l(()=>[o(oe),o(w,{onClick:e[13]||(e[13]=s=>t.bulkDeleteDialog=!1)},{default:l(()=>[...e[60]||(e[60]=[i("Cancelar",-1)])]),_:1}),o(w,{color:"error",onClick:t.executeBulkDelete,loading:t.deleting},{default:l(()=>[i(" Excluir "+d(t.selectedLogs.length)+" logs ",1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const oo=je(Ie,[["render",Et],["__scopeId","data-v-01f9f36f"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/webhooks/WebhooksView.vue"]]);export{oo as default};
