import{k as Ve,f as x,r as Le,w as Pe,E as Se,X as j,z as a,q as l,Q as O,_ as W,T as o,S as y,a4 as i,a1 as d,aa as se,ab as ae,v as Ce,F as Ee,a8 as je}from"./vendor-vue-BvKyvIVR.js";import{a as F}from"./auth-PiWOMLtm.js";import{u as Q,a as N}from"./VChip-BzUv3cXC.js";import{_ as Oe}from"./index-CQBjCOQw.js";import{f as T,j as _,k as D,i as q,o as Re,l as A,p as re}from"./VGrid-CuJrScxf.js";import{V as ze}from"./VAlert-ChhMmNH2.js";import{V as Z,a as w}from"./VRow-C_rLTo1r.js";import{V as $}from"./VDialog-C6XAQXKq.js";import{V as C}from"./VIcon-CM-KW5Qw.js";import{a as ee,V as te}from"./VSelect-JVxEisdn.js";import{b as ie,e as Ue}from"./VList-CaAoEaF2.js";import{V as We}from"./VDataTable-BIdz-mlh.js";import{V as Fe}from"./VPagination-C7VPvwfo.js";import{V as ne}from"./VSpacer-kp13s616.js";import"./vendor-utils-Cfk84l6i.js";import"./token-storage.service-BqAv9k07.js";import"./vendor-ui-Dz8XL-co.js";import"./tag-Bnbpnddf.js";import"./dimensions-DVh0fwa7.js";import"./VMenu-B2XC7rkF.js";import"./lazy-DADzjSlN.js";import"./forwardRefs-D_qxKlPu.js";import"./autofocus-Bh6bNAdk.js";import"./ssrBoot-COakMcr6.js";import"./VTable-BhCG_aMe.js";import"./filter-3ET2mAtK.js";class Ae{async getWebhookLogs(e,m={},t=1,p=20){const{isDemoUser:u,getMockData:s,simulateApiDelay:v}=Q();if(u.value){await v();const k=await s("webhooks",t,p,m),V=Math.ceil(k.total/p);return{...k,totalPages:V,hasNext:t<V,hasPrevious:t>1}}const h=new URLSearchParams({organizationId:e,page:t.toString(),limit:p.toString(),...Object.fromEntries(Object.entries(m).filter(([,k])=>k!==void 0&&k!==""))});return await F.get(`/webhooks/logs?${h}`)}async getWebhookLogDetails(e){const{isDemoUser:m,getMockItem:t,simulateApiDelay:p}=Q();if(m.value){await p();const u=t("webhooks",e);if(!u)throw new Error("Webhook não encontrado");return u}return await F.get(`/webhooks/logs/${e}`)}async getWebhookLogStats(e,m={}){const{isDemoUser:t,simulateApiDelay:p}=Q();if(t.value)return await p(),{total:156,processed:132,failed:8,pending:12,ignored:4,processingRate:84.6,errorRate:5.1,averageProcessingTime:2.3,topEventTypes:[{eventType:"push",count:78},{eventType:"pull_request",count:34},{eventType:"issue",count:22},{eventType:"merge_request",count:18},{eventType:"release",count:4}],topRepositories:[{repository:"demo/projeto-frontend-react",count:45},{repository:"demo/api-backend-node",count:38},{repository:"demo/mobile-app-flutter",count:29},{repository:"demo/infrastructure-terraform",count:24},{repository:"demo/documentation-site",count:20}]};const u=new URLSearchParams({organizationId:e,...Object.fromEntries(Object.entries(m).filter(([,f])=>f!==void 0&&f!==""))}),s=await F.get(`/webhooks/logs/stats?${u}`),v=Object.entries(s.byEventType).map(([f,b])=>({eventType:f,count:b})).sort((f,b)=>b.count-f.count).slice(0,5),h=Object.entries(s.byProvider).map(([f,b])=>({provider:f,count:b})).sort((f,b)=>b.count-f.count),k=new Date,V=[];for(let f=6;f>=0;f--){const b=new Date(k);b.setDate(b.getDate()-f);const I=b.toISOString().split("T")[0];V.push({date:I||"",count:Math.floor(Math.random()*10)})}return{total:s.total,processed:s.processed,failed:s.failed,pending:s.pending,retry:0,avgProcessingTime:s.averageProcessingTime,successRate:s.successRate,errorRate:100-s.successRate,topEventTypes:v,topProviders:h,recentActivity:V}}calculateStats(e){const{data:m,total:t}=e,p=m.filter(n=>n.status==="processed").length,u=m.filter(n=>n.status==="failed").length,s=m.filter(n=>n.status==="pending").length,v=m.filter(n=>n.status==="retry").length,h=m.filter(n=>n.processingTime!==null).map(n=>n.processingTime),k=h.length>0?h.reduce((n,g)=>n+g,0)/h.length:0,V=t>0?p/t*100:0,f=t>0?u/t*100:0,b=m.reduce((n,g)=>(n[g.eventType]=(n[g.eventType]||0)+1,n),{}),I=Object.entries(b).map(([n,g])=>({eventType:n,count:g})).sort((n,g)=>g.count-n.count).slice(0,5),R=m.reduce((n,g)=>(n[g.provider]=(n[g.provider]||0)+1,n),{}),B=Object.entries(R).map(([n,g])=>({provider:n,count:g})).sort((n,g)=>g.count-n.count),z=new Date,L=[];for(let n=6;n>=0;n--){const g=new Date(z);g.setDate(g.getDate()-n);const H=g.toISOString().split("T")[0],X=m.filter(E=>new Date(E.createdAt).toISOString().split("T")[0]===H).length;L.push({date:H||"",count:X})}return{total:t,processed:p,failed:u,pending:s,retry:v,avgProcessingTime:k,successRate:V,errorRate:f,topEventTypes:I,topProviders:B,recentActivity:L}}async retryWebhook(e){return await F.post(`/webhooks/logs/${e}/retry`)}async deleteWebhookLog(e){await F.delete(`/webhooks/logs/${e}`)}async bulkDeleteWebhookLogs(e){await F.post("/webhooks/logs/bulk-delete",{logIds:e})}async exportWebhookLogs(e,m={},t="csv"){const p=new URLSearchParams({organizationId:e,format:t,...Object.fromEntries(Object.entries(m).filter(([,s])=>s!==void 0&&s!==""))}),u=await fetch(`${F.getBaseURL()}/webhooks/logs/export?${p}`,{method:"GET",headers:{Accept:t==="csv"?"text/csv":"application/json"}});if(!u.ok)throw new Error("Erro ao exportar dados");return await u.blob()}convertToCSV(e){if(e.length===0)return"";const m=["ID","Provider","Event Type","Status","Repository","Actor","Processing Time","Created At"],t=e.map(u=>[u.id,u.provider,u.eventType,u.status,u.repositoryFullName,u.actor,u.processingTime||"",u.createdAt]);return[m.join(","),...t.map(u=>u.map(s=>`"${s}"`).join(","))].join(`
`)}getEventTypes(){return[{title:"Push",value:"push"},{title:"Merge Request",value:"merge_request"},{title:"Pull Request",value:"pull_request"},{title:"Issue",value:"issue"},{title:"Pipeline",value:"pipeline"},{title:"Release",value:"release"},{title:"Tag",value:"tag"},{title:"Wiki",value:"wiki"}]}getProviders(){return[{title:"GitLab",value:"gitlab",icon:"mdi-gitlab"},{title:"GitHub",value:"github",icon:"mdi-github"},{title:"Bitbucket",value:"bitbucket",icon:"mdi-bitbucket"}]}getStatusOptions(){return[{title:"Processado",value:"processed",color:"success"},{title:"Falhou",value:"failed",color:"error"},{title:"Pendente",value:"pending",color:"warning"},{title:"Tentando Novamente",value:"retry",color:"info"}]}}const S=new Ae,J="b1e58ac3-6a88-4fc3-846d-352c8ca4a1db",Ie=Ve({__name:"WebhooksView",setup(oe,{expose:e}){e();const{isDemoUser:m}=Q(),t=x([]),p=x(null),u=x(!1),s=x(null),v=x(1),h=x(1),k=x([]),V=x(!1),f=x(!1),b=x(!1),I=x(null),R=x(null),B=x(!1),z=x(!1),L=Le({provider:"",eventType:"",status:"",actor:"",dateFrom:"",dateTo:""}),n=S.getProviders(),g=S.getEventTypes(),H=S.getStatusOptions(),X=[{title:"Provedor",key:"provider",sortable:!1},{title:"Evento",key:"eventType",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Repositório",key:"repository",sortable:!1},{title:"Autor",key:"actor",sortable:!1},{title:"Tempo Proc.",key:"processingTime",sortable:!1},{title:"Data/Hora",key:"timestamp",sortable:!1},{title:"Ações",key:"actions",sortable:!1,width:120}],E=async(r=v.value)=>{u.value=!0,s.value=null;try{const c=Object.fromEntries(Object.entries(L).filter(([,P])=>P!==""&&P!==null&&P!==void 0)),M=await S.getWebhookLogs(J,c,r,20);t.value=M.data,v.value=M.page,h.value=M.totalPages}catch(c){s.value=c instanceof Error?c.message:"Erro ao carregar logs"}finally{u.value=!1}},U=async()=>{try{const r=Object.fromEntries(Object.entries(L).filter(([,c])=>c!==""&&c!==null&&c!==void 0));p.value=await S.getWebhookLogStats(J,r)}catch(r){console.error("Erro ao carregar estatísticas:",r)}},K=()=>{v.value=1,E(1),U()},de=()=>{Object.keys(L).forEach(r=>{L[r]=""}),K()},ue=async r=>{try{I.value=await S.getWebhookLogDetails(r.id),V.value=!0}catch(c){console.error("Erro ao carregar detalhes do log:",c)}},ce=r=>{R.value=r,f.value=!0},me=async()=>{if(R.value){z.value=!0;try{await S.deleteWebhookLog(R.value.id),await E(),await U(),f.value=!1,R.value=null}catch(r){alert("Funcionalidade de exclusão não disponível na API atual"),console.error("Erro ao excluir log:",r)}finally{z.value=!1}}},ge=()=>{k.value.length>0&&(b.value=!0)},fe=async()=>{z.value=!0;try{await S.bulkDeleteWebhookLogs(k.value),k.value=[],await E(),await U(),b.value=!1}catch(r){alert("Funcionalidade de exclusão em lote não disponível na API atual"),console.error("Erro ao excluir logs:",r)}finally{z.value=!1}},pe=async r=>{try{const c=await S.retryWebhook(r.id);c.success&&(alert(c.message),await E(),await U())}catch(c){console.error("Erro ao tentar webhook novamente:",c)}},ve=async()=>{B.value=!0;try{const r=Object.fromEntries(Object.entries(L).filter(([,Y])=>Y!==""&&Y!==null&&Y!==void 0)),c=await S.exportWebhookLogs(J,r,"csv"),M=window.URL.createObjectURL(c),P=document.createElement("a");P.style.display="none",P.href=M,P.download=`webhook-logs-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(P),P.click(),window.URL.revokeObjectURL(M),document.body.removeChild(P)}catch(r){console.error("Erro ao exportar logs:",r)}finally{B.value=!1}},be=r=>({gitlab:"mdi-gitlab",github:"mdi-github",bitbucket:"mdi-bitbucket"})[r]||"mdi-webhook",ye=r=>({processed:"success",failed:"error",pending:"warning",retry:"info"})[r]||"grey",ke=r=>({processed:"mdi-check",failed:"mdi-close",pending:"mdi-clock",retry:"mdi-refresh"})[r]||"mdi-help",xe=r=>({processed:"Processado",failed:"Falhou",pending:"Pendente",retry:"Tentando"})[r]||r,we=r=>r?r<500?"text-success":r<1e3?"text-warning":"text-error":"",Te=r=>r?r.split(" ").map(c=>c[0]).join("").toUpperCase().substring(0,2):"??",_e=r=>{if(!r)return"Data inválida";const c=new Date(r);return isNaN(c.getTime())?"Data inválida":c.toLocaleDateString("pt-BR")},De=r=>r==null?"N/A":typeof r=="string"?new Date(r).toLocaleTimeString("pt-BR"):r<1e3?`${r}ms`:`${(r/1e3).toFixed(2)}s`,he=r=>r===void 0?"0%":`${r.toFixed(1)}%`;let G;Pe(L,()=>{clearTimeout(G),G=setTimeout(()=>{K()},1e3)},{deep:!0}),Se(()=>{E(),U()});const le={organizationId:J,isDemoUser:m,logs:t,stats:p,loading:u,error:s,currentPage:v,totalPages:h,selectedLogs:k,detailsDialog:V,deleteDialog:f,bulkDeleteDialog:b,selectedLog:I,logToDelete:R,exporting:B,deleting:z,filters:L,providerOptions:n,eventTypeOptions:g,statusOptions:H,tableHeaders:X,loadWebhookLogs:E,loadStats:U,applyFilters:K,clearFilters:de,viewLogDetails:ue,confirmDelete:ce,executeDelete:me,confirmBulkDelete:ge,executeBulkDelete:fe,retryWebhook:pe,exportLogs:ve,getProviderIcon:be,getStatusColor:ye,getStatusIcon:ke,getStatusText:xe,getProcessingTimeClass:we,getInitials:Te,formatDate:_e,formatTime:De,formatPercentage:he,get filterTimeout(){return G},set filterTimeout(r){G=r}};return Object.defineProperty(le,"__isScriptSetup",{enumerable:!1,value:!0}),le}}),Me={class:"webhooks-page"},Ne={class:"d-flex justify-space-between align-center mb-6"},Be={class:"d-flex gap-2"},qe={class:"d-flex align-center"},He={class:"flex-grow-1"},Ge={class:"text-h4 font-weight-bold"},Je={class:"d-flex align-center"},Qe={class:"flex-grow-1"},Xe={class:"text-h4 font-weight-bold text-success"},Ke={class:"d-flex align-center"},Ye={class:"flex-grow-1"},Ze={class:"text-h4 font-weight-bold text-info"},$e={class:"d-flex align-center"},et={class:"flex-grow-1"},tt={class:"text-h4 font-weight-bold text-error"},ot={class:"px-4 py-2"},lt={class:"d-flex justify-end gap-2 mt-4"},st={key:0,class:"text-center py-8"},at={key:1,class:"text-center py-8"},rt={class:"text-body-2 text-grey-darken-1 mb-4"},it={key:2,class:"text-center py-8"},nt={key:3},dt={class:"d-flex align-center gap-2"},ut={class:"text-capitalize"},ct={class:"d-flex align-center gap-2"},mt={class:"text-truncate",style:{"max-width":"200px"}},gt={class:"d-flex align-center gap-2"},ft={class:"text-caption"},pt={class:"text-body-2"},vt={class:"text-caption text-grey-darken-1"},bt={class:"d-flex gap-1"},yt={class:"d-flex justify-center mt-4"},kt={class:"d-flex flex-column gap-2"},xt={key:0},wt={class:"mb-2"},Tt={class:"mb-2"},_t={class:"mb-2"},Dt={class:"mt-1"},ht={key:1,class:"text-grey-darken-1"},Vt={class:"text-caption"},Lt={class:"text-caption",style:{"max-height":"400px","overflow-y":"auto"}};function Pt(oe,e,m,t,p,u){return y(),j("div",Me,[a("div",Ne,[e[15]||(e[15]=a("div",null,[a("h1",{class:"text-h4 font-weight-bold text-grey-darken-3 mb-2"}," Logs de Webhooks "),a("p",{class:"text-body-1 text-grey-darken-1"}," Monitore e gerencie todos os webhooks recebidos pela organização ")],-1)),a("div",Be,[t.isDemoUser?W("",!0):(y(),O(T,{key:0,color:"primary",variant:"outlined","prepend-icon":"mdi-download",onClick:t.exportLogs,loading:t.exporting},{default:o(()=>[...e[14]||(e[14]=[i(" Exportar ",-1)])]),_:1},8,["loading"])),t.isDemoUser?W("",!0):(y(),O(T,{key:1,color:"error",variant:"outlined","prepend-icon":"mdi-delete-sweep",onClick:t.confirmBulkDelete,disabled:!t.selectedLogs.length},{default:o(()=>[i(" Excluir Selecionados ("+d(t.selectedLogs.length)+") ",1)]),_:1},8,["disabled"]))])]),l(ze,{type:"info",class:"mb-6"},{default:o(()=>[...e[16]||(e[16]=[a("div",{class:"d-flex align-center"},[a("strong",null,"Visualização de Logs:"),i(" Esta página exibe os logs de webhooks recebidos. Algumas funcionalidades como exclusão e retry estão limitadas pela API atual. ")],-1)])]),_:1}),l(Z,{class:"mb-6"},{default:o(()=>[l(w,{cols:"12",sm:"6",md:"3"},{default:o(()=>[l(_,null,{default:o(()=>[l(D,null,{default:o(()=>[a("div",qe,[a("div",He,[e[17]||(e[17]=a("p",{class:"text-body-2 text-grey-darken-1 mb-1"},"Total de Logs",-1)),a("h3",Ge,d(t.stats?.total||0),1)]),l(q,{size:"48",color:"primary",variant:"tonal"},{default:o(()=>[l(C,{size:"24"},{default:o(()=>[...e[18]||(e[18]=[i("mdi-webhook",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),l(w,{cols:"12",sm:"6",md:"3"},{default:o(()=>[l(_,null,{default:o(()=>[l(D,null,{default:o(()=>[a("div",Je,[a("div",Qe,[e[19]||(e[19]=a("p",{class:"text-body-2 text-grey-darken-1 mb-1"},"Taxa de Sucesso",-1)),a("h3",Xe,d(t.formatPercentage(t.stats?.successRate)),1)]),l(q,{size:"48",color:"success",variant:"tonal"},{default:o(()=>[l(C,{size:"24"},{default:o(()=>[...e[20]||(e[20]=[i("mdi-check-circle",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),l(w,{cols:"12",sm:"6",md:"3"},{default:o(()=>[l(_,null,{default:o(()=>[l(D,null,{default:o(()=>[a("div",Ke,[a("div",Ye,[e[21]||(e[21]=a("p",{class:"text-body-2 text-grey-darken-1 mb-1"},"Tempo Médio",-1)),a("h3",Ze,d(t.formatTime(t.stats?.avgProcessingTime)),1)]),l(q,{size:"48",color:"info",variant:"tonal"},{default:o(()=>[l(C,{size:"24"},{default:o(()=>[...e[22]||(e[22]=[i("mdi-clock-outline",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}),l(w,{cols:"12",sm:"6",md:"3"},{default:o(()=>[l(_,null,{default:o(()=>[l(D,null,{default:o(()=>[a("div",$e,[a("div",et,[e[23]||(e[23]=a("p",{class:"text-body-2 text-grey-darken-1 mb-1"},"Falhas",-1)),a("h3",tt,d(t.stats?.failed||0),1)]),l(q,{size:"48",color:"error",variant:"tonal"},{default:o(()=>[l(C,{size:"24"},{default:o(()=>[...e[24]||(e[24]=[i("mdi-alert-circle",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),l(_,{class:"mb-6"},{default:o(()=>[l(D,null,{default:o(()=>[l(Z,null,{default:o(()=>[l(w,{cols:"12",md:"3"},{default:o(()=>[l(ee,{modelValue:t.filters.provider,"onUpdate:modelValue":e[0]||(e[0]=s=>t.filters.provider=s),items:t.providerOptions,label:"Provedor",clearable:"",variant:"outlined","item-title":"title","item-value":"value"},{"prepend-item":o(()=>[a("div",ot,[l(Ue,null,{default:o(()=>[...e[25]||(e[25]=[i("Provedores",-1)])]),_:1})])]),item:o(({props:s,item:v})=>[l(ie,se(ae(s)),{prepend:o(()=>[l(C,{icon:v.raw.icon},null,8,["icon"])]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),l(w,{cols:"12",md:"3"},{default:o(()=>[l(ee,{modelValue:t.filters.eventType,"onUpdate:modelValue":e[1]||(e[1]=s=>t.filters.eventType=s),items:t.eventTypeOptions,label:"Tipo de Evento",clearable:"",variant:"outlined","item-title":"title","item-value":"value"},null,8,["modelValue","items"])]),_:1}),l(w,{cols:"12",md:"3"},{default:o(()=>[l(ee,{modelValue:t.filters.status,"onUpdate:modelValue":e[2]||(e[2]=s=>t.filters.status=s),items:t.statusOptions,label:"Status",clearable:"",variant:"outlined","item-title":"title","item-value":"value"},{item:o(({props:s,item:v})=>[l(ie,se(ae(s)),{prepend:o(()=>[l(N,{color:v.raw.color,size:"x-small"},null,8,["color"])]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),l(w,{cols:"12",md:"3"},{default:o(()=>[l(te,{modelValue:t.filters.actor,"onUpdate:modelValue":e[3]||(e[3]=s=>t.filters.actor=s),label:"Autor",clearable:"",variant:"outlined","prepend-inner-icon":"mdi-account-search"},null,8,["modelValue"])]),_:1}),l(w,{cols:"12",md:"6"},{default:o(()=>[l(te,{modelValue:t.filters.dateFrom,"onUpdate:modelValue":e[4]||(e[4]=s=>t.filters.dateFrom=s),label:"Data Inicial",type:"date",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(w,{cols:"12",md:"6"},{default:o(()=>[l(te,{modelValue:t.filters.dateTo,"onUpdate:modelValue":e[5]||(e[5]=s=>t.filters.dateTo=s),label:"Data Final",type:"date",clearable:"",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),a("div",lt,[l(T,{color:"grey",variant:"outlined",onClick:t.clearFilters},{default:o(()=>[...e[26]||(e[26]=[i(" Limpar Filtros ",-1)])]),_:1}),l(T,{color:"primary",onClick:t.applyFilters,loading:t.loading},{default:o(()=>[...e[27]||(e[27]=[i(" Aplicar Filtros ",-1)])]),_:1},8,["loading"])])]),_:1})]),_:1}),l(_,null,{default:o(()=>[l(D,null,{default:o(()=>[t.loading?(y(),j("div",st,[l(Re,{indeterminate:"",color:"primary",size:"64"}),e[28]||(e[28]=a("div",{class:"mt-4 text-body-1"},"Carregando logs...",-1))])):t.error?(y(),j("div",at,[l(C,{size:"64",color:"error",class:"mb-4"},{default:o(()=>[...e[29]||(e[29]=[i("mdi-alert-circle",-1)])]),_:1}),e[31]||(e[31]=a("div",{class:"text-h6 mb-2"},"Erro ao carregar logs",-1)),a("div",rt,d(t.error),1),t.isDemoUser?W("",!0):(y(),O(T,{key:0,color:"primary",onClick:t.loadWebhookLogs},{default:o(()=>[...e[30]||(e[30]=[i("Tentar Novamente",-1)])]),_:1}))])):t.logs.length?(y(),j("div",nt,[l(We,{modelValue:t.selectedLogs,"onUpdate:modelValue":e[6]||(e[6]=s=>t.selectedLogs=s),headers:t.tableHeaders,items:t.logs,loading:t.loading,"item-value":"id","show-select":!t.isDemoUser,class:"elevation-0"},{"item.provider":o(({item:s})=>[a("div",dt,[l(C,{icon:t.getProviderIcon(s.provider)},null,8,["icon"]),a("span",ut,d(s.provider),1)])]),"item.eventType":o(({item:s})=>[l(N,{size:"small",color:"info",variant:"tonal"},{default:o(()=>[i(d(s.eventType),1)]),_:2},1024)]),"item.status":o(({item:s})=>[l(N,{size:"small",color:t.getStatusColor(s.status),"prepend-icon":t.getStatusIcon(s.status)},{default:o(()=>[i(d(t.getStatusText(s.status)),1)]),_:2},1032,["color","prepend-icon"])]),"item.repositoryFullName":o(({item:s})=>[a("div",ct,[l(C,{size:"16"},{default:o(()=>[...e[35]||(e[35]=[i("mdi-source-repository",-1)])]),_:1}),a("span",mt,d(s.repositoryFullName),1)])]),"item.actor":o(({item:s})=>[a("div",gt,[l(q,{size:"24",color:"primary"},{default:o(()=>[a("span",ft,d(t.getInitials(s.actor)),1)]),_:2},1024),a("span",null,d(s.actor),1)])]),"item.processingTime":o(({item:s})=>[a("span",{class:Ce(t.getProcessingTimeClass(s.processingTime))},d(t.formatTime(s.processingTime)),3)]),"item.timestamp":o(({item:s})=>[a("div",null,[a("div",pt,d(t.formatDate(s.timestamp)),1),a("div",vt,d(t.formatTime(s.timestamp)),1)])]),"item.actions":o(({item:s})=>[a("div",bt,[l(T,{size:"small",variant:"text",icon:"mdi-eye",onClick:v=>t.viewLogDetails(s),title:"Ver Detalhes"},null,8,["onClick"]),s.status==="failed"&&!t.isDemoUser?(y(),O(T,{key:0,size:"small",variant:"text",icon:"mdi-refresh",color:"warning",onClick:v=>t.retryWebhook(s),title:"Tentar Novamente"},null,8,["onClick"])):W("",!0),t.isDemoUser?W("",!0):(y(),O(T,{key:1,size:"small",variant:"text",icon:"mdi-delete",color:"error",onClick:v=>t.confirmDelete(s),title:"Excluir"},null,8,["onClick"]))])]),_:2},1032,["modelValue","items","loading","show-select"]),a("div",yt,[l(Fe,{modelValue:t.currentPage,"onUpdate:modelValue":[e[7]||(e[7]=s=>t.currentPage=s),t.loadWebhookLogs],length:t.totalPages,"total-visible":7},null,8,["modelValue","length"])])])):(y(),j("div",it,[l(C,{size:"64",color:"grey",class:"mb-4"},{default:o(()=>[...e[32]||(e[32]=[i("mdi-webhook",-1)])]),_:1}),e[33]||(e[33]=a("div",{class:"text-h6 mb-2"},"Nenhum log encontrado",-1)),e[34]||(e[34]=a("div",{class:"text-body-2 text-grey-darken-1"}," Não há logs de webhook com os filtros aplicados ",-1))]))]),_:1})]),_:1}),l($,{modelValue:t.detailsDialog,"onUpdate:modelValue":e[9]||(e[9]=s=>t.detailsDialog=s),"max-width":"1200"},{default:o(()=>[t.selectedLog?(y(),O(_,{key:0},{default:o(()=>[l(A,{class:"d-flex justify-space-between align-center"},{default:o(()=>[e[36]||(e[36]=a("span",null,"Detalhes do Webhook",-1)),l(T,{icon:"mdi-close",variant:"text",onClick:e[8]||(e[8]=s=>t.detailsDialog=!1)})]),_:1}),l(D,null,{default:o(()=>[l(Z,null,{default:o(()=>[l(w,{cols:"12",md:"6"},{default:o(()=>[l(_,{variant:"outlined"},{default:o(()=>[l(A,null,{default:o(()=>[...e[37]||(e[37]=[i("Informações Básicas",-1)])]),_:1}),l(D,null,{default:o(()=>[a("div",kt,[a("div",null,[e[38]||(e[38]=a("strong",null,"ID:",-1)),i(" "+d(t.selectedLog.id),1)]),a("div",null,[e[39]||(e[39]=a("strong",null,"Provedor:",-1)),i(" "+d(t.selectedLog.provider),1)]),a("div",null,[e[40]||(e[40]=a("strong",null,"Evento:",-1)),i(" "+d(t.selectedLog.eventType),1)]),a("div",null,[e[41]||(e[41]=a("strong",null,"Status:",-1)),l(N,{size:"small",color:t.getStatusColor(t.selectedLog.status)},{default:o(()=>[i(d(t.getStatusText(t.selectedLog.status)),1)]),_:1},8,["color"])]),a("div",null,[e[42]||(e[42]=a("strong",null,"Repositório:",-1)),i(" "+d(t.selectedLog.repository),1)]),a("div",null,[e[43]||(e[43]=a("strong",null,"Autor:",-1)),i(" "+d(t.selectedLog.actor),1)]),a("div",null,[e[44]||(e[44]=a("strong",null,"IP:",-1)),i(" "+d(t.selectedLog.sourceIp),1)]),a("div",null,[e[45]||(e[45]=a("strong",null,"Tempo de Processamento:",-1)),i(" "+d(t.formatTime(t.selectedLog.processingTime)),1)])])]),_:1})]),_:1})]),_:1}),l(w,{cols:"12",md:"6"},{default:o(()=>[l(_,{variant:"outlined"},{default:o(()=>[l(A,null,{default:o(()=>[...e[46]||(e[46]=[i("Resultado do Processamento",-1)])]),_:1}),l(D,null,{default:o(()=>[t.selectedLog.processingResult?(y(),j("div",xt,[a("div",wt,[e[47]||(e[47]=a("strong",null,"Sucesso:",-1)),l(N,{size:"small",color:t.selectedLog.processingResult.success?"success":"error"},{default:o(()=>[i(d(t.selectedLog.processingResult.success?"Sim":"Não"),1)]),_:1},8,["color"])]),a("div",Tt,[e[48]||(e[48]=a("strong",null,"Mensagem:",-1)),i(" "+d(t.selectedLog.processingResult.message),1)]),a("div",_t,[e[49]||(e[49]=a("strong",null,"Ações Executadas:",-1)),a("div",Dt,[(y(!0),j(Ee,null,je(t.selectedLog.processingResult.triggeredActions,s=>(y(),O(N,{key:s,size:"small",color:"info",class:"mr-1 mb-1"},{default:o(()=>[i(d(s),1)]),_:2},1024))),128))])])])):(y(),j("div",ht," Nenhum resultado de processamento disponível "))]),_:1})]),_:1})]),_:1}),l(w,{cols:"12"},{default:o(()=>[l(_,{variant:"outlined"},{default:o(()=>[l(A,null,{default:o(()=>[...e[50]||(e[50]=[i("Headers",-1)])]),_:1}),l(D,null,{default:o(()=>[a("pre",Vt,d(JSON.stringify(t.selectedLog.headers,null,2)),1)]),_:1})]),_:1})]),_:1}),t.selectedLog.payload?(y(),O(w,{key:0,cols:"12"},{default:o(()=>[l(_,{variant:"outlined"},{default:o(()=>[l(A,null,{default:o(()=>[...e[51]||(e[51]=[i("Payload",-1)])]),_:1}),l(D,null,{default:o(()=>[a("pre",Lt,d(JSON.stringify(t.selectedLog.payload,null,2)),1)]),_:1})]),_:1})]),_:1})):W("",!0)]),_:1})]),_:1})]),_:1})):W("",!0)]),_:1},8,["modelValue"]),l($,{modelValue:t.deleteDialog,"onUpdate:modelValue":e[11]||(e[11]=s=>t.deleteDialog=s),"max-width":"400"},{default:o(()=>[l(_,null,{default:o(()=>[l(A,null,{default:o(()=>[...e[52]||(e[52]=[i("Confirmar Exclusão",-1)])]),_:1}),l(D,null,{default:o(()=>[...e[53]||(e[53]=[i(" Tem certeza que deseja excluir este log de webhook? Esta ação não pode ser desfeita. ",-1)])]),_:1}),l(re,null,{default:o(()=>[l(ne),l(T,{onClick:e[10]||(e[10]=s=>t.deleteDialog=!1)},{default:o(()=>[...e[54]||(e[54]=[i("Cancelar",-1)])]),_:1}),l(T,{color:"error",onClick:t.executeDelete,loading:t.deleting},{default:o(()=>[...e[55]||(e[55]=[i("Excluir",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l($,{modelValue:t.bulkDeleteDialog,"onUpdate:modelValue":e[13]||(e[13]=s=>t.bulkDeleteDialog=s),"max-width":"400"},{default:o(()=>[l(_,null,{default:o(()=>[l(A,null,{default:o(()=>[...e[56]||(e[56]=[i("Confirmar Exclusão em Lote",-1)])]),_:1}),l(D,null,{default:o(()=>[i(" Tem certeza que deseja excluir "+d(t.selectedLogs.length)+" logs selecionados? Esta ação não pode ser desfeita. ",1)]),_:1}),l(re,null,{default:o(()=>[l(ne),l(T,{onClick:e[12]||(e[12]=s=>t.bulkDeleteDialog=!1)},{default:o(()=>[...e[57]||(e[57]=[i("Cancelar",-1)])]),_:1}),l(T,{color:"error",onClick:t.executeBulkDelete,loading:t.deleting},{default:o(()=>[i(" Excluir "+d(t.selectedLogs.length)+" logs ",1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const to=Oe(Ie,[["render",Pt],["__scopeId","data-v-01f9f36f"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/webhooks/WebhooksView.vue"]]);export{to as default};
