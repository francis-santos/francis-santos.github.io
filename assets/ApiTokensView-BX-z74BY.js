import{f as D,G as Ue,q as a,x as ee,k as le,r as Se,j as G,w as Te,J as De,Q as S,T as o,S as d,a4 as r,a1 as m,Z as Oe,z as s,X as x,_ as V,F as Y,a8 as J,v as ze,E as Ne}from"./vendor-vue-BvKyvIVR.js";import{a as Q}from"./auth-PiWOMLtm.js";import{u as Ve,a as F}from"./VChip-BzUv3cXC.js";import{_ as re}from"./index-CQBjCOQw.js";import{V as de}from"./VDialog-C6XAQXKq.js";import{j as q,l as me,k as X,p as ue,f as O,i as se}from"./VGrid-CuJrScxf.js";import{V as I}from"./VIcon-CM-KW5Qw.js";import{V as Be}from"./VForm-BjI_k9Xt.js";import{d as he,j as Le,V as te,a as ke}from"./VSelect-JVxEisdn.js";import{V as je}from"./VTextarea-DdR9LUYO.js";import{V as W,a as w}from"./VRow-C_rLTo1r.js";import{b as Fe,V as _e,m as Me}from"./autofocus-Bh6bNAdk.js";import{f as qe}from"./forwardRefs-D_qxKlPu.js";import{g as Ge,p as He,s as Ye,f as We,O as Ke,o as Ze}from"./vendor-ui-Dz8XL-co.js";import{V as Ae,a as ie,c as ne}from"./VExpansionPanels-MFiv6H5c.js";import{V as $}from"./VAlert-ChhMmNH2.js";import{V as ce}from"./VSpacer-kp13s616.js";import{d as Je}from"./vendor-utils-Cfk84l6i.js";import{V as Qe}from"./VDataTable-BIdz-mlh.js";import{V as xe}from"./VTooltip-Bl0kBka4.js";import"./token-storage.service-BqAv9k07.js";import"./tag-Bnbpnddf.js";import"./VMenu-B2XC7rkF.js";import"./dimensions-DVh0fwa7.js";import"./lazy-DADzjSlN.js";import"./VList-CaAoEaF2.js";import"./ssrBoot-COakMcr6.js";import"./VPagination-C7VPvwfo.js";import"./VTable-BhCG_aMe.js";import"./filter-3ET2mAtK.js";const Xe=He({...Me(),...Ze(Le(),["inline"])},"VCheckbox"),we=Ge()({name:"VCheckbox",inheritAttrs:!1,props:Xe(),emits:{"update:modelValue":_=>!0,"update:focused":_=>!0},setup(_,e){let{attrs:n,slots:t}=e;const l=Ye(_,"modelValue"),{isFocused:c,focus:i,blur:v}=Fe(_),y=D(),h=Ue();return We(()=>{const[C,f]=Ke(n),T=_e.filterProps(_),b=he.filterProps(_);return a(_e,ee({ref:y,class:["v-checkbox",_.class]},C,T,{modelValue:l.value,"onUpdate:modelValue":E=>l.value=E,id:_.id||`checkbox-${h}`,focused:c.value,style:_.style}),{...t,default:E=>{let{id:P,messagesId:B,isDisabled:z,isReadonly:K,isValid:H}=E;return a(he,ee(b,{id:P.value,"aria-describedby":B.value,disabled:z.value,readonly:K.value},f,{error:H.value===!1,modelValue:l.value,"onUpdate:modelValue":k=>l.value=k,onFocus:i,onBlur:v}),t)}})}),qe({},y)}}),g={ANALYSIS:"analysis",WEBHOOKS:"webhooks",USERS:"users",ORGANIZATIONS:"organizations",REPOSITORIES:"repositories",RULES:"rules",LOGS:"logs",SETTINGS:"settings"},be=[{name:"analysis:read",label:"Ler Análises",description:"Visualizar análises de código e seus resultados",category:g.ANALYSIS},{name:"analysis:create",label:"Criar Análises",description:"Iniciar novas análises de código",category:g.ANALYSIS},{name:"analysis:update",label:"Atualizar Análises",description:"Modificar análises existentes",category:g.ANALYSIS},{name:"analysis:delete",label:"Excluir Análises",description:"Remover análises do sistema",category:g.ANALYSIS},{name:"webhooks:read",label:"Ler Webhooks",description:"Visualizar configurações e logs de webhooks",category:g.WEBHOOKS},{name:"webhooks:create",label:"Criar Webhooks",description:"Configurar novos webhooks",category:g.WEBHOOKS},{name:"webhooks:update",label:"Atualizar Webhooks",description:"Modificar configurações de webhooks",category:g.WEBHOOKS},{name:"webhooks:delete",label:"Excluir Webhooks",description:"Remover webhooks do sistema",category:g.WEBHOOKS},{name:"users:read",label:"Ler Usuários",description:"Visualizar informações de usuários",category:g.USERS},{name:"users:create",label:"Criar Usuários",description:"Adicionar novos usuários ao sistema",category:g.USERS},{name:"users:update",label:"Atualizar Usuários",description:"Modificar informações de usuários",category:g.USERS},{name:"users:delete",label:"Excluir Usuários",description:"Remover usuários do sistema",category:g.USERS},{name:"organizations:read",label:"Ler Organizações",description:"Visualizar informações de organizações",category:g.ORGANIZATIONS},{name:"organizations:update",label:"Atualizar Organizações",description:"Modificar configurações de organizações",category:g.ORGANIZATIONS},{name:"repositories:read",label:"Ler Repositórios",description:"Visualizar informações de repositórios",category:g.REPOSITORIES},{name:"repositories:create",label:"Criar Repositórios",description:"Adicionar novos repositórios",category:g.REPOSITORIES},{name:"repositories:update",label:"Atualizar Repositórios",description:"Modificar configurações de repositórios",category:g.REPOSITORIES},{name:"repositories:delete",label:"Excluir Repositórios",description:"Remover repositórios do sistema",category:g.REPOSITORIES},{name:"rules:read",label:"Ler Regras",description:"Visualizar regras de análise",category:g.RULES},{name:"rules:create",label:"Criar Regras",description:"Criar novas regras de análise",category:g.RULES},{name:"rules:update",label:"Atualizar Regras",description:"Modificar regras existentes",category:g.RULES},{name:"rules:delete",label:"Excluir Regras",description:"Remover regras do sistema",category:g.RULES},{name:"logs:read",label:"Ler Logs",description:"Visualizar logs do sistema",category:g.LOGS},{name:"settings:read",label:"Ler Configurações",description:"Visualizar configurações do sistema",category:g.SETTINGS},{name:"settings:update",label:"Atualizar Configurações",description:"Modificar configurações do sistema",category:g.SETTINGS}];class $e{async getTokens(e={}){const{isDemoUser:n,getMockData:t}=Ve();if(n.value){const c={};e.search&&e.search.trim()&&(c.search=e.search),e.active!==void 0&&e.active!==null&&(c.active=e.active),e.permissions&&e.permissions.length>0&&(c.permissions=e.permissions);const i=await t("apiTokens",e.page||1,e.limit||25,c);return{data:i.data,total:i.total,page:i.page,limit:i.limit,totalPages:Math.ceil(i.total/i.limit)}}const l=new URLSearchParams;return e.search&&l.append("search",e.search),e.active!==void 0&&l.append("active",e.active.toString()),e.permissions?.length&&e.permissions.forEach(c=>l.append("permissions",c)),e.page&&l.append("page",e.page.toString()),e.limit&&l.append("limit",e.limit.toString()),e.sortBy&&l.append("sortBy",e.sortBy),e.sortOrder&&l.append("sortOrder",e.sortOrder),await Q.get(`/auth/tokens?${l}`)}async getTokenDetails(e){return await Q.get(`/auth/tokens/${e}`)}async createToken(e){return await Q.post("/auth/tokens",e)}async updateToken(e,n){return await Q.put(`/auth/tokens/${e}`,n)}async revokeToken(e){await Q.delete(`/auth/tokens/${e}`)}async getCurrentUser(){return await Q.get("/auth/me")}async getTokenStats(e={}){const t=(await this.getTokens(e)).data,l=t.length,c=t.filter(T=>T.active).length,i=new Date,v=t.filter(T=>T.expiresAt&&new Date(T.expiresAt)<i).length,y=new Date;y.setDate(y.getDate()-7);const h=t.filter(T=>T.lastUsedAt&&new Date(T.lastUsedAt)>y).length,C=new Map;t.forEach(T=>{(T.permissions||[]).forEach(E=>{C.set(E,(C.get(E)||0)+1)})});const f=Array.from(C.entries()).map(([T,b])=>({permission:T,count:b}));return{total:l,active:c,expired:v,recentlyUsed:h,byPermissions:f}}getAvailablePermissions(){return be}getPermissionsByCategory(){const e={};return be.forEach(n=>{e[n.category]||(e[n.category]=[]),e[n.category].push(n)}),e}getPermissionCategories(){return[{name:g.ANALYSIS,label:"Análises"},{name:g.WEBHOOKS,label:"Webhooks"},{name:g.USERS,label:"Usuários"},{name:g.ORGANIZATIONS,label:"Organizações"},{name:g.REPOSITORIES,label:"Repositórios"},{name:g.RULES,label:"Regras"},{name:g.LOGS,label:"Logs"},{name:g.SETTINGS,label:"Configurações"}]}validateTokenName(e){return!e||e.trim().length===0?{isValid:!1,message:"Nome do token é obrigatório"}:e.length<3?{isValid:!1,message:"Nome deve ter pelo menos 3 caracteres"}:e.length>100?{isValid:!1,message:"Nome deve ter no máximo 100 caracteres"}:/^[a-zA-Z0-9\s\-_]+$/.test(e)?{isValid:!0}:{isValid:!1,message:"Nome pode conter apenas letras, números, espaços, hífens e underscores"}}validatePermissions(e){if(!e||e.length===0)return{isValid:!1,message:"Pelo menos uma permissão deve ser selecionada"};const n=be.map(l=>l.name),t=e.filter(l=>!n.includes(l));return t.length>0?{isValid:!1,message:`Permissões inválidas: ${t.join(", ")}`}:{isValid:!0}}validateExpirationDate(e){if(!e)return{isValid:!0};if(e<=new Date)return{isValid:!1,message:"Data de expiração deve ser no futuro"};const t=new Date;return t.setFullYear(t.getFullYear()+5),e>t?{isValid:!1,message:"Data de expiração não pode ser superior a 5 anos"}:{isValid:!0}}formatTokenForDisplay(e){if(e.length<=8)return e;const n=e.substring(0,4),t=e.substring(e.length-4),l="*".repeat(Math.min(e.length-8,20));return`${n}${l}${t}`}getTokenStatusColor(e){if(!e.active)return"error";if(e.expiresAt){const n=new Date,t=new Date(e.expiresAt);if(t<n)return"error";const l=new Date;if(l.setDate(l.getDate()+30),t<l)return"warning"}return"success"}getTokenStatusText(e){if(!e.active)return"Revogado";if(e.expiresAt){const n=new Date,t=new Date(e.expiresAt);if(t<n)return"Expirado";const l=new Date;if(l.setDate(l.getDate()+30),t<l)return"Expira em breve"}return"Ativo"}async exportTokens(e={},n="csv"){const l=(await this.getTokens(e)).data;if(n==="csv"){const c=this.convertToCSV(l);return new Blob([c],{type:"text/csv"})}else{const c=JSON.stringify(l,null,2);return new Blob([c],{type:"application/json"})}}convertToCSV(e){if(e.length===0)return"";const n=["ID","Nome","Descrição","Permissões","Status","Último Uso","IP do Último Uso","Data de Expiração","Data de Criação"],t=e.map(c=>[c.id,c.name,c.description||"",c.permissions.join("; "),this.getTokenStatusText(c),c.lastUsedAt||"Nunca usado",c.lastUsedIp||"N/A",c.expiresAt||"Sem expiração",c.createdAt]);return[n.join(","),...t.map(c=>c.map(i=>`"${i}"`).join(","))].join(`
`)}}const A=new $e,et=le({__name:"TokenFormDialog",props:{modelValue:{type:Boolean,required:!0},token:{type:[Object,null],required:!1,default:null}},emits:["update:modelValue","saved"],setup(_,{expose:e,emit:n}){e();const t=_,l=n,c=D(),i=D(!1),v=D(!1),y=D(!1),h=D(""),C=D(""),f=Se({name:"",description:"",permissions:[],expiresAt:void 0}),T=G({get(){return t.modelValue},set(p){l("update:modelValue",p)}}),b=G(()=>!!t.token),E=G(()=>{const p=new Date;return p.setDate(p.getDate()+1),p.toISOString().slice(0,16)}),P=G(()=>A.getPermissionCategories()),B=G(()=>A.getPermissionsByCategory()),z=[p=>!!p||"Nome é obrigatório",p=>{const U=A.validateTokenName(p);return U.isValid||U.message}],K=[p=>!p||p.length<=500||"Descrição deve ter no máximo 500 caracteres"],H=[p=>{if(!y.value)return!0;if(!p)return"Data de expiração é obrigatória";const U=new Date(p),L=A.validateExpirationDate(U);return L.isValid||L.message}];function k(){f.name="",f.description="",f.permissions=[],f.expiresAt=void 0,y.value=!1,h.value="",C.value="",i.value=!1,De(()=>{c.value?.resetValidation()})}function R(){if(t.token&&(f.name=t.token.name,f.description=t.token.description||"",f.permissions=[...t.token.permissions||[]],t.token.expiresAt)){y.value=!0;const p=new Date(t.token.expiresAt);h.value=p.toISOString().slice(0,16),f.expiresAt=p}}function N(){if(y.value){if(!h.value){const p=new Date;p.setFullYear(p.getFullYear()+1),h.value=p.toISOString().slice(0,16)}}else h.value="",f.expiresAt=void 0}function j(p){return B.value[p]||[]}function fe(p){return A.getAvailablePermissions().find(L=>L.name===p)?.label||p}function pe(p){const U=f.permissions.indexOf(p);U>-1&&f.permissions.splice(U,1)}async function ve(){if(!c.value)return;const{valid:p}=await c.value.validate();if(!p)return;const U=A.validatePermissions(f.permissions);if(!U.isValid){C.value=U.message||"Erro de validação";return}C.value="",y.value&&h.value&&(f.expiresAt=new Date(h.value));try{if(v.value=!0,b.value&&t.token){const L={name:f.name,description:f.description,permissions:f.permissions,expiresAt:f.expiresAt},ae=await A.updateToken(t.token.id,L);l("saved",ae)}else{const L=await A.createToken(f);l("saved",L)}T.value=!1}catch(L){console.error("Erro ao salvar token:",L)}finally{v.value=!1}}function ge(){T.value=!1}Te(()=>t.modelValue,p=>{p&&(b.value?R():k())}),Te(h,p=>{y.value&&p&&(f.expiresAt=new Date(p))});const oe={props:t,emit:l,form:c,valid:i,loading:v,hasExpiration:y,expirationDate:h,permissionError:C,formData:f,dialog:T,isEdit:b,minDate:E,permissionCategories:P,permissionsByCategory:B,nameRules:z,descriptionRules:K,expirationRules:H,resetForm:k,fillForm:R,handleExpirationToggle:N,getCategoryPermissions:j,getPermissionLabel:fe,removePermission:pe,handleSubmit:ve,handleCancel:ge};return Object.defineProperty(oe,"__isScriptSetup",{enumerable:!1,value:!0}),oe}}),tt={class:"mb-4"},ot={class:"pt-2"},at={class:"font-weight-medium"},st={class:"text-caption text-medium-emphasis"},it={key:0,class:"mb-4"},nt={class:"text-subtitle-2 font-weight-medium mb-2"},lt={class:"d-flex flex-wrap ga-1"};function rt(_,e,n,t,l,c){return d(),S(de,{modelValue:t.dialog,"onUpdate:modelValue":e[6]||(e[6]=i=>t.dialog=i),"max-width":"600",persistent:""},{default:o(()=>[a(q,null,{default:o(()=>[a(me,{class:"text-h6 d-flex align-center"},{default:o(()=>[a(I,{class:"me-2"},{default:o(()=>[r(m(t.isEdit?"mdi-pencil":"mdi-key-plus"),1)]),_:1}),r(" "+m(t.isEdit?"Editar Token":"Criar Novo Token"),1)]),_:1}),a(X,null,{default:o(()=>[a(Be,{ref:"form",modelValue:t.valid,"onUpdate:modelValue":e[5]||(e[5]=i=>t.valid=i),onSubmit:Oe(t.handleSubmit,["prevent"])},{default:o(()=>[a(te,{modelValue:t.formData.name,"onUpdate:modelValue":e[0]||(e[0]=i=>t.formData.name=i),label:"Nome do Token *",rules:t.nameRules,variant:"outlined",density:"comfortable",class:"mb-4",required:"",autofocus:""},null,8,["modelValue"]),a(je,{modelValue:t.formData.description,"onUpdate:modelValue":e[1]||(e[1]=i=>t.formData.description=i),label:"Descrição (opcional)",variant:"outlined",density:"comfortable",rows:"3",class:"mb-4",counter:"500",rules:t.descriptionRules},null,8,["modelValue"]),a(W,{class:"mb-4"},{default:o(()=>[a(w,{cols:"12",md:"6"},{default:o(()=>[a(we,{modelValue:t.hasExpiration,"onUpdate:modelValue":[e[2]||(e[2]=i=>t.hasExpiration=i),t.handleExpirationToggle],label:"Token com expiração",density:"comfortable"},null,8,["modelValue"])]),_:1}),t.hasExpiration?(d(),S(w,{key:0,cols:"12",md:"6"},{default:o(()=>[a(te,{modelValue:t.expirationDate,"onUpdate:modelValue":e[3]||(e[3]=i=>t.expirationDate=i),label:"Data de Expiração",type:"datetime-local",variant:"outlined",density:"comfortable",rules:t.expirationRules,min:t.minDate},null,8,["modelValue","min"])]),_:1})):V("",!0)]),_:1}),s("div",tt,[e[7]||(e[7]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"}," Permissões * ",-1)),e[8]||(e[8]=s("p",{class:"text-caption text-medium-emphasis mb-4"}," Selecione as permissões que este token terá acesso ",-1)),a(Ae,{variant:"accordion",multiple:""},{default:o(()=>[(d(!0),x(Y,null,J(t.permissionCategories,i=>(d(),S(ie,{key:i.name,title:i.label},{default:o(()=>[a(ne,null,{default:o(()=>[s("div",ot,[(d(!0),x(Y,null,J(t.getCategoryPermissions(i.name),v=>(d(),S(we,{key:v.name,modelValue:t.formData.permissions,"onUpdate:modelValue":e[4]||(e[4]=y=>t.formData.permissions=y),value:v.name,label:v.label,density:"comfortable",class:"mb-1"},{label:o(()=>[s("div",null,[s("div",at,m(v.label),1),s("div",st,m(v.description),1)])]),_:2},1032,["modelValue","value","label"]))),128))])]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}),t.permissionError?(d(),S($,{key:0,type:"error",variant:"outlined",class:"mt-3"},{default:o(()=>[r(m(t.permissionError),1)]),_:1})):V("",!0)]),t.formData.permissions.length>0?(d(),x("div",it,[s("h4",nt," Permissões Selecionadas ("+m(t.formData.permissions.length)+") ",1),s("div",lt,[(d(!0),x(Y,null,J(t.formData.permissions,i=>(d(),S(F,{key:i,size:"small",variant:"outlined",color:"primary",closable:"","onClick:close":v=>t.removePermission(i)},{default:o(()=>[r(m(t.getPermissionLabel(i)),1)]),_:2},1032,["onClick:close"]))),128))])])):V("",!0)]),_:1},8,["modelValue"])]),_:1}),a(ue,{class:"px-6 pb-6"},{default:o(()=>[a(ce),a(O,{onClick:t.handleCancel},{default:o(()=>[...e[9]||(e[9]=[r(" Cancelar ",-1)])]),_:1}),a(O,{color:"primary",loading:t.loading,disabled:!t.valid||t.formData.permissions.length===0,onClick:t.handleSubmit},{default:o(()=>[r(m(t.isEdit?"Salvar":"Criar Token"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const dt=re(et,[["render",rt],["__scopeId","data-v-0e3af2f4"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/auth/TokenFormDialog.vue"]]),mt=le({__name:"TokenDetailsDialog",props:{modelValue:{type:Boolean,required:!0},token:{type:[Object,null],required:!1,default:null}},emits:["update:modelValue"],setup(_,{expose:e,emit:n}){e();const t=_,l=n,c=D(!1),i=G({get(){return t.modelValue},set(k){l("update:modelValue",k)}}),v=G(()=>A.getPermissionCategories()),y=G(()=>A.getAvailablePermissions());function h(k){return A.getTokenStatusColor(k)}function C(k){return A.getTokenStatusText(k)}function f(k){switch(h(k)){case"success":return"mdi-check-circle";case"warning":return"mdi-alert-circle";case"error":return"mdi-close-circle";default:return"mdi-help-circle"}}function T(k){return new Date(k).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function b(k,R){const N=R||[];return y.value.filter(j=>j.category===k&&N.includes(j.name))}function E(k){return{"analysis:read":"mdi-file-search","analysis:create":"mdi-file-plus","analysis:update":"mdi-file-edit","analysis:delete":"mdi-file-remove","webhooks:read":"mdi-webhook","webhooks:create":"mdi-webhook","webhooks:update":"mdi-webhook","webhooks:delete":"mdi-webhook","users:read":"mdi-account-search","users:create":"mdi-account-plus","users:update":"mdi-account-edit","users:delete":"mdi-account-remove","organizations:read":"mdi-domain","organizations:update":"mdi-domain","repositories:read":"mdi-source-repository","repositories:create":"mdi-source-repository-multiple","repositories:update":"mdi-source-commit","repositories:delete":"mdi-source-repository-multiple","rules:read":"mdi-rule","rules:create":"mdi-plus","rules:update":"mdi-pencil","rules:delete":"mdi-delete","logs:read":"mdi-file-document-multiple","settings:read":"mdi-cog","settings:update":"mdi-cog"}[k]||"mdi-key"}function P(k){if(!k.expiresAt)return"";const R=new Date,N=new Date(k.expiresAt);if(N<R)return"text-error";const j=new Date;return j.setDate(j.getDate()+30),N<j?"text-warning":"text-success"}function B(k){return k.expiresAt?new Date(k.expiresAt)<new Date:!1}function z(k){return k.active?B(k)?"Este token expirou e não pode mais ser usado.":"Este token está inativo.":"Este token foi revogado e não pode mais ser usado."}async function K(k){try{await navigator.clipboard.writeText(k)}catch(R){console.error("Erro ao copiar:",R)}}const H={props:t,emit:l,showDebugInfo:c,dialog:i,permissionCategories:v,availablePermissions:y,getTokenStatusColor:h,getTokenStatusText:C,getTokenStatusIcon:f,formatDate:T,getCategoryPermissions:b,getPermissionIcon:E,getExpirationClass:P,isTokenExpired:B,getInactiveTokenMessage:z,copyToClipboard:K};return Object.defineProperty(H,"__isScriptSetup",{enumerable:!1,value:!0}),H}}),ut={class:"mb-6"},ct={class:"mb-4"},ft={class:"font-weight-medium"},pt={class:"mb-4"},vt={key:0,class:"mb-4"},gt={class:"mb-6"},kt={class:"mb-4"},xt={key:0},bt={key:1,class:"text-medium-emphasis"},yt={class:"mb-4"},Tt={key:0},ht={key:1,class:"text-medium-emphasis"},_t={class:"mb-6"},wt={class:"mb-4"},St={class:"mb-4"},Dt={class:"mb-4"},Vt={key:0},At={key:1,class:"text-medium-emphasis"},Ct={class:"mb-6"},Et={class:"text-subtitle-1 font-weight-medium mb-3"},It={key:0},Pt={class:"text-subtitle-2 font-weight-medium mb-2"},Rt={class:"d-flex flex-wrap ga-2 mb-3"},Ut={key:1,class:"text-medium-emphasis"},Ot={key:0,class:"mb-6"},zt={class:"mb-4"},Nt={class:"mb-4"};function Bt(_,e,n,t,l,c){return d(),S(de,{modelValue:t.dialog,"onUpdate:modelValue":e[3]||(e[3]=i=>t.dialog=i),"max-width":"800",scrollable:""},{default:o(()=>[n.token?(d(),S(q,{key:0},{default:o(()=>[a(me,{class:"text-h6 d-flex align-center"},{default:o(()=>[a(I,{class:"me-2"},{default:o(()=>[...e[4]||(e[4]=[r("mdi-key",-1)])]),_:1}),e[5]||(e[5]=r(" Detalhes do Token ",-1))]),_:1}),a(X,null,{default:o(()=>[s("div",ut,[e[9]||(e[9]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Informações Básicas",-1)),a(W,null,{default:o(()=>[a(w,{cols:"12",md:"6"},{default:o(()=>[s("div",ct,[e[6]||(e[6]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Nome",-1)),s("div",ft,m(n.token.name),1)])]),_:1}),a(w,{cols:"12",md:"6"},{default:o(()=>[s("div",pt,[e[7]||(e[7]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Status",-1)),a(F,{color:t.getTokenStatusColor(n.token),variant:"flat",size:"small"},{default:o(()=>[a(I,{start:"",size:"12"},{default:o(()=>[r(m(t.getTokenStatusIcon(n.token)),1)]),_:1}),r(" "+m(t.getTokenStatusText(n.token)),1)]),_:1},8,["color"])])]),_:1})]),_:1}),n.token.description?(d(),x("div",vt,[e[8]||(e[8]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Descrição",-1)),s("div",null,m(n.token.description),1)])):V("",!0)]),s("div",gt,[e[12]||(e[12]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Informações de Uso",-1)),a(W,null,{default:o(()=>[a(w,{cols:"12",md:"6"},{default:o(()=>[s("div",kt,[e[10]||(e[10]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Último Uso",-1)),n.token.lastUsedAt?(d(),x("div",xt,m(t.formatDate(n.token.lastUsedAt)),1)):(d(),x("div",bt,"Nunca usado"))])]),_:1}),a(w,{cols:"12",md:"6"},{default:o(()=>[s("div",yt,[e[11]||(e[11]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"IP do Último Uso",-1)),n.token.lastUsedIp?(d(),x("div",Tt,[a(F,{size:"small",variant:"outlined"},{default:o(()=>[r(m(n.token.lastUsedIp),1)]),_:1})])):(d(),x("div",ht,"N/A"))])]),_:1})]),_:1})]),s("div",_t,[e[16]||(e[16]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Datas",-1)),a(W,null,{default:o(()=>[a(w,{cols:"12",md:"4"},{default:o(()=>[s("div",wt,[e[13]||(e[13]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Criado em",-1)),s("div",null,m(t.formatDate(n.token.createdAt)),1)])]),_:1}),a(w,{cols:"12",md:"4"},{default:o(()=>[s("div",St,[e[14]||(e[14]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Atualizado em",-1)),s("div",null,m(t.formatDate(n.token.updatedAt)),1)])]),_:1}),a(w,{cols:"12",md:"4"},{default:o(()=>[s("div",Dt,[e[15]||(e[15]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Expira em",-1)),n.token.expiresAt?(d(),x("div",Vt,[s("span",{class:ze(t.getExpirationClass(n.token))},m(t.formatDate(n.token.expiresAt)),3)])):(d(),x("div",At,"Sem expiração"))])]),_:1})]),_:1})]),s("div",Ct,[s("h3",Et," Permissões ("+m((n.token.permissions||[]).length)+") ",1),(n.token.permissions||[]).length>0?(d(),x("div",It,[(d(!0),x(Y,null,J(t.permissionCategories,i=>(d(),x("div",{key:i.name,class:"mb-4"},[t.getCategoryPermissions(i.name,n.token.permissions||[]).length>0?(d(),x(Y,{key:0},[s("h4",Pt,m(i.label),1),s("div",Rt,[(d(!0),x(Y,null,J(t.getCategoryPermissions(i.name,n.token.permissions||[]),v=>(d(),S(F,{key:v.name,size:"small",variant:"outlined",color:"primary"},{default:o(()=>[a(I,{start:"",size:"16"},{default:o(()=>[r(m(t.getPermissionIcon(v.name)),1)]),_:2},1024),r(" "+m(v.label),1)]),_:2},1024))),128))])],64)):V("",!0)]))),128))])):(d(),x("div",Ut," Nenhuma permissão configurada "))]),t.showDebugInfo?(d(),x("div",Ot,[e[19]||(e[19]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Informações Técnicas",-1)),s("div",zt,[e[17]||(e[17]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Hash do Token",-1)),a(te,{"model-value":n.token.hashedToken,variant:"outlined",density:"compact",readonly:"","append-inner-icon":"mdi-content-copy","onClick:appendInner":e[0]||(e[0]=i=>t.copyToClipboard(n.token.hashedToken))},null,8,["model-value"])]),s("div",Nt,[e[18]||(e[18]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"ID do Usuário",-1)),a(F,{size:"small",variant:"outlined"},{default:o(()=>[r(m(n.token.userId),1)]),_:1})])])):V("",!0),t.isTokenExpired(n.token)||!n.token.active?(d(),S($,{key:1,type:"warning",variant:"outlined",class:"mb-4"},{title:o(()=>[...e[20]||(e[20]=[r(" Token Inativo ",-1)])]),default:o(()=>[s("div",null,m(t.getInactiveTokenMessage(n.token)),1)]),_:1})):V("",!0),a($,{type:"info",variant:"outlined",class:"mb-4"},{title:o(()=>[...e[21]||(e[21]=[r(" Como Usar ",-1)])]),default:o(()=>[e[22]||(e[22]=s("div",null,[r(" Para usar este token, adicione o header de autorização nas suas requisições: "),s("code",{class:"d-block mt-2 pa-2 bg-grey-lighten-4 rounded"}," Authorization: Bearer <seu-token> ")],-1))]),_:1})]),_:1}),a(ue,{class:"px-6 pb-6"},{default:o(()=>[t.showDebugInfo?V("",!0):(d(),S(O,{key:0,variant:"outlined",onClick:e[1]||(e[1]=i=>t.showDebugInfo=!0)},{default:o(()=>[...e[23]||(e[23]=[r(" Mostrar Info Técnica ",-1)])]),_:1})),a(ce),a(O,{onClick:e[2]||(e[2]=i=>t.dialog=!1)},{default:o(()=>[...e[24]||(e[24]=[r(" Fechar ",-1)])]),_:1})]),_:1})]),_:1})):V("",!0)]),_:1},8,["modelValue"])}const Lt=re(mt,[["render",Bt],["__scopeId","data-v-d30b9fae"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/auth/TokenDetailsDialog.vue"]]),jt=le({__name:"TokenCreatedDialog",props:{modelValue:{type:Boolean,required:!0},token:{type:[Object,null],required:!1,default:null},plainTextToken:{type:String,required:!1,default:""}},emits:["update:modelValue"],setup(_,{expose:e,emit:n}){e();const t=_,l=n,c=G({get(){return t.modelValue},set(b){l("update:modelValue",b)}});async function i(){try{await navigator.clipboard.writeText(t.plainTextToken)}catch(b){console.error("Erro ao copiar token:",b),v()}}function v(){De(()=>{const b=document.querySelector(".token-field input");b&&(b.select(),b.setSelectionRange(0,t.plainTextToken.length))})}function y(b){return A.getAvailablePermissions().find(P=>P.name===b)?.label||b}function h(b){return new Date(b).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function C(){if(!t.token||!t.plainTextToken)return;const b={name:t.token.name,description:t.token.description||"",token:t.plainTextToken,permissions:t.token.permissions,createdAt:t.token.createdAt,expiresAt:t.token.expiresAt||null,usage:{curl:`curl -H "Authorization: Bearer ${t.plainTextToken}" -H "Content-Type: application/json" http://localhost:3001/api/analysis`,javascript:`fetch('http://localhost:3001/api/analysis', {
  headers: {
    'Authorization': 'Bearer ${t.plainTextToken}',
    'Content-Type': 'application/json'
  }
})`}},E=JSON.stringify(b,null,2),P=new Blob([E],{type:"application/json"}),B=URL.createObjectURL(P),z=document.createElement("a");z.href=B,z.download=`mira-api-token-${t.token.name.toLowerCase().replace(/\s+/g,"-")}.json`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(B)}function f(){c.value=!1}const T={props:t,emit:l,dialog:c,copyToken:i,selectAllToken:v,getPermissionLabel:y,formatDate:h,downloadToken:C,handleContinue:f};return Object.defineProperty(T,"__isScriptSetup",{enumerable:!1,value:!0}),T}}),Ft={class:"mb-6"},Mt={class:"text-subtitle-1 font-weight-medium mb-3"},qt={class:"d-flex justify-center mb-4"},Gt={class:"mb-6"},Ht={class:"mb-3"},Yt={class:"font-weight-medium"},Wt={class:"mb-3"},Kt={key:0,class:"mb-3"},Zt={class:"mb-3"},Jt={class:"text-caption text-medium-emphasis mb-1"},Qt={class:"d-flex flex-wrap ga-1"},Xt={class:"mb-3"},$t={class:"mb-3"},eo={key:0},to={key:1,class:"text-medium-emphasis"},oo={class:"mb-6"},ao={class:"bg-grey-lighten-4 pa-3 rounded text-caption overflow-x-auto"},so={class:"bg-grey-lighten-4 pa-3 rounded text-caption overflow-x-auto"},io={class:"bg-grey-lighten-4 pa-3 rounded text-caption overflow-x-auto"};function no(_,e,n,t,l,c){return d(),S(de,{modelValue:t.dialog,"onUpdate:modelValue":e[0]||(e[0]=i=>t.dialog=i),"max-width":"600",persistent:""},{default:o(()=>[n.token?(d(),S(q,{key:0},{default:o(()=>[a(me,{class:"text-h6 d-flex align-center text-success"},{default:o(()=>[a(I,{class:"me-2",color:"success"},{default:o(()=>[...e[1]||(e[1]=[r("mdi-check-circle",-1)])]),_:1}),e[2]||(e[2]=r(" Token Criado com Sucesso! ",-1))]),_:1}),a(X,null,{default:o(()=>[a($,{type:"success",variant:"outlined",class:"mb-6"},{title:o(()=>[a(I,{class:"me-2"},{default:o(()=>[...e[3]||(e[3]=[r("mdi-party-popper",-1)])]),_:1}),e[4]||(e[4]=r(" Parabéns! ",-1))]),default:o(()=>[s("div",null,[e[5]||(e[5]=r(' Seu token de API "',-1)),s("strong",null,m(n.token.name),1),e[6]||(e[6]=r('" foi criado com sucesso. ',-1))])]),_:1}),s("div",Ft,[s("h3",Mt,[a(I,{class:"me-2"},{default:o(()=>[...e[7]||(e[7]=[r("mdi-key",-1)])]),_:1}),e[8]||(e[8]=r(" Seu Token de API ",-1))]),a($,{type:"info",variant:"outlined",class:"mb-4"},{title:o(()=>[a(I,{class:"me-2"},{default:o(()=>[...e[9]||(e[9]=[r("mdi-information",-1)])]),_:1}),e[10]||(e[10]=r(" Importante! ",-1))]),default:o(()=>[e[11]||(e[11]=s("div",null,[r(" Este é o único momento em que você poderá ver o token completo. "),s("strong",null,"Copie e salve-o em um local seguro"),r(", pois não será possível recuperá-lo posteriormente. ")],-1))]),_:1}),a(te,{"model-value":n.plainTextToken,label:"Token de API",variant:"outlined",readonly:"",type:"text",class:"token-field mb-4","append-inner-icon":"mdi-content-copy","onClick:appendInner":t.copyToken,onClick:t.selectAllToken},null,8,["model-value"]),s("div",qt,[a(O,{color:"primary","prepend-icon":"mdi-content-copy",onClick:t.copyToken},{default:o(()=>[...e[12]||(e[12]=[r(" Copiar Token ",-1)])]),_:1})])]),s("div",Gt,[e[20]||(e[20]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Detalhes do Token",-1)),a(W,null,{default:o(()=>[a(w,{cols:"12",md:"6"},{default:o(()=>[s("div",Ht,[e[13]||(e[13]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Nome",-1)),s("div",Yt,m(n.token.name),1)])]),_:1}),a(w,{cols:"12",md:"6"},{default:o(()=>[s("div",Wt,[e[16]||(e[16]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Status",-1)),a(F,{color:"success",variant:"flat",size:"small"},{default:o(()=>[a(I,{start:"",size:"12"},{default:o(()=>[...e[14]||(e[14]=[r("mdi-check-circle",-1)])]),_:1}),e[15]||(e[15]=r(" Ativo ",-1))]),_:1})])]),_:1})]),_:1}),n.token.description?(d(),x("div",Kt,[e[17]||(e[17]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Descrição",-1)),s("div",null,m(n.token.description),1)])):V("",!0),s("div",Zt,[s("div",Jt," Permissões ("+m(n.token.permissions.length)+") ",1),s("div",Qt,[(d(!0),x(Y,null,J(n.token.permissions.slice(0,5),i=>(d(),S(F,{key:i,size:"x-small",variant:"outlined",color:"primary"},{default:o(()=>[r(m(t.getPermissionLabel(i)),1)]),_:2},1024))),128)),n.token.permissions.length>5?(d(),S(F,{key:0,size:"x-small",variant:"outlined"},{default:o(()=>[r(" +"+m(n.token.permissions.length-5)+" mais ",1)]),_:1})):V("",!0)])]),a(W,null,{default:o(()=>[a(w,{cols:"12",md:"6"},{default:o(()=>[s("div",Xt,[e[18]||(e[18]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Criado em",-1)),s("div",null,m(t.formatDate(n.token.createdAt)),1)])]),_:1}),a(w,{cols:"12",md:"6"},{default:o(()=>[s("div",$t,[e[19]||(e[19]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Expira em",-1)),n.token.expiresAt?(d(),x("div",eo,m(t.formatDate(n.token.expiresAt)),1)):(d(),x("div",to,"Sem expiração"))])]),_:1})]),_:1})]),s("div",oo,[e[22]||(e[22]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Como Usar",-1)),a(Ae,{variant:"accordion"},{default:o(()=>[a(ie,{title:"Requisições HTTP"},{default:o(()=>[a(ne,null,{default:o(()=>[e[21]||(e[21]=s("p",{class:"mb-3"}," Para usar este token em suas requisições, adicione o header de autorização: ",-1)),s("pre",ao,[s("code",null,"Authorization: Bearer "+m(n.plainTextToken),1)])]),_:1})]),_:1}),a(ie,{title:"Exemplo com cURL"},{default:o(()=>[a(ne,null,{default:o(()=>[s("pre",so,[s("code",null,'curl -H "Authorization: Bearer '+m(n.plainTextToken)+`" \\
     -H "Content-Type: application/json" \\
     http://localhost:3001/api/analysis`,1)])]),_:1})]),_:1}),a(ie,{title:"Exemplo JavaScript"},{default:o(()=>[a(ne,null,{default:o(()=>[s("pre",io,[s("code",null,`fetch('http://localhost:3001/api/analysis', {
  headers: {
    'Authorization': 'Bearer `+m(n.plainTextToken)+`',
    'Content-Type': 'application/json'
  }
})`,1)])]),_:1})]),_:1})]),_:1})]),a($,{type:"warning",variant:"outlined",class:"mb-4"},{title:o(()=>[a(I,{class:"me-2"},{default:o(()=>[...e[23]||(e[23]=[r("mdi-shield-alert",-1)])]),_:1}),e[24]||(e[24]=r(" Dicas de Segurança ",-1))]),default:o(()=>[e[25]||(e[25]=s("ul",{class:"mb-0"},[s("li",null,"Nunca compartilhe seu token em repositórios públicos"),s("li",null,"Use variáveis de ambiente para armazenar tokens"),s("li",null,"Revogue tokens não utilizados regularmente"),s("li",null,"Configure tokens com permissões mínimas necessárias"),s("li",null,"Monitore o uso dos seus tokens na tela de gerenciamento")],-1))]),_:1})]),_:1}),a(ue,{class:"px-6 pb-6"},{default:o(()=>[a(ce),a(O,{variant:"outlined",onClick:t.downloadToken},{default:o(()=>[a(I,{start:""},{default:o(()=>[...e[26]||(e[26]=[r("mdi-download",-1)])]),_:1}),e[27]||(e[27]=r(" Baixar como Arquivo ",-1))]),_:1}),a(O,{color:"primary",onClick:t.handleContinue},{default:o(()=>[...e[28]||(e[28]=[r(" Continuar ",-1)])]),_:1})]),_:1})]),_:1})):V("",!0)]),_:1},8,["modelValue"])}const lo=re(jt,[["render",no],["__scopeId","data-v-576c7c12"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/auth/TokenCreatedDialog.vue"]]),ro=le({__name:"ApiTokensView",setup(_,{expose:e}){e();const{isDemoUser:n}=Ve(),t=D(!1),l=D([]),c=D({total:0,active:0,expired:0,recentlyUsed:0,byPermissions:[]}),i=D(!1),v=D(!1),y=D(!1),h=D(!1),C=D(null),f=D(null),T=D(null),b=D(""),E=D(!1),P=Se({search:"",active:void 0,page:1,limit:25,sortBy:"createdAt",sortOrder:"desc"}),B=[{title:"Todos",value:void 0},{title:"Ativos",value:!0},{title:"Inativos",value:!1}],z=[{title:"Nome",value:"name"},{title:"Data de Criação",value:"createdAt"},{title:"Último Uso",value:"lastUsedAt"},{title:"Data de Expiração",value:"expiresAt"}],K=[{title:"Crescente",value:"asc"},{title:"Decrescente",value:"desc"}],H=[{title:"Nome",key:"name",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Permissões",key:"permissions",sortable:!1},{title:"Último Uso",key:"lastUsedAt",sortable:!1},{title:"Expira em",key:"expiresAt",sortable:!1},{title:"Criado em",key:"createdAt",sortable:!1},{title:"Ações",key:"actions",sortable:!1,align:"end"}],k=Je(()=>{j()},500);async function R(){try{t.value=!0;const M=(await A.getTokens(P)).data||[];l.value=M.map(Z=>({...Z,active:typeof Z.active=="string"?Z.active==="true":!!Z.active}))}catch(u){console.error("Erro ao carregar tokens:",u)}finally{t.value=!1}}async function N(){try{const u=await A.getTokenStats(P);c.value=u}catch(u){console.error("Erro ao carregar estatísticas:",u)}}function j(){P.page=1,R(),N()}function fe(u){P.page=u,R()}function pe(u){C.value=u,v.value=!0}function ve(u){C.value=u,i.value=!0}function ge(u){f.value=u,h.value=!0}function oe(u){f.value=u,U()}async function p(){if(f.value)try{E.value=!0,await A.revokeToken(f.value.id);const u=l.value.findIndex(M=>M.id===f.value.id);u>-1&&l.value[u]&&(l.value[u].active=!1),await N(),h.value=!1,f.value=null}catch(u){console.error("Erro ao revogar token:",u)}finally{E.value=!1}}async function U(){if(f.value)try{E.value=!0,await A.updateToken(f.value.id,{active:!0});const u=l.value.findIndex(M=>M.id===f.value.id);u>-1&&l.value[u]&&(l.value[u].active=!0),await N(),f.value=null}catch(u){console.error("Erro ao reativar token:",u)}finally{E.value=!1}}function L(u){if(i.value=!1,C.value=null,"plainTextToken"in u)T.value=u.token,b.value=u.plainTextToken,y.value=!0,l.value.unshift(u.token);else{const M=l.value.findIndex(Z=>Z.id===u.id);M>-1&&(l.value[M]=u)}N()}function ae(u){return A.getTokenStatusColor(u)}function Ce(u){return A.getTokenStatusText(u)}function Ee(u){switch(ae(u)){case"success":return"mdi-check-circle";case"warning":return"mdi-alert-circle";case"error":return"mdi-close-circle";default:return"mdi-help-circle"}}function Ie(u){return A.getAvailablePermissions().find(Re=>Re.name===u)?.label||u}function Pe(u){return new Date(u).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}Ne(()=>{R(),N()});const ye={isDemoUser:n,loading:t,tokens:l,stats:c,showCreateDialog:i,showDetailsDialog:v,showTokenCreatedDialog:y,showRevokeDialog:h,selectedToken:C,tokenToRevoke:f,createdToken:T,plainTextToken:b,revoking:E,filters:P,statusOptions:B,sortOptions:z,orderOptions:K,headers:H,debouncedSearch:k,loadTokens:R,loadStats:N,applyFilters:j,handlePageChange:fe,viewToken:pe,editToken:ve,confirmRevokeToken:ge,confirmReactivateToken:oe,revokeToken:p,reactivateToken:U,handleTokenSaved:L,getTokenStatusColor:ae,getTokenStatusText:Ce,getTokenStatusIcon:Ee,getPermissionLabel:Ie,formatDate:Pe,TokenFormDialog:dt,TokenDetailsDialog:Lt,TokenCreatedDialog:lo};return Object.defineProperty(ye,"__isScriptSetup",{enumerable:!1,value:!0}),ye}}),mo={class:"api-tokens-view"},uo={class:"d-flex justify-space-between align-center mb-6"},co={class:"d-flex align-center"},fo={class:"text-h5 font-weight-bold"},po={class:"d-flex align-center"},vo={class:"text-h5 font-weight-bold"},go={class:"d-flex align-center"},ko={class:"text-h5 font-weight-bold"},xo={class:"d-flex align-center"},bo={class:"text-h5 font-weight-bold"},yo={class:"d-flex flex-column"},To={class:"font-weight-medium"},ho={key:0,class:"text-caption text-medium-emphasis"},_o={class:"d-flex flex-wrap ga-1"},wo={key:0,class:"d-flex flex-column"},So={class:"text-caption"},Do={key:0,class:"text-caption text-medium-emphasis"},Vo={key:1,class:"text-caption text-medium-emphasis"},Ao={key:0,class:"text-caption"},Co={key:1,class:"text-caption text-medium-emphasis"},Eo={class:"text-caption"},Io={class:"d-flex ga-1"},Po={key:0,class:"text-center pa-8"},Ro={class:"text-body-2 text-medium-emphasis mb-4"},Uo={class:"d-flex align-center mb-4"},Oo={class:"mb-0"};function zo(_,e,n,t,l,c){return d(),x("div",mo,[s("div",uo,[e[12]||(e[12]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold"},"Tokens de API"),s("p",{class:"text-subtitle-1 text-medium-emphasis mt-1"}," Gerencie tokens de acesso para integração com a API ")],-1)),t.isDemoUser?V("",!0):(d(),S(O,{key:0,color:"primary","prepend-icon":"mdi-key-plus",onClick:e[0]||(e[0]=i=>t.showCreateDialog=!0)},{default:o(()=>[...e[11]||(e[11]=[r(" Novo Token ",-1)])]),_:1}))]),a(W,{class:"mb-6"},{default:o(()=>[a(w,{cols:"12",sm:"6",md:"3"},{default:o(()=>[a(q,{class:"pa-4"},{default:o(()=>[s("div",co,[a(se,{color:"primary",class:"me-3"},{default:o(()=>[a(I,{color:"white"},{default:o(()=>[...e[13]||(e[13]=[r("mdi-key",-1)])]),_:1})]),_:1}),s("div",null,[s("div",fo,m(t.stats.total),1),e[14]||(e[14]=s("div",{class:"text-caption text-medium-emphasis"},"Total de Tokens",-1))])])]),_:1})]),_:1}),a(w,{cols:"12",sm:"6",md:"3"},{default:o(()=>[a(q,{class:"pa-4"},{default:o(()=>[s("div",po,[a(se,{color:"success",class:"me-3"},{default:o(()=>[a(I,{color:"white"},{default:o(()=>[...e[15]||(e[15]=[r("mdi-key-star",-1)])]),_:1})]),_:1}),s("div",null,[s("div",vo,m(t.stats.active),1),e[16]||(e[16]=s("div",{class:"text-caption text-medium-emphasis"},"Tokens Ativos",-1))])])]),_:1})]),_:1}),a(w,{cols:"12",sm:"6",md:"3"},{default:o(()=>[a(q,{class:"pa-4"},{default:o(()=>[s("div",go,[a(se,{color:"error",class:"me-3"},{default:o(()=>[a(I,{color:"white"},{default:o(()=>[...e[17]||(e[17]=[r("mdi-key-remove",-1)])]),_:1})]),_:1}),s("div",null,[s("div",ko,m(t.stats.expired),1),e[18]||(e[18]=s("div",{class:"text-caption text-medium-emphasis"},"Tokens Expirados",-1))])])]),_:1})]),_:1}),a(w,{cols:"12",sm:"6",md:"3"},{default:o(()=>[a(q,{class:"pa-4"},{default:o(()=>[s("div",xo,[a(se,{color:"info",class:"me-3"},{default:o(()=>[a(I,{color:"white"},{default:o(()=>[...e[19]||(e[19]=[r("mdi-clock-check",-1)])]),_:1})]),_:1}),s("div",null,[s("div",bo,m(t.stats.recentlyUsed),1),e[20]||(e[20]=s("div",{class:"text-caption text-medium-emphasis"},"Usados Recentemente",-1))])])]),_:1})]),_:1})]),_:1}),a(q,{class:"mb-6"},{default:o(()=>[a(X,null,{default:o(()=>[a(W,null,{default:o(()=>[a(w,{cols:"12",md:"4"},{default:o(()=>[a(te,{modelValue:t.filters.search,"onUpdate:modelValue":e[1]||(e[1]=i=>t.filters.search=i),label:"Buscar tokens","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:t.debouncedSearch},null,8,["modelValue","onInput"])]),_:1}),a(w,{cols:"12",md:"3"},{default:o(()=>[a(ke,{modelValue:t.filters.active,"onUpdate:modelValue":[e[2]||(e[2]=i=>t.filters.active=i),t.applyFilters],label:"Status",items:t.statusOptions,variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),a(w,{cols:"12",md:"3"},{default:o(()=>[a(ke,{modelValue:t.filters.sortBy,"onUpdate:modelValue":[e[3]||(e[3]=i=>t.filters.sortBy=i),t.applyFilters],label:"Ordenar por",items:t.sortOptions,variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(w,{cols:"12",md:"2"},{default:o(()=>[a(ke,{modelValue:t.filters.sortOrder,"onUpdate:modelValue":[e[4]||(e[4]=i=>t.filters.sortOrder=i),t.applyFilters],label:"Ordem",items:t.orderOptions,variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),a(q,null,{default:o(()=>[a(X,{class:"pa-0"},{default:o(()=>[a(Qe,{headers:t.headers,items:t.tokens,loading:t.loading,"items-per-page":t.filters.limit||25,class:"elevation-0","item-key":"id","onUpdate:page":t.handlePageChange},{"item.name":o(({item:i})=>[s("div",yo,[s("span",To,m(i.name),1),i.description?(d(),x("span",ho,m(i.description),1)):V("",!0)])]),"item.status":o(({item:i})=>[a(F,{color:t.getTokenStatusColor(i),variant:"flat",size:"small"},{default:o(()=>[a(I,{start:"",size:"12"},{default:o(()=>[r(m(t.getTokenStatusIcon(i)),1)]),_:2},1024),r(" "+m(t.getTokenStatusText(i)),1)]),_:2},1032,["color"])]),"item.permissions":o(({item:i})=>[s("div",_o,[(d(!0),x(Y,null,J((i.permissions||[]).slice(0,2),v=>(d(),S(F,{key:v,size:"x-small",variant:"outlined",class:"text-caption"},{default:o(()=>[r(m(t.getPermissionLabel(v)),1)]),_:2},1024))),128)),(i.permissions||[]).length>2?(d(),S(F,{key:0,size:"x-small",variant:"outlined",class:"text-caption"},{default:o(()=>[r(" +"+m((i.permissions||[]).length-2),1)]),_:2},1024)):V("",!0)])]),"item.lastUsedAt":o(({item:i})=>[i.lastUsedAt?(d(),x("div",wo,[s("span",So,m(t.formatDate(i.lastUsedAt)),1),i.lastUsedIp?(d(),x("span",Do,m(i.lastUsedIp),1)):V("",!0)])):(d(),x("span",Vo,"Nunca usado"))]),"item.expiresAt":o(({item:i})=>[i.expiresAt?(d(),x("span",Ao,m(t.formatDate(i.expiresAt)),1)):(d(),x("span",Co,"Sem expiração"))]),"item.createdAt":o(({item:i})=>[s("span",Eo,m(t.formatDate(i.createdAt)),1)]),"item.actions":o(({item:i})=>[s("div",Io,[a(xe,{text:"Ver detalhes",class:"custom-tooltip"},{activator:o(({props:v})=>[a(O,ee(v,{icon:"mdi-eye",variant:"text",size:"small",onClick:y=>t.viewToken(i)}),null,16,["onClick"])]),_:2},1024),t.isDemoUser?V("",!0):(d(),S(xe,{key:0,text:"Editar",class:"custom-tooltip"},{activator:o(({props:v})=>[a(O,ee(v,{icon:"mdi-pencil",variant:"text",size:"small",onClick:y=>t.editToken(i)}),null,16,["onClick"])]),_:2},1024)),t.isDemoUser?V("",!0):(d(),S(xe,{key:1,text:i.active?"Revogar":"Reativar",class:"custom-tooltip"},{activator:o(({props:v})=>[a(O,ee(v,{icon:i.active?"mdi-key-remove":"mdi-key-plus",variant:"text",size:"small",color:i.active?"error":"success",onClick:y=>i.active?t.confirmRevokeToken(i):t.confirmReactivateToken(i)}),null,16,["icon","color","onClick"])]),_:2},1032,["text"]))])]),bottom:o(()=>[t.tokens.length===0&&!t.loading?(d(),x("div",Po,[a(I,{size:"64",color:"grey-lighten-1",class:"mb-4"},{default:o(()=>[...e[21]||(e[21]=[r("mdi-key-outline",-1)])]),_:1}),e[23]||(e[23]=s("div",{class:"text-h6 text-medium-emphasis mb-2"},"Nenhum token encontrado",-1)),s("div",Ro,m(t.filters.search?"Tente ajustar os filtros de busca":"Crie seu primeiro token de API"),1),t.filters.search?V("",!0):(d(),S(O,{key:0,color:"primary","prepend-icon":"mdi-key-plus",onClick:e[5]||(e[5]=i=>t.showCreateDialog=!0)},{default:o(()=>[...e[22]||(e[22]=[r(" Criar Token ",-1)])]),_:1}))])):V("",!0)]),_:2},1032,["items","loading","items-per-page"])]),_:1})]),_:1}),a(t.TokenFormDialog,{modelValue:t.showCreateDialog,"onUpdate:modelValue":e[6]||(e[6]=i=>t.showCreateDialog=i),token:t.selectedToken,onSaved:t.handleTokenSaved},null,8,["modelValue","token"]),a(t.TokenDetailsDialog,{modelValue:t.showDetailsDialog,"onUpdate:modelValue":e[7]||(e[7]=i=>t.showDetailsDialog=i),token:t.selectedToken},null,8,["modelValue","token"]),a(t.TokenCreatedDialog,{modelValue:t.showTokenCreatedDialog,"onUpdate:modelValue":e[8]||(e[8]=i=>t.showTokenCreatedDialog=i),token:t.createdToken,"plain-text-token":t.plainTextToken},null,8,["modelValue","token","plain-text-token"]),a(de,{modelValue:t.showRevokeDialog,"onUpdate:modelValue":e[10]||(e[10]=i=>t.showRevokeDialog=i),"max-width":"400"},{default:o(()=>[a(q,null,{default:o(()=>[a(me,{class:"text-h6"},{default:o(()=>[...e[24]||(e[24]=[r(" Revogar Token ",-1)])]),_:1}),a(X,null,{default:o(()=>[s("div",Uo,[a(I,{color:"warning",size:"24",class:"me-3"},{default:o(()=>[...e[25]||(e[25]=[r("mdi-alert",-1)])]),_:1}),e[26]||(e[26]=s("span",null,"Esta ação não pode ser desfeita",-1))]),s("p",Oo,[e[27]||(e[27]=r(" Tem certeza que deseja revogar o token ",-1)),s("strong",null,'"'+m(t.tokenToRevoke?.name)+'"',1),e[28]||(e[28]=r("? ",-1))]),e[29]||(e[29]=s("p",{class:"text-caption text-medium-emphasis mt-2"}," Todas as aplicações que usam este token perderão acesso imediatamente. ",-1))]),_:1}),a(ue,null,{default:o(()=>[a(ce),a(O,{onClick:e[9]||(e[9]=i=>t.showRevokeDialog=!1)},{default:o(()=>[...e[30]||(e[30]=[r(" Cancelar ",-1)])]),_:1}),a(O,{color:"error",loading:t.revoking,onClick:t.revokeToken},{default:o(()=>[...e[31]||(e[31]=[r(" Revogar ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const fa=re(ro,[["render",zo],["__scopeId","data-v-8961ca3f"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/auth/ApiTokensView.vue"]]);export{fa as default};
