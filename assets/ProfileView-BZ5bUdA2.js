import{k as ue,f,j as _,E as fe,_ as g,z as s,$ as y,a0 as b,q as o,a1 as l,a8 as n,a9 as E,F as ce,ae as pe,W as m,a2 as u}from"./vendor-vue-BOgiBTV5.js";import{u as ve}from"./auth-Dt5LZyuD.js";import{u as we,V as S}from"./VChip-rM5LjFon.js";import{_ as ge,b as x,a as c}from"./index-CPKBv9AR.js";import{V as be}from"./VAlert-qYEn-PTR.js";import{a as d,V as U}from"./VRow-xKwg0MSP.js";import{V,a as P,b as D,e as h,d as Ve}from"./VGrid-BsndwDIl.js";import{V as L}from"./VForm-pUagEOzw.js";import{V as p}from"./VTextField-DiiVGj7F.js";import{V as j}from"./VSelect-BBg-Hfm2.js";import{V as De}from"./VTextarea-ndrXJOcn.js";import{a as ye,b as xe,c as Pe,d as _e}from"./VList-BKPY6TWC.js";import"./vendor-utils-C9OYYH06.js";import"./token-storage.service-BqAv9k07.js";import"./index-DzEvJ-T3.js";import"./vendor-ui-BR0KSDoQ.js";import"./autofocus-DZuUxpyU.js";import"./VMenu-vHpHdbAo.js";import"./dialog-transition-BRPqoOP4.js";import"./ssrBoot-Cswv876e.js";const Ue=ue({__name:"ProfileView",setup(z,{expose:a}){a();const r=ve(),{isDemoUser:e}=we(),v=f(!1),k=f(!1),i=f(!1),R=f(null),w=f({fullName:"",username:"",email:"",phone:"",language:"pt-BR",timezone:"America/Sao_Paulo",bio:"",avatarUrl:""}),A=f({currentPassword:"",newPassword:"",confirmPassword:""}),C=f({current:!1,new:!1,confirm:!1}),M=_(()=>r.userRole),O=_(()=>r.user?.organizationName),Y=_(()=>r.user?.createdAt||new Date),q=_(()=>r.user?.lastLoginAt||new Date),G=f([{id:"1",type:"login",description:"Login realizado com sucesso (Conta Demo)",timestamp:new Date(Date.now()-7200*1e3),location:"São Paulo, SP"},{id:"2",type:"analysis",description:"Visualização de análise do repositório projeto-frontend-react",timestamp:new Date(Date.now()-14400*1e3),location:null},{id:"3",type:"profile",description:"Acesso à tela de perfil (modo demonstração)",timestamp:new Date(Date.now()-1440*60*1e3),location:null},{id:"4",type:"token",description:"Visualização de tokens de API (modo demonstração)",timestamp:new Date(Date.now()-4320*60*1e3),location:null}]),H=f({totalAnalyses:e.value?15:47,totalRepositories:e.value?3:8,totalRules:e.value?8:12,totalTokens:e.value?10:3}),J=[{title:"Português (Brasil)",value:"pt-BR"},{title:"English (US)",value:"en-US"},{title:"Español",value:"es-ES"}],W=[{title:"Brasília (UTC-3)",value:"America/Sao_Paulo"},{title:"Nova York (UTC-5)",value:"America/New_York"},{title:"Londres (UTC+0)",value:"Europe/London"}],Z=[t=>!!t||"Nome é obrigatório",t=>t.length>=2||"Nome deve ter pelo menos 2 caracteres"],K=[t=>!!t||"Nome de usuário é obrigatório",t=>t.length>=3||"Nome de usuário deve ter pelo menos 3 caracteres",t=>/^[a-zA-Z0-9._-]+$/.test(t)||"Apenas letras, números, pontos, hífens e sublinhados"],Q=[t=>!!t||"E-mail é obrigatório",t=>/.+@.+\..+/.test(t)||"E-mail deve ser válido"],X=[t=>!!t||"Senha atual é obrigatória"],$=[t=>!!t||"Nova senha é obrigatória",t=>t.length>=8||"Senha deve ter pelo menos 8 caracteres"],ee=[t=>!!t||"Confirmação de senha é obrigatória",t=>t===A.value.newPassword||"Senhas não conferem"];function N(){e.value?w.value={fullName:"João Silva Demo",username:"joao.demo",email:"demo@test.mira-api.com",phone:"(11) 99999-0000",language:"pt-BR",timezone:"America/Sao_Paulo",bio:"Usuário de demonstração do sistema Mira. Esta conta é utilizada para apresentar as funcionalidades da plataforma.",avatarUrl:"https://avatar.iran.liara.run/public/boy?username=joao"}:r.user&&(w.value={fullName:r.user.fullName||"",username:r.user.username||"",email:r.user.email||"",phone:r.user.phone||"",language:r.user.language||"pt-BR",timezone:r.user.timezone||"America/Sao_Paulo",bio:r.user.bio||"",avatarUrl:r.user.avatarUrl||""})}async function ae(){if(k.value){v.value=!0;try{await new Promise(t=>setTimeout(t,1e3)),await r.updateProfile(w.value)}catch(t){console.error("Erro ao salvar perfil:",t)}finally{v.value=!1}}}async function oe(){if(i.value){v.value=!0;try{await new Promise(t=>setTimeout(t,1e3)),A.value={currentPassword:"",newPassword:"",confirmPassword:""},C.value={current:!1,new:!1,confirm:!1}}catch(t){console.error("Erro ao alterar senha:",t)}finally{v.value=!1}}}function le(){R.value?.click()}function te(t){const T=t.target.files?.[0];if(T){const B=new FileReader;B.onload=me=>{w.value.avatarUrl=me.target?.result},B.readAsDataURL(T)}}function ie(){w.value.avatarUrl=""}function se(t){return t.split(" ").map(F=>F[0]).join("").toUpperCase().slice(0,2)}function ne(t){return new Date(t).toLocaleString("pt-BR")}function re(t){switch(t){case"login":return"success";case"analysis":return"primary";case"profile":return"info";case"token":return"warning";default:return"grey"}}function de(t){switch(t){case"login":return"mdi-login";case"analysis":return"mdi-chart-line";case"profile":return"mdi-account-edit";case"token":return"mdi-key";default:return"mdi-circle"}}fe(()=>{N()});const I={authStore:r,isDemoUser:e,loading:v,profileFormValid:k,passwordFormValid:i,avatarInput:R,profileData:w,passwordData:A,showPasswords:C,userRole:M,organizationName:O,memberSince:Y,lastLogin:q,recentActivity:G,userStats:H,languageOptions:J,timezoneOptions:W,nameRules:Z,usernameRules:K,emailRules:Q,currentPasswordRules:X,newPasswordRules:$,confirmPasswordRules:ee,loadProfileData:N,saveProfile:ae,changePassword:oe,uploadAvatar:le,handleAvatarUpload:te,removeAvatar:ie,getUserInitials:se,formatDate:ne,getActivityColor:re,getActivityIcon:de};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}}),ke={class:"profile-page"},Ae={class:"d-flex align-center mb-6"},Se={key:0,class:"d-flex justify-end mt-4"},he={key:0,class:"d-flex justify-end mt-4"},ze={class:"mb-4"},Re={key:1,class:"text-h3 font-weight-bold"},Ce={class:"text-h6 font-weight-medium mb-1"},Ne={class:"text-body-2 text-medium-emphasis mb-2"},Ie={key:0,class:"d-flex justify-center gap-2"},Fe={class:"text-center"},Te={class:"text-h6 font-weight-medium mb-2"},Be={class:"mt-3 text-body-2 text-medium-emphasis"},Ee={class:"mb-1"},Le={class:"text-center"},je={class:"text-h5 font-weight-bold text-primary"},Me={class:"text-center"},Oe={class:"text-h5 font-weight-bold text-success"},Ye={class:"text-center"},qe={class:"text-h5 font-weight-bold text-warning"},Ge={class:"text-center"},He={class:"text-h5 font-weight-bold text-info"};function Je(z,a,r,e,v,k){return u(),g("div",ke,[s("div",Ae,[o(x,{icon:"mdi-arrow-left",variant:"text",onClick:a[0]||(a[0]=i=>z.$router.go(-1)),class:"me-3"}),a[16]||(a[16]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold text-high-emphasis mb-1"}," Meu Perfil "),s("p",{class:"text-body-1 text-medium-emphasis"}," Gerencie suas informações pessoais e configurações da conta ")],-1))]),e.isDemoUser?(u(),y(be,{key:0,type:"info",variant:"tonal",class:"mb-6","prepend-icon":"mdi-information",closable:""},{default:l(()=>[...a[17]||(a[17]=[s("div",{class:"text-body-1 font-weight-medium"},"Conta de Demonstração",-1),s("div",{class:"text-body-2 mt-1"}," Você está visualizando uma conta de demonstração. Os dados exibidos são fictícios e as funcionalidades de edição estão desabilitadas. ",-1)])]),_:1})):b("",!0),o(U,null,{default:l(()=>[o(d,{cols:"12",lg:"8"},{default:l(()=>[o(V,{elevation:"2",class:"mb-6"},{default:l(()=>[o(P,{class:"d-flex align-center"},{default:l(()=>[o(c,{class:"me-2"},{default:l(()=>[...a[18]||(a[18]=[n("mdi-account-circle",-1)])]),_:1}),a[19]||(a[19]=n(" Informações Pessoais ",-1))]),_:1}),o(D,null,{default:l(()=>[o(L,{ref:"profileForm",modelValue:e.profileFormValid,"onUpdate:modelValue":a[8]||(a[8]=i=>e.profileFormValid=i),onSubmit:E(e.saveProfile,["prevent"])},{default:l(()=>[o(U,null,{default:l(()=>[o(d,{cols:"12",md:"6"},{default:l(()=>[o(p,{modelValue:e.profileData.fullName,"onUpdate:modelValue":a[1]||(a[1]=i=>e.profileData.fullName=i),label:"Nome Completo",rules:e.nameRules,variant:"outlined","prepend-inner-icon":"mdi-account",disabled:e.loading||e.isDemoUser},null,8,["modelValue","disabled"])]),_:1}),o(d,{cols:"12",md:"6"},{default:l(()=>[o(p,{modelValue:e.profileData.username,"onUpdate:modelValue":a[2]||(a[2]=i=>e.profileData.username=i),label:"Nome de Usuário",rules:e.usernameRules,variant:"outlined","prepend-inner-icon":"mdi-at",disabled:e.loading||e.isDemoUser},null,8,["modelValue","disabled"])]),_:1}),o(d,{cols:"12",md:"6"},{default:l(()=>[o(p,{modelValue:e.profileData.email,"onUpdate:modelValue":a[3]||(a[3]=i=>e.profileData.email=i),label:"E-mail",type:"email",rules:e.emailRules,variant:"outlined","prepend-inner-icon":"mdi-email",disabled:e.loading||e.isDemoUser},null,8,["modelValue","disabled"])]),_:1}),o(d,{cols:"12",md:"6"},{default:l(()=>[o(p,{modelValue:e.profileData.phone,"onUpdate:modelValue":a[4]||(a[4]=i=>e.profileData.phone=i),label:"Telefone",variant:"outlined","prepend-inner-icon":"mdi-phone",disabled:e.loading||e.isDemoUser},null,8,["modelValue","disabled"])]),_:1}),o(d,{cols:"12",md:"6"},{default:l(()=>[o(j,{modelValue:e.profileData.language,"onUpdate:modelValue":a[5]||(a[5]=i=>e.profileData.language=i),items:e.languageOptions,label:"Idioma",variant:"outlined","prepend-inner-icon":"mdi-translate",disabled:e.loading||e.isDemoUser},null,8,["modelValue","disabled"])]),_:1}),o(d,{cols:"12",md:"6"},{default:l(()=>[o(j,{modelValue:e.profileData.timezone,"onUpdate:modelValue":a[6]||(a[6]=i=>e.profileData.timezone=i),items:e.timezoneOptions,label:"Fuso Horário",variant:"outlined","prepend-inner-icon":"mdi-clock-outline",disabled:e.loading||e.isDemoUser},null,8,["modelValue","disabled"])]),_:1}),o(d,{cols:"12"},{default:l(()=>[o(De,{modelValue:e.profileData.bio,"onUpdate:modelValue":a[7]||(a[7]=i=>e.profileData.bio=i),label:"Biografia",rows:"3",variant:"outlined","prepend-inner-icon":"mdi-text",disabled:e.loading||e.isDemoUser},null,8,["modelValue","disabled"])]),_:1})]),_:1}),e.isDemoUser?b("",!0):(u(),g("div",Se,[o(x,{type:"submit",color:"primary",loading:e.loading,disabled:!e.profileFormValid,"prepend-icon":"mdi-content-save"},{default:l(()=>[...a[20]||(a[20]=[n(" Salvar Alterações ",-1)])]),_:1},8,["loading","disabled"])]))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(V,{elevation:"2",class:"mb-6"},{default:l(()=>[o(P,{class:"d-flex align-center"},{default:l(()=>[o(c,{class:"me-2"},{default:l(()=>[...a[21]||(a[21]=[n("mdi-shield-account",-1)])]),_:1}),a[22]||(a[22]=n(" Segurança da Conta ",-1))]),_:1}),o(D,null,{default:l(()=>[o(L,{ref:"passwordForm",modelValue:e.passwordFormValid,"onUpdate:modelValue":a[15]||(a[15]=i=>e.passwordFormValid=i),onSubmit:E(e.changePassword,["prevent"])},{default:l(()=>[o(U,null,{default:l(()=>[o(d,{cols:"12",md:"4"},{default:l(()=>[o(p,{modelValue:e.passwordData.currentPassword,"onUpdate:modelValue":a[9]||(a[9]=i=>e.passwordData.currentPassword=i),label:"Senha Atual",type:e.showPasswords.current?"text":"password",rules:e.currentPasswordRules,variant:"outlined","prepend-inner-icon":"mdi-lock","append-inner-icon":e.showPasswords.current?"mdi-eye-off":"mdi-eye","onClick:appendInner":a[10]||(a[10]=i=>e.showPasswords.current=!e.showPasswords.current),disabled:e.loading||e.isDemoUser},null,8,["modelValue","type","append-inner-icon","disabled"])]),_:1}),o(d,{cols:"12",md:"4"},{default:l(()=>[o(p,{modelValue:e.passwordData.newPassword,"onUpdate:modelValue":a[11]||(a[11]=i=>e.passwordData.newPassword=i),label:"Nova Senha",type:e.showPasswords.new?"text":"password",rules:e.newPasswordRules,variant:"outlined","prepend-inner-icon":"mdi-lock-plus","append-inner-icon":e.showPasswords.new?"mdi-eye-off":"mdi-eye","onClick:appendInner":a[12]||(a[12]=i=>e.showPasswords.new=!e.showPasswords.new),disabled:e.loading||e.isDemoUser},null,8,["modelValue","type","append-inner-icon","disabled"])]),_:1}),o(d,{cols:"12",md:"4"},{default:l(()=>[o(p,{modelValue:e.passwordData.confirmPassword,"onUpdate:modelValue":a[13]||(a[13]=i=>e.passwordData.confirmPassword=i),label:"Confirmar Nova Senha",type:e.showPasswords.confirm?"text":"password",rules:e.confirmPasswordRules,variant:"outlined","prepend-inner-icon":"mdi-lock-check","append-inner-icon":e.showPasswords.confirm?"mdi-eye-off":"mdi-eye","onClick:appendInner":a[14]||(a[14]=i=>e.showPasswords.confirm=!e.showPasswords.confirm),disabled:e.loading||e.isDemoUser},null,8,["modelValue","type","append-inner-icon","disabled"])]),_:1})]),_:1}),e.isDemoUser?b("",!0):(u(),g("div",he,[o(x,{type:"submit",color:"secondary",loading:e.loading,disabled:!e.passwordFormValid,"prepend-icon":"mdi-key-change"},{default:l(()=>[...a[23]||(a[23]=[n(" Alterar Senha ",-1)])]),_:1},8,["loading","disabled"])]))]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(V,{elevation:"2"},{default:l(()=>[o(P,{class:"d-flex align-center"},{default:l(()=>[o(c,{class:"me-2"},{default:l(()=>[...a[24]||(a[24]=[n("mdi-history",-1)])]),_:1}),a[25]||(a[25]=n(" Atividade da Conta ",-1))]),_:1}),o(D,null,{default:l(()=>[o(ye,null,{default:l(()=>[(u(!0),g(ce,null,pe(e.recentActivity,i=>(u(),y(xe,{key:i.id,class:"px-0"},{prepend:l(()=>[o(h,{color:e.getActivityColor(i.type),size:"40"},{default:l(()=>[o(c,{icon:e.getActivityIcon(i.type),color:"white"},null,8,["icon"])]),_:2},1032,["color"])]),default:l(()=>[o(Pe,null,{default:l(()=>[n(m(i.description),1)]),_:2},1024),o(_e,null,{default:l(()=>[n(m(e.formatDate(i.timestamp))+" ",1),i.location?(u(),y(S,{key:0,size:"x-small",variant:"outlined",class:"ml-2"},{default:l(()=>[n(m(i.location),1)]),_:2},1024)):b("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),o(d,{cols:"12",lg:"4"},{default:l(()=>[o(V,{elevation:"2",class:"mb-6"},{default:l(()=>[o(D,{class:"text-center"},{default:l(()=>[s("div",ze,[o(h,{size:"120",class:"mb-3"},{default:l(()=>[e.profileData.avatarUrl?(u(),y(Ve,{key:0,src:e.profileData.avatarUrl,alt:e.profileData.fullName},null,8,["src","alt"])):(u(),g("span",Re,m(e.getUserInitials(e.profileData.fullName||e.profileData.username||"U")),1))]),_:1}),s("div",Ce,m(e.profileData.fullName||e.profileData.username),1),s("div",Ne,m(e.profileData.email),1),o(S,{size:"small",color:"primary",variant:"tonal"},{default:l(()=>[n(m(e.userRole||"Usuário"),1)]),_:1})]),e.isDemoUser?b("",!0):(u(),g("div",Ie,[o(x,{color:"primary",variant:"outlined",size:"small","prepend-icon":"mdi-camera",onClick:e.uploadAvatar,disabled:e.loading},{default:l(()=>[...a[26]||(a[26]=[n(" Alterar Foto ",-1)])]),_:1},8,["disabled"]),e.profileData.avatarUrl?(u(),y(x,{key:0,color:"error",variant:"outlined",size:"small",icon:"mdi-delete",onClick:e.removeAvatar,disabled:e.loading},null,8,["disabled"])):b("",!0)]))]),_:1})]),_:1}),o(V,{elevation:"2",class:"mb-6"},{default:l(()=>[o(P,{class:"d-flex align-center"},{default:l(()=>[o(c,{class:"me-2"},{default:l(()=>[...a[27]||(a[27]=[n("mdi-domain",-1)])]),_:1}),a[28]||(a[28]=n(" Organização ",-1))]),_:1}),o(D,null,{default:l(()=>[s("div",Fe,[o(h,{size:"64",color:"primary",class:"mb-3"},{default:l(()=>[o(c,{size:"32",color:"white"},{default:l(()=>[...a[29]||(a[29]=[n("mdi-domain",-1)])]),_:1})]),_:1}),s("div",Te,m(e.organizationName||"Organização"),1),o(S,{size:"small",variant:"tonal",color:"success"},{default:l(()=>[...a[30]||(a[30]=[n(" Membro Ativo ",-1)])]),_:1}),s("div",Be,[s("div",Ee,[o(c,{size:"16",class:"me-1"},{default:l(()=>[...a[31]||(a[31]=[n("mdi-calendar",-1)])]),_:1}),n(" Membro desde: "+m(e.formatDate(e.memberSince)),1)]),s("div",null,[o(c,{size:"16",class:"me-1"},{default:l(()=>[...a[32]||(a[32]=[n("mdi-clock-outline",-1)])]),_:1}),n(" Último acesso: "+m(e.formatDate(e.lastLogin)),1)])])])]),_:1})]),_:1}),o(V,{elevation:"2"},{default:l(()=>[o(P,{class:"d-flex align-center"},{default:l(()=>[o(c,{class:"me-2"},{default:l(()=>[...a[33]||(a[33]=[n("mdi-chart-box",-1)])]),_:1}),a[34]||(a[34]=n(" Estatísticas ",-1))]),_:1}),o(D,null,{default:l(()=>[o(U,null,{default:l(()=>[o(d,{cols:"6"},{default:l(()=>[s("div",Le,[s("div",je,m(e.userStats.totalAnalyses),1),a[35]||(a[35]=s("div",{class:"text-caption text-medium-emphasis"},"Análises",-1))])]),_:1}),o(d,{cols:"6"},{default:l(()=>[s("div",Me,[s("div",Oe,m(e.userStats.totalRepositories),1),a[36]||(a[36]=s("div",{class:"text-caption text-medium-emphasis"},"Repositórios",-1))])]),_:1}),o(d,{cols:"6"},{default:l(()=>[s("div",Ye,[s("div",qe,m(e.userStats.totalRules),1),a[37]||(a[37]=s("div",{class:"text-caption text-medium-emphasis"},"Regras",-1))])]),_:1}),o(d,{cols:"6"},{default:l(()=>[s("div",Ge,[s("div",He,m(e.userStats.totalTokens),1),a[38]||(a[38]=s("div",{class:"text-caption text-medium-emphasis"},"Tokens",-1))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s("input",{ref:"avatarInput",type:"file",accept:"image/*",style:{display:"none"},onChange:e.handleAvatarUpload},null,544)])}const pa=ge(Ue,[["render",Je],["__scopeId","data-v-4730dd15"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/profile/ProfileView.vue"]]);export{pa as default};
