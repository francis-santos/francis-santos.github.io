import{j as le,d as k,r as re,w as X,D as de,$ as D,a1 as t,_ as z,n as e,y as i,V as m,a6 as $e,aa as s,a0 as C,u as p,ac as Oe,ad as De,Z as q,h as ue,U as Se,Y as Ue,v as te}from"./vendor-vue-BKuzT1x2.js";import{o as V}from"./organizations-Hcfct8HQ.js";import{u as me}from"./useDemoMode-DpDjlFnd.js";import{V as ie}from"./VDialog-BfRWf8LZ.js";import{a as v,b as x,_ as se}from"./index-gFSB3kms.js";import{V as Te}from"./VForm-DthKd8zl.js";import{V as B,a as g}from"./VRow-C_u8820H.js";import{V as A,a as E,b as S,e as ce,c as _e}from"./VGrid-CBGRWS1y.js";import{V as j,a as Q}from"./VSelect-BorMXFwi.js";import{V as Ee}from"./VList-Dg4abNUz.js";import{V as ve}from"./VSwitch-D3bnvThN.js";import{V as Ie}from"./VTextarea-CqCSgYZa.js";import{a as U,b as Pe,V as Fe}from"./VChip-BfcyEr4e.js";import{d as ne}from"./vendor-utils-6xD0fNU8.js";import{V as Re}from"./VDataTable-CaN6duAr.js";import{V as Be}from"./VSkeletonLoader-oSDEuG7l.js";import{V as ae}from"./VTooltip-BVPiCKg9.js";import{V as Ne}from"./VAlert-BZmB2o6G.js";import{V as Le}from"./VSpacer-CTPiANoM.js";import"./auth.service-BozCwdnf.js";import"./token-storage.service-BqAv9k07.js";import"./auth--EmZq-C7.js";import"./vendor-ui-Ca7vMALJ.js";import"./dialog-transition-B8nu4acL.js";import"./form-PEXhLZdP.js";import"./autofocus-Cv2p5X6o.js";import"./VMenu-BCjbZdow.js";import"./ssrBoot-DJyMk-ri.js";import"./VPagination-B83tja3x.js";import"./VTable-SZOAnLd3.js";import"./filter-BaTOFc6H.js";const qe={class:"dialog-header"},je={class:"dialog-header-content"},Me={class:"dialog-icon-wrapper"},Ze={class:"dialog-title-section"},We={class:"dialog-title"},Ge={class:"dialog-subtitle"},Qe={class:"dialog-content"},Ye={key:0,class:"mb-3"},He={class:"text-body-2"},Je={key:1,class:"mb-3"},Ke={class:"text-body-2 font-mono"},Xe={key:2,class:"mb-3"},he={class:"text-body-2"},et={key:3,class:"mb-3"},tt={class:"text-body-2"},at=["href"],lt={class:"mb-3"},it={key:4,class:"mb-3"},st={class:"mt-4 pa-3 bg-grey-lighten-4 rounded"},ot={class:"text-caption text-medium-emphasis"},nt={class:"dialog-footer"},rt={class:"dialog-actions"},dt=le({__name:"OrganizationFormDialog",props:{modelValue:{type:Boolean},organization:{default:null}},emits:["update:modelValue","saved"],setup(c,{emit:T}){const $=c,I=T,F=k(),_=k(!1),O=k(!1),b=k(!1),n=re({name:"",slug:"",email:"",website:"",tier:"free",description:"",isActive:!0}),f=V.getAvailableTiers(),a=[o=>!!o||"Nome é obrigatório",o=>o&&o.length>=2||"Nome deve ter pelo menos 2 caracteres",o=>o&&o.length<=100||"Nome deve ter no máximo 100 caracteres"],w=[o=>!!o||"Slug é obrigatório",o=>o&&o.length>=2||"Slug deve ter pelo menos 2 caracteres",o=>o&&o.length<=50||"Slug deve ter no máximo 50 caracteres",o=>/^[a-z0-9-]+$/.test(o)||"Slug deve conter apenas letras minúsculas, números e hífens"],G=[o=>!!o||"Email é obrigatório",o=>/.+@.+\..+/.test(o)||"Email deve ser válido"],M=[o=>!o||/^https?:\/\/.+/.test(o)||"Website deve ser uma URL válida (http:// ou https://)"],N=[o=>!!o||"Plano é obrigatório"],Z=[o=>!o||o.length<=500||"Descrição deve ter no máximo 500 caracteres"];function R(){n.name="",n.slug="",n.email="",n.website="",n.tier="free",n.description="",n.isActive=!0,b.value=!1,F.value?.resetValidation()}function h(o){return{free:"blue",pro:"purple",enterprise:"orange"}[o]||"grey"}function Y(o){return{free:"Gratuito",pro:"Profissional",enterprise:"Empresarial"}[o]||o}function H(o){return{free:"Plano básico com funcionalidades essenciais para pequenas equipes",pro:"Plano profissional com recursos avançados e suporte prioritário",enterprise:"Plano empresarial com recursos completos e suporte dedicado"}[o]||"Descrição não disponível"}function ee(o){n.name=o.name,n.slug=o.slug,n.email=o.email,n.website=o.website||"",n.tier=o.tier,n.description=o.description||"",n.isActive=o.isActive,b.value=!0}async function J(){if(_.value){O.value=!0;try{if(b.value&&$.organization){const o={name:n.name,email:n.email,website:n.website||void 0,tier:n.tier,description:n.description||void 0,isActive:n.isActive};await V.updateOrganization($.organization.id,o)}else{const o={name:n.name,slug:n.slug,email:n.email,website:n.website||void 0,tier:n.tier,description:n.description||void 0};await V.createOrganization(o)}I("saved")}catch(o){console.error("Erro ao salvar organização:",o)}finally{O.value=!1}}}function L(){I("update:modelValue",!1)}X(()=>n.name,o=>{!b.value&&o&&(n.slug=o.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim())}),X(()=>$.modelValue,o=>{o?P():setTimeout(()=>{R()},300)});function P(){$.organization?ee($.organization):R()}return de(()=>{$.modelValue&&P()}),(o,r)=>(z(),D(ie,{"model-value":c.modelValue,"onUpdate:modelValue":r[8]||(r[8]=y=>o.$emit("update:modelValue",y)),"max-width":"900px",persistent:"",transition:"dialog-bottom-transition",class:"modern-dialog"},{default:t(()=>[e(A,{elevation:"24",class:"dialog-card"},{default:t(()=>[i("div",qe,[i("div",je,[i("div",Me,[e(v,{icon:b.value?"mdi-office-building-cog":"mdi-office-building-plus",size:"28",class:"dialog-icon"},null,8,["icon"])]),i("div",Ze,[i("h2",We,m(b.value?"Editar Organização":"Nova Organização"),1),i("p",Ge,m(b.value?"Modifique as informações da organização":"Configure uma nova organização no sistema"),1)])]),e(x,{icon:"mdi-close",variant:"text",size:"40",class:"dialog-close-btn",onClick:L})]),i("div",Qe,[e(Te,{ref_key:"formRef",ref:F,modelValue:_.value,"onUpdate:modelValue":r[7]||(r[7]=y=>_.value=y),onSubmit:$e(J,["prevent"])},{default:t(()=>[e(B,null,{default:t(()=>[e(g,{cols:"12",md:"8"},{default:t(()=>[e(A,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{class:"mr-2"},{default:t(()=>[...r[9]||(r[9]=[s("mdi-information",-1)])]),_:1}),r[10]||(r[10]=s(" Informações Básicas ",-1))]),_:1}),e(S,null,{default:t(()=>[e(B,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(j,{modelValue:n.name,"onUpdate:modelValue":r[0]||(r[0]=y=>n.name=y),label:"Nome da Organização *",rules:a,variant:"outlined","prepend-inner-icon":"mdi-domain",required:""},null,8,["modelValue"])]),_:1}),b.value?C("",!0):(z(),D(g,{key:0,cols:"12"},{default:t(()=>[e(j,{modelValue:n.slug,"onUpdate:modelValue":r[1]||(r[1]=y=>n.slug=y),label:"Slug *",rules:w,variant:"outlined","prepend-inner-icon":"mdi-link",hint:"Identificador único usado nas URLs (ex: minha-empresa)","persistent-hint":"",required:""},null,8,["modelValue"])]),_:1})),e(g,{cols:"12"},{default:t(()=>[e(j,{modelValue:n.email,"onUpdate:modelValue":r[2]||(r[2]=y=>n.email=y),label:"Email de Contato *",rules:G,variant:"outlined","prepend-inner-icon":"mdi-email",type:"email",required:""},null,8,["modelValue"])]),_:1}),e(g,{cols:"12"},{default:t(()=>[e(j,{modelValue:n.website,"onUpdate:modelValue":r[3]||(r[3]=y=>n.website=y),label:"Website",rules:M,variant:"outlined","prepend-inner-icon":"mdi-web",type:"url",placeholder:"https://exemplo.com"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(A,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{class:"mr-2"},{default:t(()=>[...r[11]||(r[11]=[s("mdi-cog",-1)])]),_:1}),r[12]||(r[12]=s(" Plano e Configurações ",-1))]),_:1}),e(S,null,{default:t(()=>[e(B,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(Q,{modelValue:n.tier,"onUpdate:modelValue":r[4]||(r[4]=y=>n.tier=y),items:p(f),label:"Plano *",rules:N,variant:"outlined","prepend-inner-icon":"mdi-crown",required:""},{item:t(({props:y,item:K})=>[e(Ee,Oe(De(y)),{prepend:t(()=>[e(v,{color:K.raw.color,class:"mr-2"},{default:t(()=>[...r[13]||(r[13]=[s(" mdi-crown ",-1)])]),_:1},8,["color"])]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),b.value?(z(),D(g,{key:0,cols:"12"},{default:t(()=>[e(ve,{modelValue:n.isActive,"onUpdate:modelValue":r[5]||(r[5]=y=>n.isActive=y),label:"Organização ativa",color:"success","hide-details":""},null,8,["modelValue"]),r[14]||(r[14]=i("div",{class:"text-caption text-grey mt-1"}," Define se a organização está ativa no sistema ",-1))]),_:1})):C("",!0)]),_:1})]),_:1})]),_:1}),e(A,{variant:"outlined"},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{class:"mr-2"},{default:t(()=>[...r[15]||(r[15]=[s("mdi-text",-1)])]),_:1}),r[16]||(r[16]=s(" Descrição ",-1))]),_:1}),e(S,null,{default:t(()=>[e(Ie,{modelValue:n.description,"onUpdate:modelValue":r[6]||(r[6]=y=>n.description=y),label:"Descrição da organização",variant:"outlined",rows:"4",counter:"500",rules:Z,placeholder:"Descreva brevemente a organização e suas atividades principais..."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{cols:"12",md:"4",class:"sidebar-column"},{default:t(()=>[e(A,{variant:"outlined",class:"sticky-card"},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{class:"mr-2"},{default:t(()=>[...r[17]||(r[17]=[s("mdi-information",-1)])]),_:1}),r[18]||(r[18]=s(" Resumo ",-1))]),_:1}),e(S,null,{default:t(()=>[n.name?(z(),q("div",Ye,[r[19]||(r[19]=i("strong",null,"Nome:",-1)),i("div",He,m(n.name),1)])):C("",!0),n.slug&&!b.value?(z(),q("div",Je,[r[20]||(r[20]=i("strong",null,"Slug:",-1)),i("div",Ke,m(n.slug),1)])):C("",!0),n.email?(z(),q("div",Xe,[r[21]||(r[21]=i("strong",null,"Email de contato:",-1)),i("div",he,m(n.email),1)])):C("",!0),n.website?(z(),q("div",et,[r[22]||(r[22]=i("strong",null,"Website:",-1)),i("div",tt,[i("a",{href:n.website,target:"_blank",class:"text-primary"},m(n.website),9,at)])])):C("",!0),i("div",lt,[r[23]||(r[23]=i("strong",null,"Plano:",-1)),e(U,{color:h(n.tier),size:"small",class:"mt-1"},{default:t(()=>[s(m(Y(n.tier)),1)]),_:1},8,["color"])]),b.value?(z(),q("div",it,[r[24]||(r[24]=i("strong",null,"Status:",-1)),e(U,{color:n.isActive?"success":"warning",size:"small",class:"mt-1"},{default:t(()=>[s(m(n.isActive?"Ativa":"Inativa"),1)]),_:1},8,["color"])])):C("",!0),i("div",st,[r[25]||(r[25]=i("div",{class:"text-caption font-weight-bold mb-2 grey-darken-2"},"CARACTERÍSTICAS DO PLANO",-1)),i("div",ot,m(H(n.tier)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),i("div",nt,[i("div",rt,[e(x,{variant:"outlined",size:"large",class:"action-btn cancel-btn",disabled:O.value,onClick:L},{default:t(()=>[...r[26]||(r[26]=[s(" Cancelar ",-1)])]),_:1},8,["disabled"]),e(x,{color:"primary",variant:"elevated",size:"large",class:"action-btn primary-btn",loading:O.value,disabled:!_.value,onClick:J},{default:t(()=>[e(v,{start:""},{default:t(()=>[s(m(b.value?"mdi-content-save":"mdi-plus"),1)]),_:1}),s(" "+m(b.value?"Salvar Alterações":"Criar Organização"),1)]),_:1},8,["loading","disabled"])])])]),_:1})]),_:1},8,["model-value"]))}}),ut=se(dt,[["__scopeId","data-v-c8155880"]]),mt={class:"dialog-header"},ct={class:"dialog-header-content"},vt={class:"dialog-icon-wrapper"},ft={class:"dialog-title-section"},pt={class:"dialog-subtitle"},gt={class:"dialog-content"},bt={class:"d-flex align-center mb-4"},yt={class:"flex-grow-1"},Vt={class:"text-h6 font-weight-bold mb-2"},zt={class:"d-flex align-center gap-2 mb-2"},xt={class:"text-body-2 text-medium-emphasis mb-0"},wt={class:"text-body-1 mb-4"},kt={class:"text-body-1 mb-4"},At={class:"text-body-1 mb-4"},Ct=["href"],$t={class:"text-body-1 mb-4"},Ot=["href"],Dt={class:"text-body-1 mb-4"},St={class:"text-body-1 mb-4"},Ut={class:"text-h4 font-weight-bold"},Tt={class:"text-h4 font-weight-bold"},_t={class:"text-h4 font-weight-bold"},Et={class:"d-flex gap-2 flex-wrap"},It={class:"mb-3"},Pt={class:"text-body-2"},Ft={class:"mb-3"},Rt={class:"mb-3"},Bt={class:"mb-3"},Nt={class:"text-body-2"},Lt={key:0,class:"mb-3"},qt={class:"text-body-2"},jt=["href"],Mt={class:"mb-3"},Zt={class:"text-body-2"},Wt={class:"mb-3"},Gt={class:"text-body-2"},Qt={class:"dialog-footer"},Yt={class:"dialog-actions"},Ht=le({__name:"OrganizationDetailsDialog",props:{modelValue:{type:Boolean},organization:{default:null}},emits:["update:modelValue","edit"],setup(c){const T=c,{isDemoUser:$}=me(),I=ue(()=>{if(!T.organization)return{users:0,repositories:0,analyses:0};if(T.organization.stats)return T.organization.stats;if($.value)switch(T.organization.slug){case"prodeb":return{users:42,repositories:18,analyses:156};case"demo":return{users:8,repositories:5,analyses:23};case"test-settings":return{users:3,repositories:2,analyses:12};default:return{users:1,repositories:1,analyses:3}}return{users:0,repositories:0,analyses:0}}),F=V.getAvailableTiers(),_=V.getAvailableStatuses();function O(f){return F.find(w=>w.value===f)?.title||f}function b(f){return _.find(w=>w.value===f)?.title||f}function n(f){switch(f){case"active":return"mdi-check-circle";case"inactive":return"mdi-pause-circle";case"suspended":return"mdi-alert-circle";default:return"mdi-help-circle"}}return(f,a)=>(z(),D(ie,{"model-value":c.modelValue,"onUpdate:modelValue":a[4]||(a[4]=w=>f.$emit("update:modelValue",w)),"max-width":"900px",persistent:"",transition:"dialog-bottom-transition",class:"modern-dialog"},{default:t(()=>[c.organization?(z(),D(A,{key:0,elevation:"24",class:"dialog-card"},{default:t(()=>[i("div",mt,[i("div",ct,[i("div",vt,[e(v,{icon:"mdi-domain",size:"28",class:"dialog-icon"})]),i("div",ft,[a[5]||(a[5]=i("h2",{class:"dialog-title"},"Detalhes da Organização",-1)),i("p",pt,"Informações completas sobre "+m(c.organization.name),1)])]),e(x,{icon:"mdi-close",variant:"text",size:"40",class:"dialog-close-btn",onClick:a[0]||(a[0]=w=>f.$emit("update:modelValue",!1))})]),i("div",gt,[e(B,null,{default:t(()=>[e(g,{cols:"12",md:"8"},{default:t(()=>[e(A,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{class:"mr-2"},{default:t(()=>[...a[6]||(a[6]=[s("mdi-information-outline",-1)])]),_:1}),a[7]||(a[7]=s(" Informações da Organização ",-1))]),_:1}),e(S,{class:"mt-4"},{default:t(()=>[i("div",bt,[e(ce,{size:"64",color:"primary",class:"me-4"},{default:t(()=>[e(v,{size:"32"},{default:t(()=>[...a[8]||(a[8]=[s("mdi-domain",-1)])]),_:1})]),_:1}),i("div",yt,[i("h3",Vt,m(c.organization.name),1),i("div",zt,[e(U,{color:p(V).getTierColor(c.organization.tier),size:"small",variant:"tonal"},{default:t(()=>[e(v,{start:"",size:"12"},{default:t(()=>[...a[9]||(a[9]=[s("mdi-crown",-1)])]),_:1}),s(" "+m(O(c.organization.tier)),1)]),_:1},8,["color"]),e(U,{color:p(V).getStatusColor(c.organization.status),size:"small",variant:"tonal",class:"ml-2"},{default:t(()=>[e(v,{start:"",size:"12"},{default:t(()=>[s(m(n(c.organization.status)),1)]),_:1}),s(" "+m(b(c.organization.status)),1)]),_:1},8,["color"])]),i("p",xt,m(c.organization.description||"Sem descrição"),1)])])]),_:1})]),_:1}),e(A,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{class:"mr-2"},{default:t(()=>[...a[10]||(a[10]=[s("mdi-card-text",-1)])]),_:1}),a[11]||(a[11]=s(" Informações Básicas ",-1))]),_:1}),e(S,{class:"mt-4"},{default:t(()=>[e(B,null,{default:t(()=>[e(g,{cols:"12",sm:"6"},{default:t(()=>[a[12]||(a[12]=i("div",{class:"text-subtitle-2 mb-2"},"ID",-1)),i("div",wt,m(c.organization.id),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[a[13]||(a[13]=i("div",{class:"text-subtitle-2 mb-2"},"Slug",-1)),i("div",kt,m(c.organization.slug),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[a[14]||(a[14]=i("div",{class:"text-subtitle-2 mb-2"},"Email",-1)),i("div",At,[i("a",{href:`mailto:${c.organization.email}`,class:"text-decoration-none"},m(c.organization.email),9,Ct)])]),_:1}),c.organization.website?(z(),D(g,{key:0,cols:"12",sm:"6"},{default:t(()=>[a[16]||(a[16]=i("div",{class:"text-subtitle-2 mb-2"},"Website",-1)),i("div",$t,[i("a",{href:c.organization.website,target:"_blank",class:"text-decoration-none"},[s(m(c.organization.website)+" ",1),e(v,{size:"12",class:"ml-1"},{default:t(()=>[...a[15]||(a[15]=[s("mdi-open-in-new",-1)])]),_:1})],8,Ot)])]),_:1})):C("",!0)]),_:1})]),_:1})]),_:1}),e(A,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{class:"mr-2"},{default:t(()=>[...a[17]||(a[17]=[s("mdi-calendar-clock",-1)])]),_:1}),a[18]||(a[18]=s(" Datas Importantes ",-1))]),_:1}),e(S,{class:"mt-4"},{default:t(()=>[e(B,null,{default:t(()=>[e(g,{cols:"12",sm:"6"},{default:t(()=>[a[19]||(a[19]=i("div",{class:"text-subtitle-2 mb-2"},"Criada em",-1)),i("div",Dt,m(p(V).formatDate(c.organization.createdAt)),1)]),_:1}),e(g,{cols:"12",sm:"6"},{default:t(()=>[a[20]||(a[20]=i("div",{class:"text-subtitle-2 mb-2"},"Última atualização",-1)),i("div",St,m(p(V).formatDate(c.organization.updatedAt)),1)]),_:1})]),_:1})]),_:1})]),_:1}),e(A,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{class:"mr-2"},{default:t(()=>[...a[21]||(a[21]=[s("mdi-chart-bar",-1)])]),_:1}),a[22]||(a[22]=s(" Estatísticas ",-1))]),_:1}),e(S,{class:"mt-4"},{default:t(()=>[e(B,null,{default:t(()=>[e(g,{cols:"12",md:"4"},{default:t(()=>[e(A,{variant:"tonal",color:"primary"},{default:t(()=>[e(S,{class:"text-center"},{default:t(()=>[e(v,{size:"32",class:"mb-2"},{default:t(()=>[...a[23]||(a[23]=[s("mdi-account-group",-1)])]),_:1}),i("div",Ut,m(I.value.users),1),a[24]||(a[24]=i("div",{class:"text-caption"},"Usuários",-1))]),_:1})]),_:1})]),_:1}),e(g,{cols:"12",md:"4"},{default:t(()=>[e(A,{variant:"tonal",color:"success"},{default:t(()=>[e(S,{class:"text-center"},{default:t(()=>[e(v,{size:"32",class:"mb-2"},{default:t(()=>[...a[25]||(a[25]=[s("mdi-source-repository",-1)])]),_:1}),i("div",Tt,m(I.value.repositories),1),a[26]||(a[26]=i("div",{class:"text-caption"},"Repositórios",-1))]),_:1})]),_:1})]),_:1}),e(g,{cols:"12",md:"4"},{default:t(()=>[e(A,{variant:"tonal",color:"warning"},{default:t(()=>[e(S,{class:"text-center"},{default:t(()=>[e(v,{size:"32",class:"mb-2"},{default:t(()=>[...a[27]||(a[27]=[s("mdi-file-document-multiple",-1)])]),_:1}),i("div",_t,m(I.value.analyses),1),a[28]||(a[28]=i("div",{class:"text-caption"},"Análises",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),p($)?C("",!0):(z(),D(A,{key:0,variant:"outlined"},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{class:"mr-2"},{default:t(()=>[...a[29]||(a[29]=[s("mdi-lightning-bolt",-1)])]),_:1}),a[30]||(a[30]=s(" Ações Rápidas ",-1))]),_:1}),e(S,null,{default:t(()=>[i("div",Et,[e(x,{color:"primary",variant:"outlined","prepend-icon":"mdi-pencil",onClick:a[1]||(a[1]=w=>f.$emit("edit"))},{default:t(()=>[...a[31]||(a[31]=[s(" Editar ",-1)])]),_:1}),e(x,{color:"info",variant:"outlined","prepend-icon":"mdi-cog",to:"/settings"},{default:t(()=>[...a[32]||(a[32]=[s(" Configurações ",-1)])]),_:1}),e(x,{color:"success",variant:"outlined","prepend-icon":"mdi-account-group",disabled:""},{default:t(()=>[...a[33]||(a[33]=[s(" Usuários ",-1)])]),_:1}),e(x,{color:"warning",variant:"outlined","prepend-icon":"mdi-source-repository",disabled:""},{default:t(()=>[...a[34]||(a[34]=[s(" Repositórios ",-1)])]),_:1})])]),_:1})]),_:1}))]),_:1}),e(g,{cols:"12",md:"4",class:"sidebar-column"},{default:t(()=>[e(A,{variant:"outlined",class:"sticky-card"},{default:t(()=>[e(E,null,{default:t(()=>[e(v,{class:"mr-2"},{default:t(()=>[...a[35]||(a[35]=[s("mdi-clipboard-text",-1)])]),_:1}),a[36]||(a[36]=s(" Resumo ",-1))]),_:1}),e(S,{class:"mt-4"},{default:t(()=>[i("div",It,[a[37]||(a[37]=i("strong",null,"Nome:",-1)),i("div",Pt,m(c.organization.name),1)]),i("div",Ft,[a[38]||(a[38]=i("strong",null,"Plano:",-1)),e(U,{color:p(V).getTierColor(c.organization.tier),size:"small",variant:"tonal",class:"ml-2"},{default:t(()=>[s(m(O(c.organization.tier)),1)]),_:1},8,["color"])]),i("div",Rt,[a[39]||(a[39]=i("strong",null,"Status:",-1)),e(U,{color:p(V).getStatusColor(c.organization.status),size:"small",variant:"tonal",class:"ml-2"},{default:t(()=>[s(m(b(c.organization.status)),1)]),_:1},8,["color"])]),i("div",Bt,[a[40]||(a[40]=i("strong",null,"Email:",-1)),i("div",Nt,m(c.organization.email),1)]),c.organization.website?(z(),q("div",Lt,[a[42]||(a[42]=i("strong",null,"Website:",-1)),i("div",qt,[i("a",{href:c.organization.website,target:"_blank",class:"text-decoration-none"},[s(m(c.organization.website)+" ",1),e(v,{size:"12",class:"ml-1"},{default:t(()=>[...a[41]||(a[41]=[s("mdi-open-in-new",-1)])]),_:1})],8,jt)])])):C("",!0),i("div",Mt,[a[43]||(a[43]=i("strong",null,"Criada em:",-1)),i("div",Zt,m(p(V).formatDate(c.organization.createdAt)),1)]),i("div",Wt,[a[44]||(a[44]=i("strong",null,"Última atualização:",-1)),i("div",Gt,m(p(V).formatDate(c.organization.updatedAt)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),i("div",Qt,[i("div",Yt,[p($)?C("",!0):(z(),D(x,{key:0,variant:"outlined",size:"large",class:"action-btn cancel-btn","prepend-icon":"mdi-pencil",onClick:a[2]||(a[2]=w=>f.$emit("edit"))},{default:t(()=>[...a[45]||(a[45]=[s(" Editar ",-1)])]),_:1})),e(x,{color:"primary",variant:"elevated",size:"large",class:"action-btn primary-btn",onClick:a[3]||(a[3]=w=>f.$emit("update:modelValue",!1))},{default:t(()=>[e(v,{start:""},{default:t(()=>[...a[46]||(a[46]=[s("mdi-check",-1)])]),_:1}),a[47]||(a[47]=s(" Fechar ",-1))]),_:1})])])]),_:1})):C("",!0)]),_:1},8,["model-value"]))}}),Jt=se(Ht,[["__scopeId","data-v-c28bf32d"]]),Kt={class:"organizations-page pa-6"},Xt={class:"d-flex justify-space-between align-center mb-6"},ht={class:"px-4 py-3 d-flex align-center justify-space-between border-b"},ea={class:"d-flex align-center gap-3"},ta={class:"d-flex align-center gap-2"},aa={class:"px-4 py-4 advanced-filters-section"},la={class:"d-flex align-center gap-3"},ia={class:"d-flex align-center justify-end gap-2"},sa={class:"d-flex align-center"},oa={class:"font-weight-bold"},na={class:"text-caption text-grey-darken-1"},ra={class:"text-caption"},da={class:"d-flex gap-1 align-center justify-center"},ua=le({__name:"OrganizationsView",setup(c){const{isDemoUser:T}=me(),$=k([]),I=k(!1),F=k(!1),_=k(0),O=k(!1),b=k(!1),n=k(!1),f=k(null),a=re({search:"",tier:void 0,status:void 0,isActive:void 0,page:1,limit:20,sortBy:"createdAt",sortOrder:"desc"}),w=k(!1),G=k(null),M=k(void 0),N=k(""),Z=k(""),R=k([{key:"createdAt",order:"desc"}]),h=[{title:"Organização",key:"name",sortable:!0},{title:"Email",key:"email",sortable:!0},{title:"Plano",key:"tier",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Ativa",key:"isActive",sortable:!0},{title:"Criada em",key:"createdAt",sortable:!0},{title:"Ações",key:"actions",sortable:!1,align:"center"}],Y=V.getAvailableTiers(),H=V.getAvailableStatuses(),ee=[{title:"Pública",value:"public"},{title:"Privada",value:"private"},{title:"ONG",value:"ngo"},{title:"Startup",value:"startup"}],J=[{title:"Ativa",value:!0},{title:"Inativa",value:!1}],L=ue(()=>{let u=0;return a.search&&u++,a.tier!==void 0&&u++,a.status!==void 0&&u++,a.isActive!==void 0&&u++,M.value!==void 0&&u++,N.value&&u++,Z.value&&u++,u}),P=ne(()=>{y()},300);async function o(){try{if(I.value=!0,R.value.length>0&&(a.sortBy=R.value[0].key,a.sortOrder=R.value[0].order),T.value){await new Promise(l=>setTimeout(l,1e3));const u=[{id:"b1e58ac3-6a88-4fc3-846d-352c8ca4a1db",name:"PRODEB",slug:"prodeb",description:"Companhia de Processamento de Dados do Estado da Bahia",email:"contato@prodeb.ba.gov.br",website:"https://www.prodeb.ba.gov.br",status:"active",tier:"enterprise",isActive:!0,createdAt:"2024-01-15T10:00:00Z",updatedAt:"2024-11-13T08:30:00Z"},{id:"7f3e8b2c-4a1d-4e9f-8c2b-5d6e7a8b9c0d",name:"Demo Organization",slug:"demo",description:"Organização de demonstração para testes",email:"demo@test.mira-api.com",website:"https://demo.mira-api.com",status:"trial",tier:"professional",isActive:!0,createdAt:"2024-02-20T14:15:00Z",updatedAt:"2024-11-12T16:45:00Z"},{id:"4d2f8e1c-9b7a-4e6f-8c3d-5a1b2c3d4e5f",name:"Test Settings Organization",slug:"test-settings",description:"Organização para testar diferentes configurações",email:"test-settings@mira-api.com",website:"https://test-settings.mira-api.com",status:"active",tier:"professional",isActive:!0,createdAt:"2024-03-10T09:30:00Z",updatedAt:"2024-11-10T11:20:00Z"}];$.value=u,_.value=u.length}else{const u={...a,includeStats:!0},l=await V.getOrganizations(u);$.value=l.data||[],_.value=l.total||0}}catch(u){console.error("Erro ao carregar organizações:",u),$.value=[],_.value=0}finally{I.value=!1}}const r=ne(()=>{a.page=1,o()},500);function y(){a.page=1,o()}function K(){a.search="",a.tier=void 0,a.status=void 0,a.isActive=void 0,M.value=void 0,N.value="",Z.value="",G.value=null,y()}function fe(u){switch(K(),u){case"active":a.status="active";break;case"trial":a.status="trial";break;case"enterprise":a.tier="enterprise";break;case"recent":const l=new Date;l.setDate(l.getDate()-30),N.value=l.toISOString().split("T")[0];break}u&&P()}function pe(){o()}function ge(u){f.value=u,b.value=!0}function be(u){f.value=u,O.value=!0}async function ye(u){if(T.value){u.isActive=!u.isActive,u.status=u.isActive?"active":"inactive";return}try{let l;u.isActive?l=await V.suspendOrganization(u.id):l=await V.activateOrganization(u.id),Object.assign(u,l)}catch(l){if(console.error("Erro ao alterar status:",l),l&&typeof l=="object"&&"response"in l){const d=l;console.error("Status:",d.response?.status),console.error("Data:",d.response?.data)}console.error("Token exists:",!!localStorage.getItem("mira_access_token"))}}function Ve(u){f.value=u,n.value=!0}async function ze(){if(f.value)try{F.value=!0,await V.deleteOrganization(f.value.id),await o(),n.value=!1,f.value=null}catch(u){console.error("Erro ao excluir organização:",u)}finally{F.value=!1}}function xe(){o(),O.value=!1,f.value=null}X(()=>O.value,u=>{u||(f.value=null)}),X(()=>b.value,u=>{u||(f.value=null)});function we(){b.value=!1,O.value=!0}function ke(u){return Y.find(d=>d.value===u)?.title||u}function Ae(u){return H.find(d=>d.value===u)?.title||u}function Ce(u){switch(u){case"active":return"mdi-check-circle";case"inactive":return"mdi-pause-circle";case"suspended":return"mdi-alert-circle";default:return"mdi-help-circle"}}return de(()=>{o()}),(u,l)=>(z(),q("div",Kt,[i("div",Xt,[l[18]||(l[18]=i("div",null,[i("h1",{class:"text-h4 font-weight-bold text-high-emphasis mb-2"}," Organizações "),i("p",{class:"text-body-1 text-grey-darken-1"}," Gerencie as organizações do sistema ")],-1)),p(T)?C("",!0):(z(),D(x,{key:0,color:"primary","prepend-icon":"mdi-plus",onClick:l[0]||(l[0]=d=>O.value=!0)},{default:t(()=>[...l[17]||(l[17]=[s(" Nova Organização ",-1)])]),_:1}))]),e(A,{class:"mb-6 filter-card"},{default:t(()=>[i("div",ht,[i("div",ea,[e(j,{modelValue:a.search,"onUpdate:modelValue":l[1]||(l[1]=d=>a.search=d),label:"Buscar organizações...","prepend-inner-icon":"mdi-magnify",variant:"solo",density:"compact","hide-details":"",clearable:"",style:{"min-width":"280px"},onInput:p(r)},null,8,["modelValue","onInput"]),L.value>0?(z(),D(U,{key:0,size:"small",color:"primary",variant:"tonal",class:"ml-2"},{default:t(()=>[s(m(L.value)+" filtro"+m(L.value>1?"s":""),1)]),_:1})):C("",!0)]),i("div",ta,[e(Pe,{modelValue:G.value,"onUpdate:modelValue":[l[2]||(l[2]=d=>G.value=d),fe],variant:"outlined",color:"primary"},{default:t(()=>[e(U,{value:"active",size:"small"},{default:t(()=>[e(v,{start:""},{default:t(()=>[...l[19]||(l[19]=[s("mdi-check-circle",-1)])]),_:1}),l[20]||(l[20]=s(" Ativas ",-1))]),_:1}),e(U,{value:"trial",size:"small"},{default:t(()=>[e(v,{start:""},{default:t(()=>[...l[21]||(l[21]=[s("mdi-clock-outline",-1)])]),_:1}),l[22]||(l[22]=s(" Trial ",-1))]),_:1}),e(U,{value:"enterprise",size:"small"},{default:t(()=>[e(v,{start:""},{default:t(()=>[...l[23]||(l[23]=[s("mdi-crown",-1)])]),_:1}),l[24]||(l[24]=s(" Enterprise ",-1))]),_:1}),e(U,{value:"recent",size:"small"},{default:t(()=>[e(v,{start:""},{default:t(()=>[...l[25]||(l[25]=[s("mdi-calendar",-1)])]),_:1}),l[26]||(l[26]=s(" Recentes ",-1))]),_:1})]),_:1},8,["modelValue"]),e(x,{color:w.value?"primary":"default",variant:w.value?"flat":"outlined",size:"small",onClick:l[3]||(l[3]=d=>w.value=!w.value),class:"ml-1"},{default:t(()=>[e(v,null,{default:t(()=>[s("mdi-filter"+m(w.value?"-check":""),1)]),_:1}),l[27]||(l[27]=s(" Filtros ",-1))]),_:1},8,["color","variant"]),L.value>0?(z(),D(x,{key:0,variant:"outlined",size:"small",color:"error",onClick:K,class:"ml-2"},{default:t(()=>[e(v,{start:""},{default:t(()=>[...l[28]||(l[28]=[s("mdi-filter-remove",-1)])]),_:1}),l[29]||(l[29]=s(" Limpar ",-1))]),_:1})):C("",!0)])]),e(Fe,null,{default:t(()=>[Se(i("div",aa,[e(B,null,{default:t(()=>[e(g,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(Q,{modelValue:a.tier,"onUpdate:modelValue":[l[4]||(l[4]=d=>a.tier=d),p(P)],label:"Plano",items:p(Y),variant:"outlined",density:"compact",clearable:"","prepend-inner-icon":"mdi-crown"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(Q,{modelValue:a.status,"onUpdate:modelValue":[l[5]||(l[5]=d=>a.status=d),p(P)],label:"Status",items:p(H),variant:"outlined",density:"compact",clearable:"","prepend-inner-icon":"mdi-chart-circle"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(Q,{modelValue:M.value,"onUpdate:modelValue":[l[6]||(l[6]=d=>M.value=d),p(P)],label:"Tipo",items:ee,variant:"outlined",density:"compact",clearable:"","prepend-inner-icon":"mdi-domain"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{cols:"12",sm:"6",md:"3"},{default:t(()=>[e(Q,{modelValue:a.isActive,"onUpdate:modelValue":[l[7]||(l[7]=d=>a.isActive=d),p(P)],label:"Ativa",items:J,variant:"outlined",density:"compact",clearable:"","prepend-inner-icon":"mdi-toggle-switch"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[i("div",la,[e(v,{color:"medium-emphasis"},{default:t(()=>[...l[30]||(l[30]=[s("mdi-calendar-range",-1)])]),_:1}),l[31]||(l[31]=i("div",{class:"text-caption text-medium-emphasis"},"Data de Criação:",-1)),e(j,{modelValue:N.value,"onUpdate:modelValue":l[8]||(l[8]=d=>N.value=d),type:"date",label:"De",variant:"outlined",density:"compact","hide-details":"",onChange:p(P),class:"ml-2"},null,8,["modelValue","onChange"]),e(j,{modelValue:Z.value,"onUpdate:modelValue":l[9]||(l[9]=d=>Z.value=d),type:"date",label:"Até",variant:"outlined",density:"compact","hide-details":"",onChange:p(P),class:"ml-2"},null,8,["modelValue","onChange"])])]),_:1}),e(g,{cols:"12",md:"6"},{default:t(()=>[i("div",ia,[e(x,{color:"primary","prepend-icon":"mdi-refresh",onClick:pe,class:"ml-2"},{default:t(()=>[...l[32]||(l[32]=[s(" Atualizar ",-1)])]),_:1})])]),_:1})]),_:1})],512),[[Ue,w.value]])]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(Re,{"items-per-page":a.limit,"onUpdate:itemsPerPage":l[10]||(l[10]=d=>a.limit=d),page:a.page,"onUpdate:page":l[11]||(l[11]=d=>a.page=d),"sort-by":R.value,"onUpdate:sortBy":l[12]||(l[12]=d=>R.value=d),headers:h,items:$.value,"items-length":_.value,loading:I.value,"item-key":"id","onUpdate:options":o},{"item.name":t(({item:d})=>[i("div",sa,[e(ce,{size:"40",color:"primary",class:"mr-3"},{default:t(()=>[e(v,null,{default:t(()=>[...l[33]||(l[33]=[s("mdi-domain",-1)])]),_:1})]),_:1}),i("div",null,[i("div",oa,m(d.name),1),i("div",na,m(d.slug),1)])])]),"item.tier":t(({item:d})=>[e(U,{color:p(V).getTierColor(d.tier),size:"small",variant:"tonal"},{default:t(()=>[s(m(ke(d.tier)),1)]),_:2},1032,["color"])]),"item.status":t(({item:d})=>[e(U,{color:p(V).getStatusColor(d.status),size:"small",variant:"tonal"},{default:t(()=>[e(v,{start:"",size:"12"},{default:t(()=>[s(m(Ce(d.status)),1)]),_:2},1024),s(" "+m(Ae(d.status)),1)]),_:2},1032,["color"])]),"item.isActive":t(({item:d})=>[p(T)?(z(),D(U,{key:1,color:d.isActive?"success":"error",size:"small",variant:"tonal"},{default:t(()=>[s(m(d.isActive?"Ativa":"Inativa"),1)]),_:2},1032,["color"])):(z(),D(ve,{key:0,"model-value":d.isActive,color:"success","hide-details":"","onUpdate:modelValue":W=>ye(d)},null,8,["model-value","onUpdate:modelValue"]))]),"item.createdAt":t(({item:d})=>[i("div",ra,m(p(V).formatDate(d.createdAt)),1)]),"item.actions":t(({item:d})=>[i("div",da,[e(ae,{text:"Ver detalhes",class:"custom-tooltip"},{activator:t(({props:W})=>[e(x,te(W,{icon:"mdi-eye",variant:"text",size:"small",onClick:oe=>ge(d)}),null,16,["onClick"])]),_:2},1024),p(T)?C("",!0):(z(),D(ae,{key:0,text:"Editar",class:"custom-tooltip"},{activator:t(({props:W})=>[e(x,te(W,{icon:"mdi-pencil",variant:"text",size:"small",onClick:oe=>be(d)}),null,16,["onClick"])]),_:2},1024)),p(T)?C("",!0):(z(),D(ae,{key:1,text:"Excluir",class:"custom-tooltip"},{activator:t(({props:W})=>[e(x,te(W,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:oe=>Ve(d)}),null,16,["onClick"])]),_:2},1024))])]),loading:t(()=>[e(Be,{type:"table-row@5"})]),_:2},1032,["items-per-page","page","sort-by","items","items-length","loading"])]),_:1}),e(ut,{modelValue:O.value,"onUpdate:modelValue":l[13]||(l[13]=d=>O.value=d),organization:f.value,onSaved:xe},null,8,["modelValue","organization"]),e(Jt,{modelValue:b.value,"onUpdate:modelValue":l[14]||(l[14]=d=>b.value=d),organization:f.value,onEdit:we},null,8,["modelValue","organization"]),e(ie,{modelValue:n.value,"onUpdate:modelValue":l[16]||(l[16]=d=>n.value=d),"max-width":"500"},{default:t(()=>[e(A,null,{default:t(()=>[e(E,{class:"text-h5"},{default:t(()=>[...l[34]||(l[34]=[s(" Confirmar Exclusão ",-1)])]),_:1}),e(S,null,{default:t(()=>[l[36]||(l[36]=s(" Tem certeza que deseja excluir a organização ",-1)),i("strong",null,m(f.value?.name),1),l[37]||(l[37]=s("? ",-1)),e(Ne,{type:"warning",class:"mt-4"},{default:t(()=>[...l[35]||(l[35]=[s(" Esta ação não pode ser desfeita e todos os dados relacionados serão perdidos. ",-1)])]),_:1})]),_:1}),e(_e,null,{default:t(()=>[e(Le),e(x,{variant:"text",onClick:l[15]||(l[15]=d=>n.value=!1)},{default:t(()=>[...l[38]||(l[38]=[s(" Cancelar ",-1)])]),_:1}),e(x,{color:"error",variant:"flat",loading:F.value,onClick:ze},{default:t(()=>[...l[39]||(l[39]=[s(" Excluir ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}}),ja=se(ua,[["__scopeId","data-v-53c04124"]]);export{ja as default};
