import{j as T,d as c,r as Z,h as V,D as $,af as j,Z as g,y as s,a5 as H,n as l,a1 as t,a6 as G,aa as a,ag as J,ab as K,_ as f,a0 as z,U as R,a8 as q,q as p,V as d,P as O,$ as F}from"./vendor-vue-BKuzT1x2.js";import{l as N}from"./logo_horizontal-BkjEFnEQ.js";import{a as Q}from"./auth.service-BozCwdnf.js";import{a as i,b as W,_ as X}from"./index-gFSB3kms.js";import{V as Y}from"./VForm-DthKd8zl.js";import"./vendor-utils-6xD0fNU8.js";import"./token-storage.service-BqAv9k07.js";import"./vendor-ui-Ca7vMALJ.js";import"./form-PEXhLZdP.js";const ee={class:"reset-password-layout"},se={class:"hero-panel"},ae={class:"hero-content"},oe={class:"hero-features"},te={class:"feature-item"},re={class:"feature-icon"},le={class:"feature-item"},ie={class:"feature-icon"},ne={class:"form-panel"},de={class:"form-container"},ue={key:0,class:"success-container"},ce={class:"success-icon"},me={key:1},ve={class:"form-group"},fe={class:"input-wrapper"},pe=["type"],we={key:0,class:"error-message"},ge={class:"form-group"},he={class:"input-wrapper"},Pe=["type"],be={key:0,class:"error-message"},ke={class:"password-strength"},ye={class:"strength-meter"},_e={class:"password-requirements"},Ve={class:"requirement-list"},ze=["disabled"],Se={key:0,class:"error-alert"},xe={class:"form-footer"},Ce={class:"back-text"},Re=T({__name:"ResetPasswordView",setup(qe){const U=K(),D=j(),h=c(!1),P=c(!1),b=c(!1),u=c(""),S=c(!1),E=c(),k=c(!1),o=Z({newPassword:"",confirmPassword:""}),m=c([]),w=c([]),x=c(""),n=V(()=>({length:o.newPassword.length>=8,uppercase:/[A-Z]/.test(o.newPassword),lowercase:/[a-z]/.test(o.newPassword),number:/\d/.test(o.newPassword)})),y=V(()=>{const r=o.newPassword;let e=0;return r.length>=8&&(e+=25),/[A-Z]/.test(r)&&(e+=25),/[a-z]/.test(r)&&(e+=25),/\d/.test(r)&&(e+=25),e<=25?{percentage:e,class:"weak",text:"Fraca"}:e<=50?{percentage:e,class:"fair",text:"Regular"}:e<=75?{percentage:e,class:"good",text:"Boa"}:{percentage:e,class:"strong",text:"Forte"}}),C=()=>(m.value=[],o.newPassword?o.newPassword.length<8?(m.value.push("Senha deve ter pelo menos 8 caracteres"),!1):n.value.uppercase?n.value.lowercase?n.value.number?(o.confirmPassword&&_(),!0):(m.value.push("Senha deve ter pelo menos um número"),!1):(m.value.push("Senha deve ter pelo menos uma letra minúscula"),!1):(m.value.push("Senha deve ter pelo menos uma letra maiúscula"),!1):(m.value.push("Senha é obrigatória"),!1)),_=()=>(w.value=[],o.confirmPassword?o.newPassword!==o.confirmPassword?(w.value.push("Senhas não conferem"),!1):!0:(w.value.push("Confirmação de senha é obrigatória"),!1)),B=()=>{const r=C(),e=_();return k.value=r&&e,k.value},M=V(()=>o.newPassword.length>=8&&/[A-Z]/.test(o.newPassword)&&/[a-z]/.test(o.newPassword)&&/\d/.test(o.newPassword)&&o.confirmPassword&&o.newPassword===o.confirmPassword),A=async()=>{if(B()){h.value=!0,u.value="";try{await Q.resetPassword({token:x.value,newPassword:o.newPassword,confirmPassword:o.confirmPassword}),S.value=!0}catch(r){if(r?.response?.data?.message)u.value=r.response.data.message;else if(r?.response?.data?.errors){const e=r.response.data.errors;Array.isArray(e)&&e.length>0?u.value=e[0]:u.value="Erro de validação. Verifique os dados inseridos."}else r?.message?u.value=r.message:u.value="Erro ao redefinir senha. Verifique se o link ainda é válido."}finally{h.value=!1}}},I=()=>{U.push("/login")};return $(()=>{const r=D.query.token;if(!r){u.value="Token de recuperação não encontrado na URL.";return}x.value=r}),(r,e)=>{const L=J("router-link");return f(),g("div",ee,[s("div",se,[s("div",ae,[e[10]||(e[10]=H('<div class="hero-brand" data-v-d0e638bc><img src="'+N+'" alt="Mira - Code Review Platform" class="hero-logo" data-v-d0e638bc></div><div class="hero-text" data-v-d0e638bc><h1 class="hero-title" data-v-d0e638bc> Redefina sua<br data-v-d0e638bc><span class="hero-highlight" data-v-d0e638bc>Senha</span></h1><p class="hero-description" data-v-d0e638bc> Digite sua nova senha para continuar acessando a plataforma Mira com segurança. </p></div>',2)),s("div",oe,[s("div",te,[s("div",re,[l(i,{size:"20",color:"white"},{default:t(()=>[...e[6]||(e[6]=[a("mdi-shield-check",-1)])]),_:1})]),e[7]||(e[7]=s("div",{class:"feature-text"},[s("div",{class:"feature-title"},"Segurança"),s("div",{class:"feature-desc"},"Criptografia avançada para seus dados")],-1))]),s("div",le,[s("div",ie,[l(i,{size:"20",color:"white"},{default:t(()=>[...e[8]||(e[8]=[a("mdi-lock-reset",-1)])]),_:1})]),e[9]||(e[9]=s("div",{class:"feature-text"},[s("div",{class:"feature-title"},"Recuperação Segura"),s("div",{class:"feature-desc"},"Processo validado e temporizado")],-1))])])])]),s("div",ne,[s("div",de,[e[33]||(e[33]=s("div",{class:"mobile-logo-container"},[s("img",{src:N,alt:"Mira",class:"mobile-logo"})],-1)),S.value?(f(),g("div",ue,[s("div",ce,[l(i,{size:"64",color:"success"},{default:t(()=>[...e[11]||(e[11]=[a("mdi-check-circle",-1)])]),_:1})]),e[14]||(e[14]=s("h2",{class:"success-title"},"Senha Redefinida!",-1)),e[15]||(e[15]=s("p",{class:"success-message"}," Sua senha foi alterada com sucesso. Você já pode fazer login com sua nova senha. ",-1)),l(W,{color:"primary",variant:"flat",size:"large",class:"success-button",onClick:I},{default:t(()=>[l(i,{class:"me-2"},{default:t(()=>[...e[12]||(e[12]=[a("mdi-login",-1)])]),_:1}),e[13]||(e[13]=a(" Ir para Login ",-1))]),_:1})])):(f(),g("div",me,[e[32]||(e[32]=s("div",{class:"form-header"},[s("h2",{class:"form-title"},"Definir Nova Senha"),s("p",{class:"form-subtitle"},"Escolha uma senha forte para proteger sua conta:")],-1)),l(Y,{ref_key:"resetFormRef",ref:E,modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=v=>k.value=v),onSubmit:G(A,["prevent"])},{default:t(()=>[s("div",ve,[e[17]||(e[17]=s("label",{for:"password",class:"form-label"},"Nova Senha",-1)),s("div",fe,[l(i,{class:"input-icon",size:"20"},{default:t(()=>[...e[16]||(e[16]=[a("mdi-lock-outline",-1)])]),_:1}),R(s("input",{id:"password","onUpdate:modelValue":e[0]||(e[0]=v=>o.newPassword=v),type:P.value?"text":"password",class:p(["form-input",{error:m.value.length}]),placeholder:"Digite sua nova senha",required:"",onInput:C},null,42,pe),[[q,o.newPassword]]),s("button",{type:"button",class:"password-toggle",onClick:e[1]||(e[1]=v=>P.value=!P.value)},[l(i,{size:"20"},{default:t(()=>[a(d(P.value?"mdi-eye-off-outline":"mdi-eye-outline"),1)]),_:1})])]),m.value.length?(f(),g("div",we,d(m.value[0]),1)):z("",!0)]),s("div",ge,[e[19]||(e[19]=s("label",{for:"confirmPassword",class:"form-label"},"Confirmar Nova Senha",-1)),s("div",he,[l(i,{class:"input-icon",size:"20"},{default:t(()=>[...e[18]||(e[18]=[a("mdi-lock-check-outline",-1)])]),_:1}),R(s("input",{id:"confirmPassword","onUpdate:modelValue":e[2]||(e[2]=v=>o.confirmPassword=v),type:b.value?"text":"password",class:p(["form-input",{error:w.value.length}]),placeholder:"Confirme sua nova senha",required:"",onInput:_},null,42,Pe),[[q,o.confirmPassword]]),s("button",{type:"button",class:"password-toggle",onClick:e[3]||(e[3]=v=>b.value=!b.value)},[l(i,{size:"20"},{default:t(()=>[a(d(b.value?"mdi-eye-off-outline":"mdi-eye-outline"),1)]),_:1})])]),w.value.length?(f(),g("div",be,d(w.value[0]),1)):z("",!0)]),s("div",ke,[e[20]||(e[20]=s("div",{class:"strength-label"},"Força da senha:",-1)),s("div",ye,[s("div",{class:p(["strength-bar",y.value.class]),style:O({width:y.value.percentage+"%"})},null,6)]),s("div",{class:p(["strength-text",y.value.class])},d(y.value.text),3)]),s("div",_e,[e[25]||(e[25]=s("div",{class:"requirement-title"},"Requisitos da senha:",-1)),s("div",Ve,[s("div",{class:p(["requirement-item",{valid:n.value.length}])},[l(i,{size:"16"},{default:t(()=>[a(d(n.value.length?"mdi-check":"mdi-close"),1)]),_:1}),e[21]||(e[21]=a(" Pelo menos 8 caracteres ",-1))],2),s("div",{class:p(["requirement-item",{valid:n.value.uppercase}])},[l(i,{size:"16"},{default:t(()=>[a(d(n.value.uppercase?"mdi-check":"mdi-close"),1)]),_:1}),e[22]||(e[22]=a(" Uma letra maiúscula ",-1))],2),s("div",{class:p(["requirement-item",{valid:n.value.lowercase}])},[l(i,{size:"16"},{default:t(()=>[a(d(n.value.lowercase?"mdi-check":"mdi-close"),1)]),_:1}),e[23]||(e[23]=a(" Uma letra minúscula ",-1))],2),s("div",{class:p(["requirement-item",{valid:n.value.number}])},[l(i,{size:"16"},{default:t(()=>[a(d(n.value.number?"mdi-check":"mdi-close"),1)]),_:1}),e[24]||(e[24]=a(" Um número ",-1))],2)])]),s("button",{type:"submit",class:"submit-btn",disabled:h.value||!M.value},[h.value?(f(),F(i,{key:0,class:"loading-icon"},{default:t(()=>[...e[26]||(e[26]=[a("mdi-loading",-1)])]),_:1})):(f(),F(i,{key:1},{default:t(()=>[...e[27]||(e[27]=[a("mdi-check",-1)])]),_:1})),a(" "+d(h.value?"Redefinindo...":"Redefinir Senha"),1)],8,ze),u.value?(f(),g("div",Se,[l(i,{size:"20"},{default:t(()=>[...e[28]||(e[28]=[a("mdi-alert-circle",-1)])]),_:1}),a(" "+d(u.value)+" ",1),s("button",{onClick:e[4]||(e[4]=v=>u.value=""),class:"close-error"},[l(i,{size:"16"},{default:t(()=>[...e[29]||(e[29]=[a("mdi-close",-1)])]),_:1})])])):z("",!0)]),_:1},8,["modelValue"]),s("div",xe,[s("p",Ce,[e[31]||(e[31]=a(" Lembrou da senha? ",-1)),l(L,{to:"/login",class:"back-link"},{default:t(()=>[...e[30]||(e[30]=[a("Voltar ao login",-1)])]),_:1})])])]))])])])}}}),Le=X(Re,[["__scopeId","data-v-d0e638bc"]]);export{Le as default};
