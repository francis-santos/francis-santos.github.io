import{k as M,af as q,a6 as G,f as x,j as y,E as O,_ as c,z as t,$ as b,a0 as m,q as o,a1 as r,a8 as u,W as a,v as W,F as H,ae as J,a2 as n,a9 as K}from"./vendor-vue-BOgiBTV5.js";import{r as Q}from"./repositories-BA9OK_s4.js";import{u as X,V as w}from"./VChip-rM5LjFon.js";import{_ as Y,b as p,c as Z,a as v,t as $}from"./index-CPKBv9AR.js";import{V as tt}from"./VAlert-qYEn-PTR.js";import{a as _,V as R}from"./VRow-xKwg0MSP.js";import{V as h,a as k,b as A}from"./VGrid-BsndwDIl.js";import{V as et}from"./VTable-C8WajvOs.js";import"./auth-Dt5LZyuD.js";import"./vendor-utils-C9OYYH06.js";import"./token-storage.service-BqAv9k07.js";import"./index-DzEvJ-T3.js";import"./vendor-ui-BR0KSDoQ.js";const st=M({__name:"RepositoryDetailsView",setup(z,{expose:e}){e();const g=q(),s=G(),{isDemoUser:C}=X(),l=x(null),i=x(!1),f=x(null),V=y(()=>g.params.id),I=y(()=>{if(!l.value)return"mdi-source-repository";switch(l.value.platform?.toLowerCase()){case"gitlab":return"mdi-gitlab";case"github":return"mdi-github";case"bitbucket":return"mdi-bitbucket";default:return"mdi-source-repository"}}),T=y(()=>{if(!l.value)return"grey";switch(l.value.platform?.toLowerCase()){case"gitlab":return"orange";case"github":return"grey-darken-2";case"bitbucket":return"blue";default:return"grey"}}),j=y(()=>{if(!l.value)return"grey";switch(l.value.syncStatus){case"active":return"success";case"paused":return"warning";case"error":return"error";default:return"grey"}}),B=y(()=>{if(!l.value)return"";switch(l.value.syncStatus){case"active":return"Ativo";case"paused":return"Pausado";case"error":return"Erro";default:return l.value.syncStatus}});async function S(){i.value=!0,f.value=null;try{l.value=await Q.getRepository(V.value)}catch(d){f.value=d instanceof Error?d.message:"Erro ao carregar repositório",console.error("Error loading repository details:",d)}finally{i.value=!1}}function F(d){return d?new Date(d).toLocaleString("pt-BR"):"N/A"}function N(d){switch(d){case"completed":return"success";case"processing":return"warning";case"pending":return"info";case"failed":return"error";default:return"grey"}}function P(d){switch(d){case"completed":return"Completa";case"processing":return"Processando";case"pending":return"Pendente";case"failed":return"Falhou";default:return d}}function E(d){s.push(`/analyses/${d.id}`)}function U(){s.push("/repositories")}function L(){l.value?.webUrl&&window.open(l.value.webUrl,"_blank")}O(()=>{S()});const D={route:g,router:s,isDemoUser:C,repository:l,loading:i,error:f,repositoryId:V,platformIcon:I,platformColor:T,statusColor:j,statusText:B,loadRepositoryDetails:S,formatDate:F,getAnalysisStatusColor:N,getAnalysisStatusText:P,viewAnalysisDetails:E,goBack:U,openRepository:L};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),ot={class:"repository-details-page"},rt={class:"d-flex align-center mb-6"},at={key:0,class:"text-center py-12"},it={key:2,class:"repository-details"},lt={class:"flex-grow-1"},nt={class:"text-h5 font-weight-bold"},dt={class:"text-body-2 text-grey-darken-1"},ct={key:0,class:"mb-4"},ut={class:"text-body-1"},mt={class:"mb-3"},ft={class:"text-body-1 font-weight-medium text-capitalize"},yt={class:"mb-3"},pt={class:"text-body-2"},vt={class:"mb-3"},_t={class:"text-body-2"},gt={class:"mb-3"},xt={class:"text-body-2"},bt={class:"mb-4"},wt={class:"d-flex align-center justify-space-between mb-2"},ht={class:"text-h6 font-weight-bold text-primary"},kt={class:"d-flex align-center justify-space-between mb-2"},At={class:"text-body-1 font-weight-medium text-success"},Ct={class:"d-flex align-center justify-space-between mb-2"},Vt={class:"text-body-1 font-weight-medium text-error"},St={class:"mb-4"},Dt={class:"d-flex align-center justify-space-between mb-2"},Rt={key:0,class:"mb-4"},zt={class:"d-flex align-center justify-space-between mb-2"},It={class:"text-h6 font-weight-bold"},Tt={class:"d-flex align-center justify-space-between mb-1"},jt={class:"text-body-1 font-weight-medium"},Bt={class:"d-flex align-center"},Ft={key:0},Nt=["onClick"],Pt={class:"text-caption"},Et={key:0,class:"d-flex align-center"},Ut={class:"text-body-2"},Lt={key:1,class:"text-caption text-grey"},Mt={class:"d-flex align-center"},qt={class:"text-caption"},Gt={key:0};function Ot(z,e,g,s,C,l){return n(),c("div",ot,[t("div",rt,[o(p,{icon:"mdi-arrow-left",variant:"text",onClick:s.goBack,class:"me-3"}),e[0]||(e[0]=t("div",{class:"flex-grow-1"},[t("h1",{class:"text-h4 font-weight-bold text-grey-darken-3 mb-1"}," Detalhes do Repositório "),t("p",{class:"text-body-1 text-grey-darken-1"}," Informações completas e estatísticas ")],-1)),s.repository?.webUrl?(n(),b(p,{key:0,color:"primary","prepend-icon":s.platformIcon,onClick:s.openRepository,variant:"elevated"},{default:r(()=>[u(" Abrir no "+a(s.repository?.platform),1)]),_:1},8,["prepend-icon"])):m("",!0)]),s.loading?(n(),c("div",at,[o(Z,{indeterminate:"",color:"primary",size:"64"}),e[1]||(e[1]=t("p",{class:"text-body-1 text-grey-darken-1 mt-4"}," Carregando detalhes do repositório... ",-1))])):s.error?(n(),b(tt,{key:1,type:"error",variant:"tonal",class:"mb-4"},{default:r(()=>[u(a(s.error),1)]),_:1})):s.repository?(n(),c("div",it,[o(R,{class:"mb-6"},{default:r(()=>[o(_,{cols:"12",md:"8"},{default:r(()=>[o(h,{elevation:"2"},{default:r(()=>[o(k,{class:"d-flex align-center"},{default:r(()=>[o(v,{icon:s.platformIcon,color:s.platformColor,class:"me-2",size:"32"},null,8,["icon","color"]),t("div",lt,[t("div",nt,a(s.repository.name),1),t("div",dt,a(s.repository.fullName),1)]),o(w,{color:s.statusColor,variant:"tonal"},{default:r(()=>[u(a(s.statusText),1)]),_:1},8,["color"])]),_:1}),o(A,null,{default:r(()=>[s.repository.description?(n(),c("div",ct,[e[2]||(e[2]=t("div",{class:"text-caption text-grey-darken-1"},"Descrição",-1)),t("div",ut,a(s.repository.description),1)])):m("",!0),o(R,null,{default:r(()=>[o(_,{cols:"12",sm:"6"},{default:r(()=>[t("div",mt,[e[3]||(e[3]=t("div",{class:"text-caption text-grey-darken-1"},"Plataforma",-1)),t("div",ft,a(s.repository.platform),1)]),t("div",yt,[e[4]||(e[4]=t("div",{class:"text-caption text-grey-darken-1"},"Criado em",-1)),t("div",pt,a(s.formatDate(s.repository.createdAt)),1)])]),_:1}),o(_,{cols:"12",sm:"6"},{default:r(()=>[t("div",vt,[e[5]||(e[5]=t("div",{class:"text-caption text-grey-darken-1"},"Última Sincronização",-1)),t("div",_t,a(s.formatDate(s.repository.lastSyncAt)),1)]),t("div",gt,[e[6]||(e[6]=t("div",{class:"text-caption text-grey-darken-1"},"Atualizado em",-1)),t("div",xt,a(s.formatDate(s.repository.updatedAt)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(_,{cols:"12",md:"4"},{default:r(()=>[o(h,{elevation:"2"},{default:r(()=>[o(k,{class:"d-flex align-center"},{default:r(()=>[o(v,{class:"me-2"},{default:r(()=>[...e[7]||(e[7]=[u("mdi-chart-box",-1)])]),_:1}),e[8]||(e[8]=u(" Estatísticas Gerais ",-1))]),_:1}),o(A,null,{default:r(()=>[t("div",bt,[t("div",wt,[e[9]||(e[9]=t("span",{class:"text-body-2"},"Total de Análises",-1)),t("span",ht,a(s.repository.statistics?.totalAnalyses||0),1)]),t("div",kt,[e[10]||(e[10]=t("span",{class:"text-body-2"},"Análises Completas",-1)),t("span",At,a(s.repository.statistics?.completedAnalyses||0),1)]),t("div",Ct,[e[11]||(e[11]=t("span",{class:"text-body-2"},"Análises Falhadas",-1)),t("span",Vt,a(s.repository.statistics?.failedAnalyses||0),1)])]),t("div",St,[t("div",Dt,[e[12]||(e[12]=t("span",{class:"text-body-2"},"Total de Issues",-1)),t("span",{class:W(["text-h6 font-weight-bold",s.repository.statistics?.totalIssues>0?"text-warning":"text-success"])},a(s.repository.statistics?.totalIssues||0),3)])]),s.repository.statistics?.averageScore?(n(),c("div",Rt,[t("div",zt,[e[13]||(e[13]=t("span",{class:"text-body-2"},"Score Médio",-1)),t("span",It,a(s.repository.statistics.averageScore.toFixed(1)),1)]),o($,{"model-value":s.repository.statistics.averageScore*10,color:s.repository.statistics.averageScore>=8?"success":s.repository.statistics.averageScore>=6?"warning":"error",height:"8",rounded:""},null,8,["model-value","color"])])):m("",!0),t("div",null,[t("div",Tt,[e[14]||(e[14]=t("span",{class:"text-body-2"},"Branches Analisados",-1)),t("span",jt,a(s.repository.statistics?.branches||0),1)])])]),_:1})]),_:1})]),_:1})]),_:1}),s.repository.recentAnalyses&&s.repository.recentAnalyses.length>0?(n(),b(h,{key:0,elevation:"2"},{default:r(()=>[o(k,{class:"d-flex align-center justify-space-between"},{default:r(()=>[t("div",Bt,[o(v,{class:"me-2"},{default:r(()=>[...e[15]||(e[15]=[u("mdi-history",-1)])]),_:1}),e[16]||(e[16]=u(" Análises Recentes ",-1))]),o(p,{variant:"text",size:"small",to:"/analyses","append-icon":"mdi-arrow-right"},{default:r(()=>[...e[17]||(e[17]=[u(" Ver Todas ",-1)])]),_:1})]),_:1}),o(A,null,{default:r(()=>[o(et,null,{default:r(()=>[t("thead",null,[t("tr",null,[e[18]||(e[18]=t("th",null,"Branch",-1)),e[19]||(e[19]=t("th",null,"Commit",-1)),e[20]||(e[20]=t("th",null,"Status",-1)),e[21]||(e[21]=t("th",null,"Score",-1)),e[22]||(e[22]=t("th",null,"Issues",-1)),e[23]||(e[23]=t("th",null,"Data",-1)),s.isDemoUser?m("",!0):(n(),c("th",Ft,"Ações"))])]),t("tbody",null,[(n(!0),c(H,null,J(s.repository.recentAnalyses,i=>(n(),c("tr",{key:i.id,class:"analysis-row",onClick:f=>s.viewAnalysisDetails(i)},[t("td",null,[o(w,{size:"small",variant:"tonal",color:"primary"},{default:r(()=>[u(a(i.branchName),1)]),_:2},1024)]),t("td",null,[t("code",Pt,a(i.commitSha),1)]),t("td",null,[o(w,{color:s.getAnalysisStatusColor(i.status),size:"small",variant:"tonal"},{default:r(()=>[u(a(s.getAnalysisStatusText(i.status)),1)]),_:2},1032,["color"])]),t("td",null,[i.qualityScore?(n(),c("div",Et,[t("span",Ut,a(i.qualityScore.toFixed(1)),1)])):(n(),c("span",Lt,"N/A"))]),t("td",null,[t("div",Mt,[o(v,{class:"me-1",size:"16",color:i.issuesFound>0?"warning":"success"},{default:r(()=>[u(a(i.issuesFound>0?"mdi-alert":"mdi-check-circle"),1)]),_:2},1032,["color"]),t("span",null,a(i.issuesFound),1)])]),t("td",null,[t("span",qt,a(s.formatDate(i.createdAt)),1)]),s.isDemoUser?m("",!0):(n(),c("td",Gt,[o(p,{icon:"mdi-eye",size:"small",variant:"text",color:"primary",onClick:K(f=>s.viewAnalysisDetails(i),["stop"])},null,8,["onClick"])]))],8,Nt))),128))])]),_:1})]),_:1})]),_:1})):m("",!0)])):m("",!0)])}const re=Y(st,[["render",Ot],["__scopeId","data-v-60e1455d"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/repositories/RepositoryDetailsView.vue"]]);export{re as default};
