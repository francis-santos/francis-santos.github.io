import{b as i}from"./auth-Dt5LZyuD.js";import{u as r}from"./VChip-rM5LjFon.js";class g{async getEffectiveRules(a){return await i.get(`/organizations/${a}/rule-configs/effective-rules`)}async getStatistics(a){const{isDemoUser:e,simulateApiDelay:n}=r();return e.value?(await n(250),{total:8,enabled:6,disabled:2,byStatus:{enabled:6,disabled:2},bySeverity:{low:2,medium:3,high:2,critical:1},byCategory:{security:3,quality:2,performance:2,style:1},priorityDistribution:{1:2,2:3,3:2,4:1}}):await i.get(`/organizations/${a}/rule-configs/statistics`)}async getRuleConfigs(a,e={}){const{isDemoUser:n,getMockData:o}=r();if(n.value){const s=await o("rules",e?.page||1,e?.limit||10,e);return{data:s.data,total:s.total,page:s.page,limit:s.limit,totalPages:Math.ceil(s.total/s.limit)}}const t=new URLSearchParams;return e.search&&t.append("search",e.search),e.status&&t.append("status",e.status),e.severity&&t.append("severity",e.severity),e.category&&t.append("category",e.category),e.language&&t.append("language",e.language),e.isEnabled!==void 0&&t.append("isEnabled",String(e.isEnabled)),e.page&&t.append("page",String(e.page)),e.limit&&t.append("limit",String(e.limit)),await i.get(`/organizations/${a}/rule-configs?${t.toString()}`)}async getRuleConfig(a,e){return await i.get(`/organizations/${a}/rule-configs/${e}`)}async createRuleConfig(a,e){return await i.post(`/organizations/${a}/rule-configs`,e)}async updateRuleConfig(a,e,n){return await i.patch(`/organizations/${a}/rule-configs/${e}`,n)}async deleteRuleConfig(a,e){await i.delete(`/organizations/${a}/rule-configs/${e}`)}async bulkUpdateRuleConfigs(a,e){await i.post(`/organizations/${a}/rule-configs/bulk-update`,e)}async resetToDefaults(a){await i.post(`/organizations/${a}/rule-configs/reset-to-defaults`)}async duplicateFromOrganization(a,e){await i.post(`/organizations/${a}/rule-configs/duplicate-from/${e}`)}async getCategories(a){const{isDemoUser:e,simulateApiDelay:n}=r();if(e.value)return await n(200),["security","quality","performance","style"];const o=await this.getEffectiveRules(a);return[...new Set(o.map(s=>s.ruleTemplate.category))].filter(Boolean).sort()}async getLanguages(a){const e=await this.getEffectiveRules(a);return[...new Set(e.map(o=>o.ruleTemplate.language))].filter(Boolean).sort()}}const p=new g;export{p as r};
