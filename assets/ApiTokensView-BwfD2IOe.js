import{f as C,G as Ne,q as o,x as $,k as me,r as Ee,j as W,w as le,J as ee,$ as V,a1 as a,z as s,a8 as r,W as m,a9 as Be,_ as k,a0 as E,ae as K,F as Y,a2 as d,v as Le,E as je}from"./vendor-vue-BOgiBTV5.js";import{b as J}from"./auth-Dt5LZyuD.js";import{u as _e,V as q}from"./VChip-rM5LjFon.js";import{y as Fe,_ as ce,a as P,b as I}from"./index-CPKBv9AR.js";import{a as fe,b as Q,c as pe,V as M,e as ne}from"./VGrid-BsndwDIl.js";import{V as Me}from"./VForm-pUagEOzw.js";import{V as ue}from"./VTextField-DiiVGj7F.js";import{V as qe}from"./VTextarea-ndrXJOcn.js";import{V as H,a as D}from"./VRow-xKwg0MSP.js";import{c as Ve,h as Ge,V as ye}from"./VSelect-BBg-Hfm2.js";import{b as We,V as Ae,m as Ye}from"./autofocus-DZuUxpyU.js";import{h as He,p as Ke,q as Ze,u as Je,ap as Qe,ab as Xe}from"./vendor-ui-BR0KSDoQ.js";import{V as Ie,a as re,c as de}from"./VExpansionPanels-DoqjFcgI.js";import{V as X}from"./VAlert-qYEn-PTR.js";import{V as we}from"./VList-BKPY6TWC.js";import{V as ve}from"./VSpacer-CBt-5M7F.js";import{V as ge}from"./VDialog-CkQu3sn-.js";import{d as $e}from"./vendor-utils-C9OYYH06.js";import{V as et}from"./VDataTable-CI-izd_C.js";import{V as he}from"./VTooltip-CO6cvPu2.js";import"./token-storage.service-BqAv9k07.js";import"./index-DzEvJ-T3.js";import"./VMenu-vHpHdbAo.js";import"./dialog-transition-BRPqoOP4.js";import"./ssrBoot-Cswv876e.js";import"./VPagination-BAn_hqPp.js";import"./VTable-C8WajvOs.js";import"./filter-BU9fsv7R.js";const tt=Ke({...Ye(),...Xe(Ge(),["inline"])},"VCheckbox"),Ce=He()({name:"VCheckbox",inheritAttrs:!1,props:tt(),emits:{"update:modelValue":w=>!0,"update:focused":w=>!0},setup(w,e){let{attrs:n,slots:t}=e;const l=Ze(w,"modelValue"),{isFocused:c,focus:i,blur:p}=We(w),b=C(),S=Ne();return Je(()=>{const[T,f]=Qe(n),h=Ae.filterProps(w),x=Ve.filterProps(w);return o(Ae,$({ref:b,class:["v-checkbox",w.class]},T,h,{modelValue:l.value,"onUpdate:modelValue":A=>l.value=A,id:w.id||`checkbox-${S}`,focused:c.value,style:w.style}),{...t,default:A=>{let{id:R,messagesId:j,isDisabled:z,isReadonly:y,isValid:F}=A;return o(Ve,$(x,{id:R.value,"aria-describedby":j.value,disabled:z.value,readonly:y.value},f,{error:F.value===!1,modelValue:l.value,"onUpdate:modelValue":B=>l.value=B,onFocus:i,onBlur:p}),t)}})}),Fe({},b)}}),g={ANALYSIS:"analysis",WEBHOOKS:"webhooks",USERS:"users",ORGANIZATIONS:"organizations",REPOSITORIES:"repositories",RULES:"rules",LOGS:"logs",SETTINGS:"settings"},Te=[{name:"analysis:read",label:"Ler Análises",description:"Visualizar análises de código e seus resultados",category:g.ANALYSIS},{name:"analysis:create",label:"Criar Análises",description:"Iniciar novas análises de código",category:g.ANALYSIS},{name:"analysis:update",label:"Atualizar Análises",description:"Modificar análises existentes",category:g.ANALYSIS},{name:"analysis:delete",label:"Excluir Análises",description:"Remover análises do sistema",category:g.ANALYSIS},{name:"webhooks:read",label:"Ler Webhooks",description:"Visualizar configurações e logs de webhooks",category:g.WEBHOOKS},{name:"webhooks:create",label:"Criar Webhooks",description:"Configurar novos webhooks",category:g.WEBHOOKS},{name:"webhooks:update",label:"Atualizar Webhooks",description:"Modificar configurações de webhooks",category:g.WEBHOOKS},{name:"webhooks:delete",label:"Excluir Webhooks",description:"Remover webhooks do sistema",category:g.WEBHOOKS},{name:"users:read",label:"Ler Usuários",description:"Visualizar informações de usuários",category:g.USERS},{name:"users:create",label:"Criar Usuários",description:"Adicionar novos usuários ao sistema",category:g.USERS},{name:"users:update",label:"Atualizar Usuários",description:"Modificar informações de usuários",category:g.USERS},{name:"users:delete",label:"Excluir Usuários",description:"Remover usuários do sistema",category:g.USERS},{name:"organizations:read",label:"Ler Organizações",description:"Visualizar informações de organizações",category:g.ORGANIZATIONS},{name:"organizations:update",label:"Atualizar Organizações",description:"Modificar configurações de organizações",category:g.ORGANIZATIONS},{name:"repositories:read",label:"Ler Repositórios",description:"Visualizar informações de repositórios",category:g.REPOSITORIES},{name:"repositories:create",label:"Criar Repositórios",description:"Adicionar novos repositórios",category:g.REPOSITORIES},{name:"repositories:update",label:"Atualizar Repositórios",description:"Modificar configurações de repositórios",category:g.REPOSITORIES},{name:"repositories:delete",label:"Excluir Repositórios",description:"Remover repositórios do sistema",category:g.REPOSITORIES},{name:"rules:read",label:"Ler Regras",description:"Visualizar regras de análise",category:g.RULES},{name:"rules:create",label:"Criar Regras",description:"Criar novas regras de análise",category:g.RULES},{name:"rules:update",label:"Atualizar Regras",description:"Modificar regras existentes",category:g.RULES},{name:"rules:delete",label:"Excluir Regras",description:"Remover regras do sistema",category:g.RULES},{name:"logs:read",label:"Ler Logs",description:"Visualizar logs do sistema",category:g.LOGS},{name:"settings:read",label:"Ler Configurações",description:"Visualizar configurações do sistema",category:g.SETTINGS},{name:"settings:update",label:"Atualizar Configurações",description:"Modificar configurações do sistema",category:g.SETTINGS}];class at{async getTokens(e={}){const{isDemoUser:n,getMockData:t}=_e();if(n.value){const c={};e.search&&e.search.trim()&&(c.search=e.search),e.active!==void 0&&e.active!==null&&(c.active=e.active),e.permissions&&e.permissions.length>0&&(c.permissions=e.permissions);const i=await t("apiTokens",e.page||1,e.limit||25,c);return{data:i.data,total:i.total,page:i.page,limit:i.limit,totalPages:Math.ceil(i.total/i.limit)}}const l=new URLSearchParams;return e.search&&l.append("search",e.search),e.active!==void 0&&l.append("active",e.active.toString()),e.permissions?.length&&e.permissions.forEach(c=>l.append("permissions",c)),e.page&&l.append("page",e.page.toString()),e.limit&&l.append("limit",e.limit.toString()),e.sortBy&&l.append("sortBy",e.sortBy),e.sortOrder&&l.append("sortOrder",e.sortOrder),await J.get(`/auth/tokens?${l}`)}async getTokenDetails(e){const{isDemoUser:n,getMockItem:t}=_e();if(n.value){const l=await t("apiTokens",e);if(!l)throw new Error("Token não encontrado");return l}return await J.get(`/auth/tokens/${e}`)}async createToken(e){return await J.post("/auth/tokens",e)}async updateToken(e,n){return await J.patch(`/auth/tokens/${e}`,n)}async revokeToken(e){await J.delete(`/auth/tokens/${e}`)}async getCurrentUser(){return await J.get("/auth/me")}async getTokenStats(e={}){const t=(await this.getTokens(e)).data,l=t.length,c=t.filter(h=>h.active).length,i=new Date,p=t.filter(h=>h.expiresAt&&new Date(h.expiresAt)<i).length,b=new Date;b.setDate(b.getDate()-7);const S=t.filter(h=>h.lastUsedAt&&new Date(h.lastUsedAt)>b).length,T=new Map;t.forEach(h=>{(h.permissions||[]).forEach(A=>{T.set(A,(T.get(A)||0)+1)})});const f=Array.from(T.entries()).map(([h,x])=>({permission:h,count:x}));return{total:l,active:c,expired:p,recentlyUsed:S,byPermissions:f}}getAvailablePermissions(){return Te}getPermissionsByCategory(){const e={};return Te.forEach(n=>{e[n.category]||(e[n.category]=[]),e[n.category].push(n)}),e}getPermissionCategories(){return[{name:g.ANALYSIS,label:"Análises"},{name:g.WEBHOOKS,label:"Webhooks"},{name:g.USERS,label:"Usuários"},{name:g.ORGANIZATIONS,label:"Organizações"},{name:g.REPOSITORIES,label:"Repositórios"},{name:g.RULES,label:"Regras"},{name:g.LOGS,label:"Logs"},{name:g.SETTINGS,label:"Configurações"}]}validateTokenName(e){return!e||e.trim().length===0?{isValid:!1,message:"Nome do token é obrigatório"}:e.length<3?{isValid:!1,message:"Nome deve ter pelo menos 3 caracteres"}:e.length>100?{isValid:!1,message:"Nome deve ter no máximo 100 caracteres"}:/^[a-zA-Z0-9\s\-_]+$/.test(e)?{isValid:!0}:{isValid:!1,message:"Nome pode conter apenas letras, números, espaços, hífens e underscores"}}validatePermissions(e){if(!e||e.length===0)return{isValid:!1,message:"Pelo menos uma permissão deve ser selecionada"};const n=Te.map(l=>l.name),t=e.filter(l=>!n.includes(l));return t.length>0?{isValid:!1,message:`Permissões inválidas: ${t.join(", ")}`}:{isValid:!0}}validateExpirationDate(e){if(!e)return{isValid:!0};if(e<=new Date)return{isValid:!1,message:"Data de expiração deve ser no futuro"};const t=new Date;return t.setFullYear(t.getFullYear()+5),e>t?{isValid:!1,message:"Data de expiração não pode ser superior a 5 anos"}:{isValid:!0}}formatTokenForDisplay(e){if(e.length<=8)return e;const n=e.substring(0,4),t=e.substring(e.length-4),l="*".repeat(Math.min(e.length-8,20));return`${n}${l}${t}`}getTokenStatusColor(e){if(!e.active)return"error";if(e.expiresAt){const n=new Date,t=new Date(e.expiresAt);if(t<n)return"error";const l=new Date;if(l.setDate(l.getDate()+30),t<l)return"warning"}return"success"}getTokenStatusText(e){if(!e.active)return"Revogado";if(e.expiresAt){const n=new Date,t=new Date(e.expiresAt);if(t<n)return"Expirado";const l=new Date;if(l.setDate(l.getDate()+30),t<l)return"Expira em breve"}return"Ativo"}async exportTokens(e={},n="csv"){const l=(await this.getTokens(e)).data;if(n==="csv"){const c=this.convertToCSV(l);return new Blob([c],{type:"text/csv"})}else{const c=JSON.stringify(l,null,2);return new Blob([c],{type:"application/json"})}}convertToCSV(e){if(e.length===0)return"";const n=["ID","Nome","Descrição","Permissões","Status","Último Uso","IP do Último Uso","Data de Expiração","Data de Criação"],t=e.map(c=>[c.id,c.name,c.description||"",c.permissions.join("; "),this.getTokenStatusText(c),c.lastUsedAt||"Nunca usado",c.lastUsedIp||"N/A",c.expiresAt||"Sem expiração",c.createdAt]);return[n.join(","),...t.map(c=>c.map(i=>`"${i}"`).join(","))].join(`
`)}}const _=new at,ot=me({__name:"TokenFormDialog",props:{modelValue:{type:Boolean,required:!0},token:{type:[Object,null],required:!1,default:null}},emits:["update:modelValue","saved"],setup(w,{expose:e,emit:n}){e();const t=w,l=n,c=C(),i=C(!1),p=C(!1),b=C(!1),S=C(""),T=C(""),f=Ee({name:"",description:"",permissions:[],expiresAt:void 0}),h=W({get(){return t.modelValue},set(v){l("update:modelValue",v)}}),x=W(()=>!!t.token),A=W(()=>{const v=new Date;return v.setDate(v.getDate()+1),v.toISOString().slice(0,16)}),R=W(()=>_.getPermissionCategories()),j=W(()=>_.getPermissionsByCategory()),z=[v=>!!v||"Nome é obrigatório",v=>{const N=_.validateTokenName(v);return N.isValid||N.message}],y=[v=>!v||v.length<=500||"Descrição deve ter no máximo 500 caracteres"],F=[v=>{if(!b.value)return!0;if(!v)return"Data de expiração é obrigatória";const N=new Date(v),L=_.validateExpirationDate(N);return L.isValid||L.message}];function B(){f.name="",f.description="",f.permissions.length=0,f.expiresAt=void 0,b.value=!1,S.value="",T.value="",i.value=!1,ee(()=>{c.value?.resetValidation()})}function U(){if(t.token&&(f.name=t.token.name,f.description=t.token.description||"",f.permissions=[...t.token.permissions||[]],t.token.expiresAt)){b.value=!0;const v=new Date(t.token.expiresAt);S.value=v.toISOString().slice(0,16),f.expiresAt=v}}function G(){if(b.value){if(!S.value){const v=new Date;v.setFullYear(v.getFullYear()+1),S.value=v.toISOString().slice(0,16)}}else S.value="",f.expiresAt=void 0}function te(v){return j.value[v]||[]}function ke(v){return _.getAvailablePermissions().find(L=>L.name===v)?.label||v}function ae(v){const N=f.permissions.indexOf(v);N>-1&&f.permissions.splice(N,1)}async function xe(){if(!c.value)return;const{valid:v}=await c.value.validate();if(!v)return;const N=_.validatePermissions(f.permissions);if(!N.isValid){T.value=N.message||"Erro de validação";return}T.value="",b.value&&S.value&&(f.expiresAt=new Date(S.value));try{if(p.value=!0,x.value&&t.token){const L={name:f.name,description:f.description,permissions:f.permissions,expiresAt:f.expiresAt},se=await _.updateToken(t.token.id,L);l("saved",se)}else{const L=await _.createToken(f);l("saved",L)}h.value=!1}catch(L){console.error("Erro ao salvar token:",L)}finally{p.value=!1}}function be(){h.value=!1}le(()=>t.modelValue,v=>{v&&(B(),x.value&&ee(()=>{U()}))}),le(()=>t.token,()=>{t.modelValue&&(B(),x.value&&ee(()=>{U()}))},{deep:!0}),le(S,v=>{b.value&&v&&(f.expiresAt=new Date(v))});const oe={props:t,emit:l,form:c,valid:i,loading:p,hasExpiration:b,expirationDate:S,permissionError:T,formData:f,dialog:h,isEdit:x,minDate:A,permissionCategories:R,permissionsByCategory:j,nameRules:z,descriptionRules:y,expirationRules:F,resetForm:B,fillForm:U,handleExpirationToggle:G,getCategoryPermissions:te,getPermissionLabel:ke,removePermission:ae,handleSubmit:xe,handleCancel:be};return Object.defineProperty(oe,"__isScriptSetup",{enumerable:!1,value:!0}),oe}}),st={class:"d-flex align-center"},it={class:"mb-4"},nt={class:"pt-2"},lt={class:"font-weight-medium"},rt={class:"text-caption text-medium-emphasis"},dt={key:0,class:"mb-4"},ut={class:"text-subtitle-2 font-weight-medium mb-2"},mt={class:"d-flex flex-wrap ga-1"};function ct(w,e,n,t,l,c){return d(),V(ge,{modelValue:t.dialog,"onUpdate:modelValue":e[6]||(e[6]=i=>t.dialog=i),"max-width":"600",persistent:"",scrollable:""},{default:a(()=>[o(M,null,{default:a(()=>[o(fe,{class:"text-h6 d-flex align-center justify-space-between bg-primary text-white sticky-header"},{default:a(()=>[s("div",st,[o(P,{class:"me-2"},{default:a(()=>[r(m(t.isEdit?"mdi-pencil":"mdi-key-plus"),1)]),_:1}),r(" "+m(t.isEdit?"Editar Token":"Criar Novo Token"),1)]),o(I,{icon:"mdi-close",variant:"text",size:"small",color:"white",onClick:t.handleCancel})]),_:1}),o(Q,null,{default:a(()=>[o(Me,{ref:"form",modelValue:t.valid,"onUpdate:modelValue":e[5]||(e[5]=i=>t.valid=i),onSubmit:Be(t.handleSubmit,["prevent"])},{default:a(()=>[o(ue,{modelValue:t.formData.name,"onUpdate:modelValue":e[0]||(e[0]=i=>t.formData.name=i),label:"Nome do Token *",rules:t.nameRules,variant:"outlined",density:"comfortable",class:"mb-4",required:"",autofocus:""},null,8,["modelValue"]),o(qe,{modelValue:t.formData.description,"onUpdate:modelValue":e[1]||(e[1]=i=>t.formData.description=i),label:"Descrição (opcional)",variant:"outlined",density:"comfortable",rows:"3",class:"mb-4",counter:"500",rules:t.descriptionRules},null,8,["modelValue"]),o(H,{class:"mb-4"},{default:a(()=>[o(D,{cols:"12",md:"6"},{default:a(()=>[o(Ce,{modelValue:t.hasExpiration,"onUpdate:modelValue":[e[2]||(e[2]=i=>t.hasExpiration=i),t.handleExpirationToggle],label:"Token com expiração",density:"comfortable"},null,8,["modelValue"])]),_:1}),t.hasExpiration?(d(),V(D,{key:0,cols:"12",md:"6"},{default:a(()=>[o(ue,{modelValue:t.expirationDate,"onUpdate:modelValue":e[3]||(e[3]=i=>t.expirationDate=i),label:"Data de Expiração",type:"datetime-local",variant:"outlined",density:"comfortable",rules:t.expirationRules,min:t.minDate},null,8,["modelValue","min"])]),_:1})):E("",!0)]),_:1}),s("div",it,[e[7]||(e[7]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"}," Permissões * ",-1)),e[8]||(e[8]=s("p",{class:"text-caption text-medium-emphasis mb-4"}," Selecione as permissões que este token terá acesso ",-1)),o(Ie,{variant:"accordion",multiple:""},{default:a(()=>[(d(!0),k(Y,null,K(t.permissionCategories,i=>(d(),V(re,{key:i.name,title:i.label},{default:a(()=>[o(de,null,{default:a(()=>[s("div",nt,[(d(!0),k(Y,null,K(t.getCategoryPermissions(i.name),p=>(d(),V(Ce,{key:p.name,modelValue:t.formData.permissions,"onUpdate:modelValue":e[4]||(e[4]=b=>t.formData.permissions=b),value:p.name,label:p.label,density:"comfortable",class:"mb-1"},{label:a(()=>[s("div",null,[s("div",lt,m(p.label),1),s("div",rt,m(p.description),1)])]),_:2},1032,["modelValue","value","label"]))),128))])]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}),t.permissionError?(d(),V(X,{key:0,type:"error",variant:"outlined",class:"mt-3"},{default:a(()=>[r(m(t.permissionError),1)]),_:1})):E("",!0)]),t.formData.permissions.length>0?(d(),k("div",dt,[s("h4",ut," Permissões Selecionadas ("+m(t.formData.permissions.length)+") ",1),s("div",mt,[(d(!0),k(Y,null,K(t.formData.permissions,i=>(d(),V(q,{key:i,size:"small",variant:"outlined",color:"primary",closable:"","onClick:close":p=>t.removePermission(i)},{default:a(()=>[r(m(t.getPermissionLabel(i)),1)]),_:2},1032,["onClick:close"]))),128))])])):E("",!0)]),_:1},8,["modelValue"])]),_:1}),o(we),o(pe,{class:"sticky-footer bg-grey-lighten-5 pa-4"},{default:a(()=>[o(ve),o(I,{variant:"outlined",onClick:t.handleCancel},{default:a(()=>[...e[9]||(e[9]=[r(" Cancelar ",-1)])]),_:1}),o(I,{color:"primary",loading:t.loading,disabled:!t.valid||t.formData.permissions.length===0,onClick:t.handleSubmit},{default:a(()=>[r(m(t.isEdit?"Salvar Alterações":"Criar Token"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const ft=ce(ot,[["render",ct],["__scopeId","data-v-0e3af2f4"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/auth/TokenFormDialog.vue"]]),pt=me({__name:"TokenDetailsDialog",props:{modelValue:{type:Boolean,required:!0},token:{type:[Object,null],required:!1,default:null}},emits:["update:modelValue"],setup(w,{expose:e,emit:n}){e();const t=w,l=n,c=W({get(){return t.modelValue},set(y){l("update:modelValue",y)}}),i=W(()=>_.getPermissionCategories()),p=W(()=>_.getAvailablePermissions());function b(y){return _.getTokenStatusColor(y)}function S(y){return _.getTokenStatusText(y)}function T(y){switch(b(y)){case"success":return"mdi-check-circle";case"warning":return"mdi-alert-circle";case"error":return"mdi-close-circle";default:return"mdi-help-circle"}}function f(y){return new Date(y).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function h(y,F){const B=F||[];return p.value.filter(U=>U.category===y&&B.includes(U.name))}function x(y){return{"analysis:read":"mdi-file-search","analysis:create":"mdi-file-plus","analysis:update":"mdi-file-edit","analysis:delete":"mdi-file-remove","webhooks:read":"mdi-webhook","webhooks:create":"mdi-webhook","webhooks:update":"mdi-webhook","webhooks:delete":"mdi-webhook","users:read":"mdi-account-search","users:create":"mdi-account-plus","users:update":"mdi-account-edit","users:delete":"mdi-account-remove","organizations:read":"mdi-domain","organizations:update":"mdi-domain","repositories:read":"mdi-source-repository","repositories:create":"mdi-source-repository-multiple","repositories:update":"mdi-source-commit","repositories:delete":"mdi-source-repository-multiple","rules:read":"mdi-rule","rules:create":"mdi-plus","rules:update":"mdi-pencil","rules:delete":"mdi-delete","logs:read":"mdi-file-document-multiple","settings:read":"mdi-cog","settings:update":"mdi-cog"}[y]||"mdi-key"}function A(y){if(!y.expiresAt)return"";const F=new Date,B=new Date(y.expiresAt);if(B<F)return"text-error";const U=new Date;return U.setDate(U.getDate()+30),B<U?"text-warning":"text-success"}function R(y){return y.expiresAt?new Date(y.expiresAt)<new Date:!1}function j(y){return y.active?R(y)?"Este token expirou e não pode mais ser usado.":"Este token está inativo.":"Este token foi revogado e não pode mais ser usado."}const z={props:t,emit:l,dialog:c,permissionCategories:i,availablePermissions:p,getTokenStatusColor:b,getTokenStatusText:S,getTokenStatusIcon:T,formatDate:f,getCategoryPermissions:h,getPermissionIcon:x,getExpirationClass:A,isTokenExpired:R,getInactiveTokenMessage:j};return Object.defineProperty(z,"__isScriptSetup",{enumerable:!1,value:!0}),z}}),vt={class:"d-flex align-center"},gt={class:"mb-6"},kt={class:"mb-4"},xt={class:"font-weight-medium"},bt={class:"mb-4"},yt={key:0,class:"mb-4"},ht={class:"mb-6"},Tt={class:"mb-4"},_t={key:0},wt={key:1,class:"text-medium-emphasis"},St={class:"mb-4"},Dt={key:0},Vt={key:1,class:"text-medium-emphasis"},At={class:"mb-6"},Ct={class:"mb-4"},Et={class:"mb-4"},It={key:0},Pt={key:1,class:"text-medium-emphasis"},Rt={class:"mb-4"},Ut={key:0},Ot={key:1,class:"text-medium-emphasis"},zt={class:"mb-6"},Nt={class:"text-subtitle-1 font-weight-medium mb-3"},Bt={key:0},Lt={class:"text-subtitle-2 font-weight-medium mb-2"},jt={class:"d-flex flex-wrap ga-2 mb-3"},Ft={key:1,class:"text-medium-emphasis"};function Mt(w,e,n,t,l,c){return d(),V(ge,{modelValue:t.dialog,"onUpdate:modelValue":e[2]||(e[2]=i=>t.dialog=i),"max-width":"800",scrollable:""},{default:a(()=>[n.token?(d(),V(M,{key:0},{default:a(()=>[o(fe,{class:"text-h6 d-flex align-center justify-space-between bg-primary text-white sticky-header"},{default:a(()=>[s("div",vt,[o(P,{class:"me-2"},{default:a(()=>[...e[3]||(e[3]=[r("mdi-key",-1)])]),_:1}),e[4]||(e[4]=r(" Detalhes do Token ",-1))]),o(I,{icon:"mdi-close",variant:"text",size:"small",color:"white",onClick:e[0]||(e[0]=i=>t.dialog=!1)})]),_:1}),o(Q,null,{default:a(()=>[s("div",gt,[e[8]||(e[8]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Informações Básicas",-1)),o(H,null,{default:a(()=>[o(D,{cols:"12",md:"6"},{default:a(()=>[s("div",kt,[e[5]||(e[5]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Nome",-1)),s("div",xt,m(n.token.name),1)])]),_:1}),o(D,{cols:"12",md:"6"},{default:a(()=>[s("div",bt,[e[6]||(e[6]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Status",-1)),o(q,{color:t.getTokenStatusColor(n.token),variant:"flat",size:"small"},{default:a(()=>[o(P,{start:"",size:"12"},{default:a(()=>[r(m(t.getTokenStatusIcon(n.token)),1)]),_:1}),r(" "+m(t.getTokenStatusText(n.token)),1)]),_:1},8,["color"])])]),_:1})]),_:1}),n.token.description?(d(),k("div",yt,[e[7]||(e[7]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Descrição",-1)),s("div",null,m(n.token.description),1)])):E("",!0)]),s("div",ht,[e[11]||(e[11]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Informações de Uso",-1)),o(H,null,{default:a(()=>[o(D,{cols:"12",md:"6"},{default:a(()=>[s("div",Tt,[e[9]||(e[9]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Último Uso",-1)),n.token.lastUsedAt?(d(),k("div",_t,m(t.formatDate(n.token.lastUsedAt)),1)):(d(),k("div",wt,"Nunca usado"))])]),_:1}),o(D,{cols:"12",md:"6"},{default:a(()=>[s("div",St,[e[10]||(e[10]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"IP do Último Uso",-1)),n.token.lastUsedIp?(d(),k("div",Dt,[o(q,{size:"small",variant:"outlined"},{default:a(()=>[r(m(n.token.lastUsedIp),1)]),_:1})])):(d(),k("div",Vt,"N/A"))])]),_:1})]),_:1})]),s("div",At,[e[15]||(e[15]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Datas",-1)),o(H,null,{default:a(()=>[o(D,{cols:"12",md:"4"},{default:a(()=>[s("div",Ct,[e[12]||(e[12]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Criado em",-1)),s("div",null,m(t.formatDate(n.token.createdAt)),1)])]),_:1}),o(D,{cols:"12",md:"4"},{default:a(()=>[s("div",Et,[e[13]||(e[13]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Atualizado em",-1)),n.token.updatedAt?(d(),k("div",It,m(t.formatDate(n.token.updatedAt)),1)):(d(),k("div",Pt,"N/A"))])]),_:1}),o(D,{cols:"12",md:"4"},{default:a(()=>[s("div",Rt,[e[14]||(e[14]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Expira em",-1)),n.token.expiresAt?(d(),k("div",Ut,[s("span",{class:Le(t.getExpirationClass(n.token))},m(t.formatDate(n.token.expiresAt)),3)])):(d(),k("div",Ot,"Sem expiração"))])]),_:1})]),_:1})]),s("div",zt,[s("h3",Nt," Permissões ("+m((n.token.permissions||[]).length)+") ",1),(n.token.permissions||[]).length>0?(d(),k("div",Bt,[(d(!0),k(Y,null,K(t.permissionCategories,i=>(d(),k("div",{key:i.name,class:"mb-4"},[t.getCategoryPermissions(i.name,n.token.permissions||[]).length>0?(d(),k(Y,{key:0},[s("h4",Lt,m(i.label),1),s("div",jt,[(d(!0),k(Y,null,K(t.getCategoryPermissions(i.name,n.token.permissions||[]),p=>(d(),V(q,{key:p.name,size:"small",variant:"outlined",color:"primary"},{default:a(()=>[o(P,{start:"",size:"16"},{default:a(()=>[r(m(t.getPermissionIcon(p.name)),1)]),_:2},1024),r(" "+m(p.label),1)]),_:2},1024))),128))])],64)):E("",!0)]))),128))])):(d(),k("div",Ft," Nenhuma permissão configurada "))]),t.isTokenExpired(n.token)||!n.token.active?(d(),V(X,{key:0,type:"warning",variant:"outlined",class:"mb-4"},{title:a(()=>[...e[16]||(e[16]=[r(" Token Inativo ",-1)])]),default:a(()=>[s("div",null,m(t.getInactiveTokenMessage(n.token)),1)]),_:1})):E("",!0),o(X,{type:"info",variant:"outlined",class:"mb-4"},{title:a(()=>[...e[17]||(e[17]=[r(" Como Usar ",-1)])]),default:a(()=>[e[18]||(e[18]=s("div",null,[r(" Para usar este token, adicione o header de autorização nas suas requisições: "),s("code",{class:"d-block mt-2 pa-2 bg-grey-lighten-4 rounded"}," Authorization: Bearer <seu-token> ")],-1))]),_:1})]),_:1}),o(we),o(pe,{class:"sticky-footer bg-grey-lighten-5 pa-4"},{default:a(()=>[o(ve),o(I,{color:"primary",onClick:e[1]||(e[1]=i=>t.dialog=!1)},{default:a(()=>[...e[19]||(e[19]=[r(" Fechar ",-1)])]),_:1})]),_:1})]),_:1})):E("",!0)]),_:1},8,["modelValue"])}const qt=ce(pt,[["render",Mt],["__scopeId","data-v-d30b9fae"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/auth/TokenDetailsDialog.vue"]]),Gt=me({__name:"TokenCreatedDialog",props:{modelValue:{type:Boolean,required:!0},token:{type:[Object,null],required:!1,default:null},plainTextToken:{type:String,required:!1,default:""}},emits:["update:modelValue"],setup(w,{expose:e,emit:n}){e();const t=w,l=n,c=W({get(){return t.modelValue},set(x){l("update:modelValue",x)}});async function i(){try{await navigator.clipboard.writeText(t.plainTextToken)}catch(x){console.error("Erro ao copiar token:",x),p()}}function p(){ee(()=>{const x=document.querySelector(".token-field input");x&&(x.select(),x.setSelectionRange(0,t.plainTextToken.length))})}function b(x){return _.getAvailablePermissions().find(R=>R.name===x)?.label||x}function S(x){return new Date(x).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function T(){if(!t.token||!t.plainTextToken)return;const x={name:t.token.name||"Token sem nome",description:t.token.description||"",token:t.plainTextToken,permissions:t.token.permissions||[],createdAt:t.token.createdAt||new Date().toISOString(),expiresAt:t.token.expiresAt||null,usage:{curl:`curl -H "Authorization: Bearer ${t.plainTextToken}" -H "Content-Type: application/json" http://localhost:3001/api/analysis`,javascript:`fetch('http://localhost:3001/api/analysis', {
  headers: {
    'Authorization': 'Bearer ${t.plainTextToken}',
    'Content-Type': 'application/json'
  }
})`}},A=JSON.stringify(x,null,2),R=new Blob([A],{type:"application/json"}),j=URL.createObjectURL(R),z=document.createElement("a");z.href=j,z.download=`mira-api-token-${(t.token.name||"token").toLowerCase().replace(/\s+/g,"-")}.json`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(j)}function f(){c.value=!1}const h={props:t,emit:l,dialog:c,copyToken:i,selectAllToken:p,getPermissionLabel:b,formatDate:S,downloadToken:T,handleContinue:f};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),Wt={class:"d-flex align-center"},Yt={class:"mb-6"},Ht={class:"text-subtitle-1 font-weight-medium mb-3"},Kt={class:"d-flex justify-center mb-4"},Zt={class:"mb-6"},Jt={class:"mb-3"},Qt={class:"font-weight-medium"},Xt={class:"mb-3"},$t={key:0,class:"mb-3"},ea={class:"mb-3"},ta={class:"text-caption text-medium-emphasis mb-1"},aa={class:"d-flex flex-wrap ga-1"},oa={class:"mb-3"},sa={class:"mb-3"},ia={key:0},na={key:1,class:"text-medium-emphasis"},la={class:"mb-6"},ra={class:"bg-surface-variant pa-3 rounded text-caption overflow-x-auto"},da={class:"bg-surface-variant pa-3 rounded text-caption overflow-x-auto"},ua={class:"bg-surface-variant pa-3 rounded text-caption overflow-x-auto"};function ma(w,e,n,t,l,c){return d(),V(ge,{modelValue:t.dialog,"onUpdate:modelValue":e[0]||(e[0]=i=>t.dialog=i),"max-width":"600",persistent:"",scrollable:""},{default:a(()=>[n.token?(d(),V(M,{key:0},{default:a(()=>[o(fe,{class:"text-h6 d-flex align-center justify-space-between bg-success text-white sticky-header"},{default:a(()=>[s("div",Wt,[o(P,{class:"me-2"},{default:a(()=>[...e[1]||(e[1]=[r("mdi-check-circle",-1)])]),_:1}),e[2]||(e[2]=r(" Token Criado com Sucesso! ",-1))]),o(I,{icon:"mdi-close",variant:"text",size:"small",color:"white",onClick:t.handleContinue})]),_:1}),o(Q,null,{default:a(()=>[o(X,{type:"success",variant:"outlined",class:"mb-6"},{title:a(()=>[o(P,{class:"me-2"},{default:a(()=>[...e[3]||(e[3]=[r("mdi-party-popper",-1)])]),_:1}),e[4]||(e[4]=r(" Parabéns! ",-1))]),default:a(()=>[s("div",null,[e[5]||(e[5]=r(' Seu token de API "',-1)),s("strong",null,m(n.token.name||"Token sem nome"),1),e[6]||(e[6]=r('" foi criado com sucesso. ',-1))])]),_:1}),s("div",Yt,[s("h3",Ht,[o(P,{class:"me-2"},{default:a(()=>[...e[7]||(e[7]=[r("mdi-key",-1)])]),_:1}),e[8]||(e[8]=r(" Seu Token de API ",-1))]),o(X,{type:"info",variant:"outlined",class:"mb-4"},{title:a(()=>[o(P,{class:"me-2"},{default:a(()=>[...e[9]||(e[9]=[r("mdi-information",-1)])]),_:1}),e[10]||(e[10]=r(" Importante! ",-1))]),default:a(()=>[e[11]||(e[11]=s("div",null,[r(" Este é o único momento em que você poderá ver o token completo. "),s("strong",null,"Copie e salve-o em um local seguro"),r(", pois não será possível recuperá-lo posteriormente. ")],-1))]),_:1}),o(ue,{"model-value":n.plainTextToken,label:"Token de API",variant:"outlined",readonly:"",type:"text",class:"token-field mb-4","append-inner-icon":"mdi-content-copy","onClick:appendInner":t.copyToken,onClick:t.selectAllToken},null,8,["model-value"]),s("div",Kt,[o(I,{color:"primary","prepend-icon":"mdi-content-copy",onClick:t.copyToken},{default:a(()=>[...e[12]||(e[12]=[r(" Copiar Token ",-1)])]),_:1})])]),s("div",Zt,[e[20]||(e[20]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Detalhes do Token",-1)),o(H,null,{default:a(()=>[o(D,{cols:"12",md:"6"},{default:a(()=>[s("div",Jt,[e[13]||(e[13]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Nome",-1)),s("div",Qt,m(n.token.name||"Token sem nome"),1)])]),_:1}),o(D,{cols:"12",md:"6"},{default:a(()=>[s("div",Xt,[e[16]||(e[16]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Status",-1)),o(q,{color:"success",variant:"flat",size:"small"},{default:a(()=>[o(P,{start:"",size:"12"},{default:a(()=>[...e[14]||(e[14]=[r("mdi-check-circle",-1)])]),_:1}),e[15]||(e[15]=r(" Ativo ",-1))]),_:1})])]),_:1})]),_:1}),n.token.description?(d(),k("div",$t,[e[17]||(e[17]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Descrição",-1)),s("div",null,m(n.token.description),1)])):E("",!0),s("div",ea,[s("div",ta," Permissões ("+m((n.token.permissions||[]).length)+") ",1),s("div",aa,[(d(!0),k(Y,null,K((n.token.permissions||[]).slice(0,5),i=>(d(),V(q,{key:i,size:"x-small",variant:"outlined",color:"primary"},{default:a(()=>[r(m(t.getPermissionLabel(i)),1)]),_:2},1024))),128)),(n.token.permissions||[]).length>5?(d(),V(q,{key:0,size:"x-small",variant:"outlined"},{default:a(()=>[r(" +"+m((n.token.permissions||[]).length-5)+" mais ",1)]),_:1})):E("",!0)])]),o(H,null,{default:a(()=>[o(D,{cols:"12",md:"6"},{default:a(()=>[s("div",oa,[e[18]||(e[18]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Criado em",-1)),s("div",null,m(n.token.createdAt?t.formatDate(n.token.createdAt):"Data não disponível"),1)])]),_:1}),o(D,{cols:"12",md:"6"},{default:a(()=>[s("div",sa,[e[19]||(e[19]=s("div",{class:"text-caption text-medium-emphasis mb-1"},"Expira em",-1)),n.token.expiresAt?(d(),k("div",ia,m(t.formatDate(n.token.expiresAt)),1)):(d(),k("div",na,"Sem expiração"))])]),_:1})]),_:1})]),s("div",la,[e[22]||(e[22]=s("h3",{class:"text-subtitle-1 font-weight-medium mb-3"},"Como Usar",-1)),o(Ie,{variant:"accordion"},{default:a(()=>[o(re,{title:"Requisições HTTP"},{default:a(()=>[o(de,null,{default:a(()=>[e[21]||(e[21]=s("p",{class:"mb-3"}," Para usar este token em suas requisições, adicione o header de autorização: ",-1)),s("pre",ra,[s("code",null,"Authorization: Bearer "+m(n.plainTextToken),1)])]),_:1})]),_:1}),o(re,{title:"Exemplo com cURL"},{default:a(()=>[o(de,null,{default:a(()=>[s("pre",da,[s("code",null,'curl -H "Authorization: Bearer '+m(n.plainTextToken)+`" \\
     -H "Content-Type: application/json" \\
     http://localhost:3001/api/analysis`,1)])]),_:1})]),_:1}),o(re,{title:"Exemplo JavaScript"},{default:a(()=>[o(de,null,{default:a(()=>[s("pre",ua,[s("code",null,`fetch('http://localhost:3001/api/analysis', {
  headers: {
    'Authorization': 'Bearer `+m(n.plainTextToken)+`',
    'Content-Type': 'application/json'
  }
})`,1)])]),_:1})]),_:1})]),_:1})]),o(X,{type:"warning",variant:"outlined",class:"mb-4"},{title:a(()=>[o(P,{class:"me-2"},{default:a(()=>[...e[23]||(e[23]=[r("mdi-shield-alert",-1)])]),_:1}),e[24]||(e[24]=r(" Dicas de Segurança ",-1))]),default:a(()=>[e[25]||(e[25]=s("ul",{class:"mb-0"},[s("li",null,"Nunca compartilhe seu token em repositórios públicos"),s("li",null,"Use variáveis de ambiente para armazenar tokens"),s("li",null,"Revogue tokens não utilizados regularmente"),s("li",null,"Configure tokens com permissões mínimas necessárias"),s("li",null,"Monitore o uso dos seus tokens na tela de gerenciamento")],-1))]),_:1})]),_:1}),o(we),o(pe,{class:"sticky-footer bg-grey-lighten-5 pa-4"},{default:a(()=>[o(I,{variant:"outlined","prepend-icon":"mdi-download",onClick:t.downloadToken},{default:a(()=>[...e[26]||(e[26]=[r(" Baixar como Arquivo ",-1)])]),_:1}),o(ve),o(I,{color:"primary",onClick:t.handleContinue},{default:a(()=>[...e[27]||(e[27]=[r(" Continuar ",-1)])]),_:1})]),_:1})]),_:1})):E("",!0)]),_:1},8,["modelValue"])}const ca=ce(Gt,[["render",ma],["__scopeId","data-v-576c7c12"],["__file","D:/Development/Projetos/Mira/mira-client/src/components/auth/TokenCreatedDialog.vue"]]),fa=me({__name:"ApiTokensView",setup(w,{expose:e}){e();const{isDemoUser:n}=_e(),t=C(!1),l=C([]),c=C({total:0,active:0,expired:0,recentlyUsed:0,byPermissions:[]}),i=C(!1),p=C(!1),b=C(!1),S=C(!1),T=C(null),f=C(null),h=C(null),x=C(""),A=C(!1),R=Ee({search:"",active:void 0,page:1,limit:25,sortBy:"createdAt",sortOrder:"desc"}),j=[{title:"Todos",value:void 0},{title:"Ativos",value:!0},{title:"Inativos",value:!1}],z=[{title:"Nome",value:"name"},{title:"Data de Criação",value:"createdAt"},{title:"Último Uso",value:"lastUsedAt"},{title:"Data de Expiração",value:"expiresAt"}],y=[{title:"Crescente",value:"asc"},{title:"Decrescente",value:"desc"}],F=[{title:"Nome",key:"name",sortable:!1},{title:"Status",key:"status",sortable:!1},{title:"Permissões",key:"permissions",sortable:!1},{title:"Último Uso",key:"lastUsedAt",sortable:!1},{title:"Expira em",key:"expiresAt",sortable:!1},{title:"Criado em",key:"createdAt",sortable:!1},{title:"Ações",key:"actions",sortable:!1,align:"center"}],B=$e(()=>{te()},500);async function U(){try{t.value=!0;const ie=((await _.getTokens(R)).data||[]).map(Z=>({...Z,active:typeof Z.active=="string"?Z.active==="true":!!Z.active}));l.value.length=0,l.value.push(...ie)}catch{}finally{t.value=!1}}async function G(){try{const u=await _.getTokenStats(R);c.value=u}catch{}}function te(){R.page=1,U(),G()}function ke(u){R.page=u,U()}async function ae(){await U(),await G(),await ee()}function xe(){T.value=null,i.value=!0}async function be(u){try{if(n.value){T.value=u,p.value=!0;return}const O=await _.getTokenDetails(u.id);T.value=O,p.value=!0}catch{T.value=u,p.value=!0}}async function oe(u){try{if(n.value){T.value=u,i.value=!0;return}const O=await _.getTokenDetails(u.id);T.value=O,i.value=!0}catch{T.value=u,i.value=!0}}function v(u){f.value=u,S.value=!0}function N(u){f.value=u,se()}async function L(){if(f.value)try{A.value=!0,await _.revokeToken(f.value.id);const u=l.value.findIndex(O=>O.id===f.value.id);u>-1&&l.value[u]&&(l.value[u].active=!1),await G(),S.value=!1,f.value=null}catch{}finally{A.value=!1}}async function se(){if(f.value)try{A.value=!0,await _.updateToken(f.value.id,{active:!0});const u=l.value.findIndex(O=>O.id===f.value.id);u>-1&&l.value[u]&&(l.value[u].active=!0),await G(),f.value=null}catch{}finally{A.value=!1}}function Pe(u){if(i.value=!1,T.value=null,"plainTextToken"in u)h.value=u.token,x.value=u.plainTextToken,b.value=!0;else if("token"in u&&"tokenInfo"in u)h.value=u.tokenInfo,x.value=u.token,b.value=!0;else{const O=l.value.findIndex(ie=>ie.id===u.id);O>-1&&(l.value[O]=u),G()}}function Se(u){return _.getTokenStatusColor(u)}function Re(u){return _.getTokenStatusText(u)}function Ue(u){switch(Se(u)){case"success":return"mdi-check-circle";case"warning":return"mdi-alert-circle";case"error":return"mdi-close-circle";default:return"mdi-help-circle"}}function Oe(u){return _.getAvailablePermissions().find(Z=>Z.name===u)?.label||u}function ze(u){return new Date(u).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}je(()=>{U(),G()}),le(b,async(u,O)=>{O===!0&&u===!1&&(await ae(),h.value=null,x.value="")},{immediate:!1});const De={isDemoUser:n,loading:t,tokens:l,stats:c,showCreateDialog:i,showDetailsDialog:p,showTokenCreatedDialog:b,showRevokeDialog:S,selectedToken:T,tokenToRevoke:f,createdToken:h,plainTextToken:x,revoking:A,filters:R,statusOptions:j,sortOptions:z,orderOptions:y,headers:F,debouncedSearch:B,loadTokens:U,loadStats:G,applyFilters:te,handlePageChange:ke,refreshData:ae,createNewToken:xe,viewToken:be,editToken:oe,confirmRevokeToken:v,confirmReactivateToken:N,revokeToken:L,reactivateToken:se,handleTokenSaved:Pe,getTokenStatusColor:Se,getTokenStatusText:Re,getTokenStatusIcon:Ue,getPermissionLabel:Oe,formatDate:ze,TokenFormDialog:ft,TokenDetailsDialog:qt,TokenCreatedDialog:ca};return Object.defineProperty(De,"__isScriptSetup",{enumerable:!1,value:!0}),De}}),pa={class:"api-tokens-view"},va={class:"d-flex justify-space-between align-center mb-6"},ga={class:"d-flex ga-2"},ka={class:"d-flex align-center"},xa={class:"text-h5 font-weight-bold"},ba={class:"d-flex align-center"},ya={class:"text-h5 font-weight-bold"},ha={class:"d-flex align-center"},Ta={class:"text-h5 font-weight-bold"},_a={class:"d-flex align-center"},wa={class:"text-h5 font-weight-bold"},Sa={class:"d-flex flex-column"},Da={class:"font-weight-medium"},Va={key:0,class:"text-caption text-medium-emphasis"},Aa={class:"d-flex flex-wrap ga-1"},Ca={key:0,class:"d-flex flex-column"},Ea={class:"text-caption"},Ia={key:0,class:"text-caption text-medium-emphasis"},Pa={key:1,class:"text-caption text-medium-emphasis"},Ra={key:0,class:"text-caption"},Ua={key:1,class:"text-caption text-medium-emphasis"},Oa={class:"text-caption"},za={class:"d-flex ga-1 align-center justify-center"},Na={key:0,class:"text-center pa-8"},Ba={class:"text-body-2 text-medium-emphasis mb-4"},La={class:"d-flex align-center mb-4"},ja={class:"mb-0"};function Fa(w,e,n,t,l,c){return d(),k("div",pa,[s("div",va,[e[11]||(e[11]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold"},"Tokens de API"),s("p",{class:"text-subtitle-1 text-medium-emphasis mt-1"}," Gerencie tokens de acesso para integração com a API ")],-1)),s("div",ga,[o(I,{variant:"outlined","prepend-icon":"mdi-refresh",loading:t.loading,onClick:t.refreshData},{default:a(()=>[...e[9]||(e[9]=[r(" Atualizar ",-1)])]),_:1},8,["loading"]),t.isDemoUser?E("",!0):(d(),V(I,{key:0,color:"primary","prepend-icon":"mdi-key-plus",onClick:t.createNewToken},{default:a(()=>[...e[10]||(e[10]=[r(" Novo Token ",-1)])]),_:1}))])]),o(H,{class:"mb-6"},{default:a(()=>[o(D,{cols:"12",sm:"6",md:"3"},{default:a(()=>[o(M,{class:"pa-4"},{default:a(()=>[s("div",ka,[o(ne,{color:"primary",class:"me-3"},{default:a(()=>[o(P,{color:"white"},{default:a(()=>[...e[12]||(e[12]=[r("mdi-key",-1)])]),_:1})]),_:1}),s("div",null,[s("div",xa,m(t.stats.total),1),e[13]||(e[13]=s("div",{class:"text-caption text-medium-emphasis"},"Total de Tokens",-1))])])]),_:1})]),_:1}),o(D,{cols:"12",sm:"6",md:"3"},{default:a(()=>[o(M,{class:"pa-4"},{default:a(()=>[s("div",ba,[o(ne,{color:"success",class:"me-3"},{default:a(()=>[o(P,{color:"white"},{default:a(()=>[...e[14]||(e[14]=[r("mdi-key-star",-1)])]),_:1})]),_:1}),s("div",null,[s("div",ya,m(t.stats.active),1),e[15]||(e[15]=s("div",{class:"text-caption text-medium-emphasis"},"Tokens Ativos",-1))])])]),_:1})]),_:1}),o(D,{cols:"12",sm:"6",md:"3"},{default:a(()=>[o(M,{class:"pa-4"},{default:a(()=>[s("div",ha,[o(ne,{color:"error",class:"me-3"},{default:a(()=>[o(P,{color:"white"},{default:a(()=>[...e[16]||(e[16]=[r("mdi-key-remove",-1)])]),_:1})]),_:1}),s("div",null,[s("div",Ta,m(t.stats.expired),1),e[17]||(e[17]=s("div",{class:"text-caption text-medium-emphasis"},"Tokens Expirados",-1))])])]),_:1})]),_:1}),o(D,{cols:"12",sm:"6",md:"3"},{default:a(()=>[o(M,{class:"pa-4"},{default:a(()=>[s("div",_a,[o(ne,{color:"info",class:"me-3"},{default:a(()=>[o(P,{color:"white"},{default:a(()=>[...e[18]||(e[18]=[r("mdi-clock-check",-1)])]),_:1})]),_:1}),s("div",null,[s("div",wa,m(t.stats.recentlyUsed),1),e[19]||(e[19]=s("div",{class:"text-caption text-medium-emphasis"},"Usados Recentemente",-1))])])]),_:1})]),_:1})]),_:1}),o(M,{class:"mb-6"},{default:a(()=>[o(Q,null,{default:a(()=>[o(H,null,{default:a(()=>[o(D,{cols:"12",md:"4"},{default:a(()=>[o(ue,{modelValue:t.filters.search,"onUpdate:modelValue":e[0]||(e[0]=i=>t.filters.search=i),label:"Buscar tokens","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",onInput:t.debouncedSearch},null,8,["modelValue","onInput"])]),_:1}),o(D,{cols:"12",md:"3"},{default:a(()=>[o(ye,{modelValue:t.filters.active,"onUpdate:modelValue":[e[1]||(e[1]=i=>t.filters.active=i),t.applyFilters],label:"Status",items:t.statusOptions,variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),o(D,{cols:"12",md:"3"},{default:a(()=>[o(ye,{modelValue:t.filters.sortBy,"onUpdate:modelValue":[e[2]||(e[2]=i=>t.filters.sortBy=i),t.applyFilters],label:"Ordenar por",items:t.sortOptions,variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),o(D,{cols:"12",md:"2"},{default:a(()=>[o(ye,{modelValue:t.filters.sortOrder,"onUpdate:modelValue":[e[3]||(e[3]=i=>t.filters.sortOrder=i),t.applyFilters],label:"Ordem",items:t.orderOptions,variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),o(M,null,{default:a(()=>[o(Q,{class:"pa-0"},{default:a(()=>[o(et,{headers:t.headers,items:t.tokens,loading:t.loading,"items-per-page":t.filters.limit||25,class:"elevation-0","item-key":"id","onUpdate:page":t.handlePageChange},{"item.name":a(({item:i})=>[s("div",Sa,[s("span",Da,m(i.name),1),i.description?(d(),k("span",Va,m(i.description),1)):E("",!0)])]),"item.status":a(({item:i})=>[o(q,{color:t.getTokenStatusColor(i),variant:"flat",size:"small"},{default:a(()=>[o(P,{start:"",size:"12"},{default:a(()=>[r(m(t.getTokenStatusIcon(i)),1)]),_:2},1024),r(" "+m(t.getTokenStatusText(i)),1)]),_:2},1032,["color"])]),"item.permissions":a(({item:i})=>[s("div",Aa,[(d(!0),k(Y,null,K((i.permissions||[]).slice(0,2),p=>(d(),V(q,{key:p,size:"x-small",variant:"outlined",class:"text-caption"},{default:a(()=>[r(m(t.getPermissionLabel(p)),1)]),_:2},1024))),128)),(i.permissions||[]).length>2?(d(),V(q,{key:0,size:"x-small",variant:"outlined",class:"text-caption"},{default:a(()=>[r(" +"+m((i.permissions||[]).length-2),1)]),_:2},1024)):E("",!0)])]),"item.lastUsedAt":a(({item:i})=>[i.lastUsedAt?(d(),k("div",Ca,[s("span",Ea,m(t.formatDate(i.lastUsedAt)),1),i.lastUsedIp?(d(),k("span",Ia,m(i.lastUsedIp),1)):E("",!0)])):(d(),k("span",Pa,"Nunca usado"))]),"item.expiresAt":a(({item:i})=>[i.expiresAt?(d(),k("span",Ra,m(t.formatDate(i.expiresAt)),1)):(d(),k("span",Ua,"Sem expiração"))]),"item.createdAt":a(({item:i})=>[s("span",Oa,m(t.formatDate(i.createdAt)),1)]),"item.actions":a(({item:i})=>[s("div",za,[o(he,{text:"Ver detalhes",class:"custom-tooltip"},{activator:a(({props:p})=>[o(I,$(p,{icon:"mdi-eye",variant:"text",size:"small",onClick:b=>t.viewToken(i)}),null,16,["onClick"])]),_:2},1024),t.isDemoUser?E("",!0):(d(),V(he,{key:0,text:"Editar",class:"custom-tooltip"},{activator:a(({props:p})=>[o(I,$(p,{icon:"mdi-pencil",variant:"text",size:"small",onClick:b=>t.editToken(i)}),null,16,["onClick"])]),_:2},1024)),t.isDemoUser?E("",!0):(d(),V(he,{key:1,text:i.active?"Revogar":"Reativar",class:"custom-tooltip"},{activator:a(({props:p})=>[o(I,$(p,{icon:i.active?"mdi-key-remove":"mdi-key-plus",variant:"text",size:"small",color:i.active?"error":"success",onClick:b=>i.active?t.confirmRevokeToken(i):t.confirmReactivateToken(i)}),null,16,["icon","color","onClick"])]),_:2},1032,["text"]))])]),bottom:a(()=>[t.tokens.length===0&&!t.loading?(d(),k("div",Na,[o(P,{size:"64",color:"grey-lighten-1",class:"mb-4"},{default:a(()=>[...e[20]||(e[20]=[r("mdi-key-outline",-1)])]),_:1}),e[22]||(e[22]=s("div",{class:"text-h6 text-medium-emphasis mb-2"},"Nenhum token encontrado",-1)),s("div",Ba,m(t.filters.search?"Tente ajustar os filtros de busca":"Crie seu primeiro token de API"),1),t.filters.search?E("",!0):(d(),V(I,{key:0,color:"primary","prepend-icon":"mdi-key-plus",onClick:t.createNewToken},{default:a(()=>[...e[21]||(e[21]=[r(" Criar Token ",-1)])]),_:1}))])):E("",!0)]),_:2},1032,["items","loading","items-per-page"])]),_:1})]),_:1}),o(t.TokenFormDialog,{modelValue:t.showCreateDialog,"onUpdate:modelValue":e[4]||(e[4]=i=>t.showCreateDialog=i),token:t.selectedToken,onSaved:t.handleTokenSaved},null,8,["modelValue","token"]),o(t.TokenDetailsDialog,{modelValue:t.showDetailsDialog,"onUpdate:modelValue":e[5]||(e[5]=i=>t.showDetailsDialog=i),token:t.selectedToken},null,8,["modelValue","token"]),o(t.TokenCreatedDialog,{modelValue:t.showTokenCreatedDialog,"onUpdate:modelValue":e[6]||(e[6]=i=>t.showTokenCreatedDialog=i),token:t.createdToken,"plain-text-token":t.plainTextToken},null,8,["modelValue","token","plain-text-token"]),o(ge,{modelValue:t.showRevokeDialog,"onUpdate:modelValue":e[8]||(e[8]=i=>t.showRevokeDialog=i),"max-width":"400"},{default:a(()=>[o(M,null,{default:a(()=>[o(fe,{class:"text-h6"},{default:a(()=>[...e[23]||(e[23]=[r(" Revogar Token ",-1)])]),_:1}),o(Q,null,{default:a(()=>[s("div",La,[o(P,{color:"warning",size:"24",class:"me-3"},{default:a(()=>[...e[24]||(e[24]=[r("mdi-alert",-1)])]),_:1}),e[25]||(e[25]=s("span",null,"Esta ação não pode ser desfeita",-1))]),s("p",ja,[e[26]||(e[26]=r(" Tem certeza que deseja revogar o token ",-1)),s("strong",null,'"'+m(t.tokenToRevoke?.name)+'"',1),e[27]||(e[27]=r("? ",-1))]),e[28]||(e[28]=s("p",{class:"text-caption text-medium-emphasis mt-2"}," Todas as aplicações que usam este token perderão acesso imediatamente. ",-1))]),_:1}),o(pe,null,{default:a(()=>[o(ve),o(I,{onClick:e[7]||(e[7]=i=>t.showRevokeDialog=!1)},{default:a(()=>[...e[29]||(e[29]=[r(" Cancelar ",-1)])]),_:1}),o(I,{color:"error",loading:t.revoking,onClick:t.revokeToken},{default:a(()=>[...e[30]||(e[30]=[r(" Revogar ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const ko=ce(fa,[["render",Fa],["__scopeId","data-v-8961ca3f"],["__file","D:/Development/Projetos/Mira/mira-client/src/views/auth/ApiTokensView.vue"]]);export{ko as default};
