import{u as $}from"./auth--EmZq-C7.js";import{h as i}from"./vendor-vue-BKuzT1x2.js";import{b as l}from"./auth.service-BozCwdnf.js";import{u as c}from"./useDemoMode-DpDjlFnd.js";function j(){const r=$(),a=i(()=>r.user),e=i(()=>r.isAuthenticated),t=i(()=>r.isLoading),o=i(()=>r.error),n=i(()=>r.userRole),s=i(()=>r.userName||"Usuário"),u=async m=>r.login(m),p=async()=>r.logout(),d=async()=>r.refreshAuth(),g=()=>r.checkAuthStatus(),h=async()=>r.fetchUserInfo(),b=m=>a.value?.role===m,v=i(()=>a.value?.role==="master"),f=i(()=>a.value?.role==="organization_admin"||a.value?.role==="master"),w=i(()=>a.value?.role==="organization_admin"||a.value?.role==="master"),y=i(()=>a.value?.role!=="demo_user"),U=i(()=>a.value?(a.value.fullName||a.value.username).split(" ").map(k=>k.charAt(0)).join("").toUpperCase().slice(0,2):"U"),z=i(()=>a.value?.organizationName||"Organização"),A=i(()=>a.value?.organizationId||a.value?.organization?.id||null);return{user:a,isAuthenticated:e,isLoading:t,error:o,userRole:n,userName:s,userInitials:U,organizationName:z,organizationId:A,login:u,logout:p,refreshToken:d,checkAuthStatus:g,fetchUserInfo:h,hasRole:b,isMaster:v,isAdmin:f,canManageOrganization:w,canViewAnalytics:y}}class S{baseUrl="/git-integrations";async getAvailablePlatforms(){const{isDemoUser:a,simulateApiDelay:e}=c();return a.value?(await e(600),[{id:"github",name:"github",displayName:"GitHub",description:"Plataforma de hospedagem de código mais popular do mundo",icon:"mdi-github",color:"#24292e",supportsWebhooks:!0,supportsPullRequests:!0,supportsInlineComments:!0,defaultBaseUrl:"https://api.github.com"},{id:"gitlab",name:"gitlab",displayName:"GitLab",description:"Plataforma DevOps completa para desenvolvimento de software",icon:"mdi-gitlab",color:"#fc6d26",supportsWebhooks:!0,supportsPullRequests:!0,supportsInlineComments:!0,defaultBaseUrl:"https://gitlab.com/api/v4"},{id:"bitbucket",name:"bitbucket",displayName:"Bitbucket",description:"Repositórios Git e ferramentas de colaboração da Atlassian",icon:"mdi-bitbucket",color:"#0052cc",supportsWebhooks:!0,supportsPullRequests:!0,supportsInlineComments:!0,defaultBaseUrl:"https://api.bitbucket.org/2.0"},{id:"azure-devops",name:"azure-devops",displayName:"Azure DevOps",description:"Serviços de desenvolvimento da Microsoft para equipes ágeis",icon:"mdi-microsoft-azure-devops",color:"#0078d4",supportsWebhooks:!0,supportsPullRequests:!0,supportsInlineComments:!1,defaultBaseUrl:"https://dev.azure.com"}]):await l.get(`${this.baseUrl}/platforms`)}async getPlatformInfo(a){const{isDemoUser:e,simulateApiDelay:t}=c();if(e.value){await t(400);const n=(await this.getAvailablePlatforms()).find(s=>s.name===a);if(!n)throw new Error(`Platform ${a} not found`);return n}return await l.get(`${this.baseUrl}/platforms/${a}`)}async getPlatformRequirements(a){const{isDemoUser:e,simulateApiDelay:t}=c();return e.value?(await t(300),{required:["accessToken"],optional:["baseUrl","webhookSecret","timeout"],fields:{accessToken:{type:"password",label:"Token de Acesso",description:"Token de acesso pessoal ou da organização",placeholder:"ghp_xxxxxxxxxxxxxxxxxxxx"},baseUrl:{type:"url",label:"URL Base da API",description:"URL da API (opcional para plataformas hospedadas)",placeholder:"https://api.github.com"},webhookSecret:{type:"password",label:"Webhook Secret",description:"Chave secreta para validação de webhooks",placeholder:"seu-webhook-secret"}}}):await l.get(`${this.baseUrl}/platforms/${a}/requirements`)}async testPlatformConnection(a,e){const{isDemoUser:t,simulateApiDelay:o}=c();return t.value?(await o(1500),{success:!0,message:`Conexão com ${e} estabelecida com sucesso (modo demo)`,details:{platform:e,status:"connected",repositories:15,lastSync:new Date().toISOString()}}):await l.post(`${this.baseUrl}/${a}/platforms/${e}/test`)}async getConfiguredPlatforms(a){const{isDemoUser:e,simulateApiDelay:t}=c();return e.value?(await t(800),[{type:"GITLAB",name:"GitLab",enabled:!0,hasToken:!0,repositoryCount:15},{type:"GITHUB",name:"GitHub",enabled:!1,hasToken:!1,repositoryCount:0},{type:"BITBUCKET",name:"Bitbucket",enabled:!0,hasToken:!0,repositoryCount:8}]):await l.get(`${this.baseUrl}/${a}/platforms/configured`)}async getProjects(a,e){const{isDemoUser:t,simulateApiDelay:o}=c();if(t.value)return await o(1e3),[{id:"341",name:"fiplan",fullName:"base/sefaz/fiplan",type:"project",visibility:"internal",description:"Sistema de Planejamento Financeiro",avatarUrl:"/uploads/-/system/group/avatar/341/Logo_Fiplan.gif",webUrl:"https://gitlab.prodeb.ba.gov.br/base/sefaz/fiplan"},{id:"123",name:"sistema-tributacao",fullName:"base/sefaz/sistema-tributacao",type:"project",visibility:"internal",description:"Sistema de Tributação Digital",avatarUrl:null,webUrl:"https://gitlab.prodeb.ba.gov.br/base/sefaz/sistema-tributacao"},{id:"456",name:"sac-web",fullName:"sac-digital/sac-web",type:"project",visibility:"internal",description:"SAC Digital - Atendimento Web",avatarUrl:"/uploads/-/system/group/avatar/97/download.png",webUrl:"https://gitlab.prodeb.ba.gov.br/sac-digital/sac-web"}];const n=`${this.baseUrl}/${a}/platforms/${e}/projects`;return await l.get(n)}async discoverRepositories(a,e,t){const{isDemoUser:o,simulateApiDelay:n}=c();if(o.value)return await n(1200),[{id:"1",name:"mira-api",fullName:"organization/mira-api",platform:e,webUrl:`https://${e}.com/organization/mira-api`,cloneUrl:`https://${e}.com/organization/mira-api.git`,sshUrl:`git@${e}.com:organization/mira-api.git`,isPrivate:!0,primaryLanguage:"TypeScript",description:"Mira API - Backend service",size:12e5,lastActivityAt:new Date(Date.now()-1e3*60*30).toISOString(),defaultBranch:"main",owner:{id:"org1",name:"Organization",avatarUrl:"https://example.com/avatar.png"},isAdded:!1},{id:"2",name:"mira-client",fullName:"organization/mira-client",platform:e,webUrl:`https://${e}.com/organization/mira-client`,cloneUrl:`https://${e}.com/organization/mira-client.git`,sshUrl:`git@${e}.com:organization/mira-client.git`,isPrivate:!0,primaryLanguage:"Vue",description:"Mira Client - Frontend application",size:8e5,lastActivityAt:new Date(Date.now()-1e3*60*60).toISOString(),defaultBranch:"main",owner:{id:"org1",name:"Organization",avatarUrl:"https://example.com/avatar.png"},isAdded:!1},{id:"3",name:"legacy-project",fullName:"organization/legacy-project",platform:e,webUrl:`https://${e}.com/organization/legacy-project`,cloneUrl:`https://${e}.com/organization/legacy-project.git`,sshUrl:`git@${e}.com:organization/legacy-project.git`,isPrivate:!0,primaryLanguage:"PHP",description:"Legacy project that needs maintenance",size:52e5,lastActivityAt:new Date(Date.now()-1e3*60*60*24*7).toISOString(),defaultBranch:"master",owner:{id:"org1",name:"Organization",avatarUrl:"https://example.com/avatar.png"},isAdded:!0},{id:"4",name:"microservice-auth",fullName:"organization/microservice-auth",platform:e,webUrl:`https://${e}.com/organization/microservice-auth`,cloneUrl:`https://${e}.com/organization/microservice-auth.git`,sshUrl:`git@${e}.com:organization/microservice-auth.git`,isPrivate:!1,primaryLanguage:"Node.js",description:"Authentication microservice",size:6e5,lastActivityAt:new Date(Date.now()-1e3*60*60*3).toISOString(),defaultBranch:"main",owner:{id:"org1",name:"Organization",avatarUrl:"https://example.com/avatar.png"},isAdded:!1}];const s=new URLSearchParams;t?.search&&s.append("search",t.search),t?.limit&&s.append("limit",t.limit.toString()),t?.includeForks!==void 0&&s.append("includeForks",t.includeForks.toString()),t?.projectId&&s.append("projectId",t.projectId),t?.owner&&s.append("owner",t.owner),t?.workspace&&s.append("workspace",t.workspace);const u=s.toString(),p=`${this.baseUrl}/${a}/platforms/${e}/repositories${u?`?${u}`:""}`;return await l.get(p)}}const N=new S;export{N as g,j as u};
