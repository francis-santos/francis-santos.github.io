# ==============================================================================
# MIRA DEMO - GITLAB CI/CD PIPELINE FOR PAGES DEPLOYMENT
# ==============================================================================

stages:
  - deploy

# Job para deploy no GitLab Pages
pages:
  stage: deploy
  image: alpine:latest
  
  # Executar apenas na branch main/master
  rules:
    - if: $CI_COMMIT_BRANCH == "main"
    - if: $CI_COMMIT_BRANCH == "master"
  
  # Script de deploy
  script:
    - echo "ğŸš€ Iniciando deploy do Mira Demo para GitLab Pages..."
    - echo "ğŸ“‚ Criando diretÃ³rio public..."
    - mkdir -p public
    
    - echo "ğŸ“‹ Copiando arquivos da aplicaÃ§Ã£o..."
    - cp index.html public/
    - cp 404.html public/
    - cp README.md public/
    - cp -r assets/ public/assets/ 2>/dev/null || echo "âš ï¸  Pasta assets nÃ£o encontrada"
    
    - echo "ğŸ“Š Listando arquivos copiados..."
    - ls -la public/
    - du -sh public/
    
    - echo "âœ… Deploy concluÃ­do com sucesso!"
  
  # Especificar pasta public como artefato
  artifacts:
    paths:
      - public
    expire_in: 1 week
  
  # Adicionar informaÃ§Ãµes Ãºteis
  after_script:
    - echo "ğŸŒ A aplicaÃ§Ã£o estarÃ¡ disponÃ­vel em:"
    - echo "   https://$CI_PROJECT_NAMESPACE.gitlab.io/$CI_PROJECT_NAME"